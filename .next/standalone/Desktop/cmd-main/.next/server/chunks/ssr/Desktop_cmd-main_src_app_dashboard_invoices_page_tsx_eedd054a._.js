module.exports=[55156,a=>{"use strict";var b=a.i(43713),c=a.i(68599),d=a.i(84642),e=a.i(17545),f=a.i(49015),g=a.i(72760),h=a.i(79059),i=a.i(55658),j=a.i(91564),k=a.i(46382),l=a.i(93983),m=a.i(66871),n=a.i(76089),o=a.i(63395),p=a.i(77726),q=a.i(65189),r=a.i(66128),s=a.i(48367),t=a.i(57684),u=a.i(59627),v=a.i(48421);function w(){let{data:a,status:w}=(0,d.useSession)(),x=(0,e.useRouter)(),y=(0,e.useSearchParams)().get("unit"),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(!0),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)("all"),[N,O]=(0,c.useState)("all"),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(null),[Z,$]=(0,c.useState)(null),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)([]),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)(!1),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)(null),al=a?.user?.role==="ADMIN"||a?.user?.role==="ACCOUNTANT";(0,c.useEffect)(()=>{if(G(!0),"loading"!==w&&a){if(!al)return void x.replace("/dashboard/unauthorized");am(),an(),ao()}},[a,w,al,x]),(0,c.useEffect)(()=>{y?(async()=>{try{aa(!0);let a=await fetch(`/api/operational-units/${y}`);if(!a.ok)throw Error("Failed to fetch unit");let b=await a.json();$(b)}catch(a){console.error("Error fetching unit:",a),$(null)}finally{aa(!1)}})():$(null)},[y]);let am=async()=>{try{E(!0),I(null);let a=await fetch("/api/invoices");if(!a.ok)throw Error("فشل تحميل الفواتير");let b=await a.json();if(A(b),P){let a=b.find(a=>a.id===P.id);a&&Q(a)}}catch(a){console.error("Error:",a),I("فشل تحميل الفواتير")}finally{E(!1)}},an=async()=>{try{let a=await fetch("/api/projects");if(a.ok){let b=await a.json();C(b)}}catch(a){console.error("Error fetching projects:",a)}},ao=async()=>{try{ae(!0);let a=await fetch("/api/invoices/generate-monthly");if(a.ok){let b=await a.json();ac(b.units||[])}}catch(a){console.error("Error fetching due units:",a)}finally{ae(!1)}},ap=async()=>{if(confirm(`هل تريد توليد ${ab.length} فاتورة شهرية؟`))try{ai(!0),ak(null);let a=await fetch("/api/invoices/generate-monthly",{method:"POST",headers:{"Content-Type":"application/json"}});if(!a.ok)throw Error("فشل توليد الفواتير");let b=await a.json();ak(b),await am(),await ao(),b.summary.invoicesCreated>0?alert(`✅ تم توليد ${b.summary.invoicesCreated} فاتورة بنجاح!`):alert("⚠️ لا توجد فواتير جديدة للتوليد")}catch(a){console.error("Error:",a),alert("❌ فشل توليد الفواتير")}finally{ai(!1)}},aq=async()=>{if(!P||!T||0>=parseFloat(T))return void Y("الرجاء إدخال مبلغ صحيح");let a=Math.round(100*parseFloat(T))/100,b=P.remainingBalance;if(a>b+.01)return void Y(`الحد الأقصى: ${b.toFixed(2)} ج.م`);try{W(!0),Y(null);let b=await fetch("/api/payments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:a,invoiceId:P.id})});if(!b.ok){let a=await b.json();throw Error(a.error||"فشل إضافة الدفعة")}await am(),U(""),S(!1)}catch(a){console.error("Error:",a),Y(a instanceof Error?a.message:"فشل إضافة الدفعة")}finally{W(!1)}},ar=a=>a.isPaid?{status:"مدفوع بالكامل",color:"success",icon:"✓"}:0===a.totalPaid||void 0===a.totalPaid?{status:"غير مدفوع",color:"destructive",icon:"X"}:{status:"دفع جزئي",color:"warning",icon:"⏳"},as=(0,c.useMemo)(()=>{let a=z;return y&&(a=a.filter(a=>a.unitId===y)),J&&(a=a.filter(a=>a.invoiceNumber.includes(J)||a.unit?.name.toLowerCase().includes(J.toLowerCase())||a.unit?.code.toLowerCase().includes(J.toLowerCase())||a.ownerAssociation?.name.toLowerCase().includes(J.toLowerCase()))),""!==L&&"all"!==L&&(a=a.filter(a=>a.unit?.project?.id===L)),""!==N&&"all-status"!==N&&(a=a.filter(a=>"paid"===N?a.isPaid:"unpaid"===N?0===a.totalPaid:"partial"!==N||!a.isPaid&&a.totalPaid>0)),a.sort((a,b)=>new Date(b.issuedAt).getTime()-new Date(a.issuedAt).getTime())},[z,J,L,N,y]),at=(0,c.useMemo)(()=>{let a=as.reduce((a,b)=>a+b.amount,0),b=as.reduce((a,b)=>a+b.totalPaid,0),c=a-b;return{count:as.length,total:a.toFixed(2),paid:b.toFixed(2),remaining:Math.max(0,c).toFixed(2)}},[as]);return F&&(!a||al)?D?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)(h.Loader,{className:"h-8 w-8 animate-spin text-emerald-500"})}):(0,b.jsx)("div",{className:"flex-1 p-8 lg:p-12 overflow-y-auto",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto space-y-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-semibold text-gray-900 mb-2 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2.5 bg-gray-100 rounded-md",children:(0,b.jsx)(f.DollarSign,{className:"h-6 w-6 text-gray-600"})}),"الفواتير"]}),(0,b.jsx)("p",{className:"text-gray-500",children:y?"عرض فواتير الوحدة المحددة":"إدارة والعرض كل الفواتير والمدفوعات"})]}),y&&(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsx)(t.CardTitle,{className:"text-base",children:"تفاصيل الوحدة"})}),(0,b.jsx)(t.CardContent,{children:_?(0,b.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,b.jsx)(h.Loader,{className:"h-4 w-4 animate-spin"}),"جاري تحميل بيانات الوحدة..."]}):Z?(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,b.jsx)(q.Badge,{variant:"outline",className:"bg-gray-50 border-gray-200 text-gray-700",children:Z.code}),(0,b.jsx)("span",{className:"font-semibold text-gray-900",children:Z.name}),Z.project?.name&&(0,b.jsx)(q.Badge,{variant:"secondary",className:"text-xs",children:Z.project.name}),void 0!==Z.isActive&&(0,b.jsx)(q.Badge,{className:Z.isActive?"bg-[#ECFDF5] border border-[#16A34A]/20 text-[#16A34A]":"bg-[#FEF2F2] border border-[#DC2626]/20 text-[#DC2626]",variant:"outline",children:Z.isActive?"نشطة":"غير نشطة"})]}):(0,b.jsx)("p",{className:"text-gray-500",children:"تعذر تحميل بيانات الوحدة"})})]}),H&&(0,b.jsxs)(r.Alert,{variant:"destructive",className:"bg-red-500/10 border-red-500/20",children:[(0,b.jsx)(g.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(r.AlertDescription,{className:"text-red-400",children:H})]}),(a?.user?.role==="ADMIN"||a?.user?.role==="ACCOUNTANT")&&(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{className:"pb-3",children:(0,b.jsxs)(t.CardTitle,{className:"text-base flex items-center gap-2 text-gray-900",children:[(0,b.jsx)(i.Calendar,{className:"h-5 w-5 text-gray-600"}),"الفواتير الشهرية المستحقة اليوم"]})}),(0,b.jsx)(t.CardContent,{className:"space-y-4",children:ad?(0,b.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,b.jsx)(h.Loader,{className:"h-4 w-4 animate-spin"}),"جاري التحقق..."]}):ab.length>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-gray-100 rounded-md",children:(0,b.jsx)(n.AlertTriangle,{className:"h-5 w-5 text-gray-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:ab.length}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"وحدة مستحقة للفوترة"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>ag(!af),className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:[af?"إخفاء":"عرض"," التفاصيل"]}),(0,b.jsx)(o.Button,{onClick:ap,disabled:ah,className:"bg-[#2563EB] hover:bg-[#1D4ED8] text-white",children:ah?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Loader,{className:"h-4 w-4 mr-2 animate-spin"}),"جاري التوليد..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.DollarSign,{className:"h-4 w-4 mr-2"}),"توليد الفواتير الآن"]})})]})]}),af&&(0,b.jsx)("div",{className:"border border-[#E5E7EB] rounded-[12px] overflow-hidden",children:(0,b.jsxs)(p.Table,{children:[(0,b.jsx)(p.TableHeader,{children:(0,b.jsxs)(p.TableRow,{className:"hover:bg-transparent",children:[(0,b.jsx)(p.TableHead,{children:"الوحدة"}),(0,b.jsx)(p.TableHead,{children:"المشروع"}),(0,b.jsx)(p.TableHead,{children:"المالك"}),(0,b.jsx)(p.TableHead,{children:"الرسوم الشهرية"})]})}),(0,b.jsx)(p.TableBody,{children:ab.map(a=>(0,b.jsxs)(p.TableRow,{children:[(0,b.jsxs)(p.TableCell,{className:"font-semibold text-gray-900",children:[a.code," - ",a.name]}),(0,b.jsx)(p.TableCell,{className:"text-gray-500",children:a.projectName}),(0,b.jsx)(p.TableCell,{className:"text-gray-500",children:a.ownerName}),(0,b.jsxs)(p.TableCell,{className:"font-semibold text-gray-900",children:[a.monthlyFee?.toFixed(2)," ج.م"]})]},a.id))})]})})]}):(0,b.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,b.jsx)(m.CheckCircle2,{className:"h-5 w-5 text-gray-600"}),(0,b.jsx)("span",{children:"لا توجد وحدات مستحقة للفوترة اليوم"})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"bg-white border border-[#E5E7EB] rounded-[12px] p-4 shadow-sm",children:[(0,b.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,b.jsx)("div",{className:"p-2.5 bg-gray-100 rounded-md",children:(0,b.jsx)(f.DollarSign,{className:"w-5 h-5 text-gray-600"})})}),(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"إجمالي الفواتير"}),(0,b.jsx)("p",{className:"text-3xl font-semibold text-gray-900",children:at.count})]}),(0,b.jsxs)("div",{className:"bg-white border border-[#E5E7EB] rounded-[12px] p-4 shadow-sm",children:[(0,b.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,b.jsx)("div",{className:"p-2.5 bg-gray-100 rounded-md",children:(0,b.jsx)(l.TrendingDown,{className:"w-5 h-5 text-gray-600"})})}),(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"الإجمالي"}),(0,b.jsx)("p",{className:"text-3xl font-semibold text-gray-900",children:at.total}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"جنيه مصري"})]}),(0,b.jsxs)("div",{className:"bg-white border border-[#E5E7EB] rounded-[12px] p-4 shadow-sm",children:[(0,b.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,b.jsx)("div",{className:"p-2.5 bg-gray-100 rounded-md",children:(0,b.jsx)(m.CheckCircle2,{className:"w-5 h-5 text-gray-600"})})}),(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"المدفوع"}),(0,b.jsx)("p",{className:"text-3xl font-semibold text-gray-900",children:at.paid}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"جنيه مصري"})]}),(0,b.jsxs)("div",{className:"bg-white border border-[#E5E7EB] rounded-[12px] p-4 shadow-sm",children:[(0,b.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,b.jsx)("div",{className:"p-2.5 bg-gray-100 rounded-md",children:(0,b.jsx)(n.AlertTriangle,{className:"w-5 h-5 text-gray-600"})})}),(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"المتبقي"}),(0,b.jsx)("p",{className:"text-3xl font-semibold text-gray-900",children:at.remaining}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"جنيه مصري"})]})]}),(0,b.jsxs)("div",{className:"bg-white border border-[#E5E7EB] rounded-[12px] p-4 shadow-sm",children:[(0,b.jsx)("h2",{className:"text-base font-semibold text-gray-900 mb-4",children:"البحث والتصفية"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-500 block mb-2",children:"البحث"}),(0,b.jsx)(u.Input,{placeholder:"ابحث برقم الفاتورة أو الوحدة...",value:J,onChange:a=>K(a.target.value),className:"bg-white border-gray-200 text-gray-900 placeholder:text-gray-400 focus:border-[#2563EB]"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-500 block mb-2",children:"المشروع"}),(0,b.jsxs)(s.Select,{value:L||"default",onValueChange:a=>{"default"===a?M("all"):M(a)},children:[(0,b.jsx)(s.SelectTrigger,{className:"bg-white border-gray-200 text-gray-900",children:(0,b.jsx)(s.SelectValue,{placeholder:"جميع المشاريع"})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"default",children:"جميع المشاريع"}),B.map(a=>(0,b.jsx)(s.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-500 block mb-2",children:"الحالة"}),(0,b.jsxs)(s.Select,{value:N||"default",onValueChange:a=>{"default"===a?O("all"):O(a)},children:[(0,b.jsx)(s.SelectTrigger,{className:"bg-white border-gray-200 text-gray-900",children:(0,b.jsx)(s.SelectValue,{placeholder:"جميع الحالات"})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"default",children:"جميع الفواتير"}),(0,b.jsx)(s.SelectItem,{value:"paid",children:"مدفوع"}),(0,b.jsx)(s.SelectItem,{value:"unpaid",children:"غير مدفوع"}),(0,b.jsx)(s.SelectItem,{value:"partial",children:"دفع جزئي"})]})]})]})]}),(J||"all"!==L||"all"!==N)&&(0,b.jsx)(o.Button,{variant:"outline",onClick:()=>{K(""),M("all"),O("all")},className:"w-full border-gray-300 text-gray-700 hover:bg-gray-50",children:"مسح التصفية"})]})]}),(0,b.jsx)("div",{className:"bg-white border border-[#E5E7EB] rounded-[12px] p-4 shadow-sm overflow-x-auto",children:0===as.length?(0,b.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,b.jsx)(f.DollarSign,{className:"h-12 w-12 mx-auto opacity-50 mb-2 text-gray-400"}),(0,b.jsx)("p",{children:"لا توجد فواتير"})]}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(p.Table,{children:[(0,b.jsx)(p.TableHeader,{children:(0,b.jsxs)(p.TableRow,{className:"hover:bg-transparent",children:[(0,b.jsx)(p.TableHead,{children:"رقم الفاتورة"}),(0,b.jsx)(p.TableHead,{children:"الوحدة"}),(0,b.jsx)(p.TableHead,{children:"المالك"}),(0,b.jsx)(p.TableHead,{children:"التاريخ"}),(0,b.jsx)(p.TableHead,{className:"text-right",children:"الإجمالي"}),(0,b.jsx)(p.TableHead,{className:"text-right",children:"المدفوع"}),(0,b.jsx)(p.TableHead,{className:"text-right",children:"المتبقي"}),(0,b.jsx)(p.TableHead,{children:"الحالة"})]})}),(0,b.jsx)(p.TableBody,{children:as.map(a=>{let{status:c,color:d}=ar(a);return(0,b.jsxs)(p.TableRow,{className:"cursor-pointer",onClick:()=>x.push(`/dashboard/invoices/${a.id}`),children:[(0,b.jsx)(p.TableCell,{className:"font-semibold text-gray-900",children:a.invoiceNumber}),(0,b.jsx)(p.TableCell,{children:(0,b.jsx)(q.Badge,{variant:"outline",className:"bg-gray-50 border-gray-200 text-gray-700",children:a.unit?.code})}),(0,b.jsx)(p.TableCell,{className:"text-gray-500",children:a.ownerAssociation?.name}),(0,b.jsx)(p.TableCell,{className:"text-sm text-gray-500",children:new Date(a.issuedAt).toLocaleDateString("ar-EG")}),(0,b.jsxs)(p.TableCell,{className:"text-right font-semibold text-gray-900",children:[a.amount.toFixed(2)," ج.م"]}),(0,b.jsxs)(p.TableCell,{className:"text-right text-gray-900 font-semibold",children:[a.totalPaid.toFixed(2)," ج.م"]}),(0,b.jsxs)(p.TableCell,{className:"text-right text-gray-900 font-semibold",children:[Math.max(0,a.remainingBalance).toFixed(2)," ج.م"]}),(0,b.jsx)(p.TableCell,{children:(0,b.jsx)(q.Badge,{className:a.isPaid?"bg-[#ECFDF5] border border-[#16A34A]/20 text-[#16A34A]":0===a.totalPaid?"bg-[#FEF2F2] border border-[#DC2626]/20 text-[#DC2626]":"bg-[#FFFBEB] border border-[#F59E0B]/20 text-[#F59E0B]",variant:"outline",children:c})})]},a.id)})})]})})}),P&&(0,b.jsx)(v.Dialog,{open:!!P,onOpenChange:()=>Q(null),children:(0,b.jsxs)(v.DialogContent,{className:"max-w-2xl bg-white",children:[(0,b.jsx)(v.DialogHeader,{children:(0,b.jsxs)(v.DialogTitle,{className:"text-xl text-gray-900 flex items-center gap-2",children:[(0,b.jsx)(f.DollarSign,{className:"h-6 w-6 text-gray-600"}),"تفاصيل الفاتورة"]})}),(0,b.jsxs)("div",{className:"space-y-6 mt-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:"معلومات الفاتورة"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"رقم الفاتورة"}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold",children:P.invoiceNumber})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"النوع"}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold",children:P.type})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsxs)("p",{className:"text-gray-500 text-sm mb-1 flex items-center gap-1",children:[(0,b.jsx)(i.Calendar,{className:"h-4 w-4"})," التاريخ"]}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold",children:new Date(P.issuedAt).toLocaleDateString("ar-EG")})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsxs)("p",{className:"text-gray-500 text-sm mb-1 flex items-center gap-1",children:[(0,b.jsx)(j.User,{className:"h-4 w-4"})," المالك"]}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold",children:P.ownerAssociation?.name})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:"معلومات الوحدة"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsxs)("p",{className:"text-gray-500 text-sm mb-1 flex items-center gap-1",children:[(0,b.jsx)(k.Building2,{className:"h-4 w-4"})," الوحدة"]}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold",children:P.unit?.name}),(0,b.jsxs)("p",{className:"text-gray-500 text-xs mt-1",children:["(",P.unit?.code,")"]})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"المشروع"}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold",children:P.unit?.project?.name})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:"ملخص الدفع"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"الإجمالي"}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold text-xl",children:P.amount.toFixed(2)}),(0,b.jsx)("p",{className:"text-gray-500 text-xs",children:"ج.م"})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"المدفوع"}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold text-xl",children:P.totalPaid.toFixed(2)}),(0,b.jsx)("p",{className:"text-gray-500 text-xs",children:"ج.م"})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"المتبقي"}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold text-xl",children:Math.max(0,P.remainingBalance).toFixed(2)}),(0,b.jsx)("p",{className:"text-gray-500 text-xs",children:"ج.م"})]})]})]}),P.expenses&&P.expenses.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:"تفاصيل النفقات"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-[#E5E7EB] bg-[#F3F4F6]",children:[(0,b.jsx)("th",{className:"text-right text-gray-900 font-semibold py-3 px-4 text-[15px]",children:"التاريخ"}),(0,b.jsx)("th",{className:"text-right text-gray-900 font-semibold py-3 px-4 text-[15px]",children:"الوصف"}),(0,b.jsx)("th",{className:"text-right text-gray-900 font-semibold py-3 px-4 text-[15px]",children:"المبلغ"})]})}),(0,b.jsxs)("tbody",{children:[P.expenses.map(a=>(0,b.jsxs)("tr",{className:"border-b border-[#E5E7EB] hover:bg-[#F9FAFB]",children:[(0,b.jsx)("td",{className:"text-gray-500 py-3 px-4 text-[14px]",children:new Date(a.date).toLocaleDateString("ar-EG",{year:"numeric",month:"short",day:"numeric"})}),(0,b.jsx)("td",{className:"text-gray-500 py-3 px-4 text-[14px]",children:a.description}),(0,b.jsxs)("td",{className:"text-gray-900 font-semibold py-3 px-4 text-[14px]",children:[a.amount.toLocaleString()," ج.م"]})]},a.id)),(0,b.jsxs)("tr",{className:"bg-[#F9FAFB] border-t border-[#E5E7EB]",children:[(0,b.jsx)("td",{colSpan:2,className:"text-gray-900 font-semibold py-3 px-4",children:"إجمالي النفقات"}),(0,b.jsxs)("td",{className:"text-gray-900 font-semibold py-3 px-4",children:[P.expenses.reduce((a,b)=>a+b.amount,0).toLocaleString()," ج.م"]})]})]})]})})]}),P.payments&&P.payments.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:"المدفوعات المسجلة"}),(0,b.jsx)("div",{className:"space-y-2",children:P.payments.map((a,c)=>(0,b.jsxs)("div",{className:"flex justify-between items-center bg-gray-50 rounded-[12px] p-3 border border-[#E5E7EB]",children:[(0,b.jsxs)("span",{className:"text-gray-500",children:["دفعة ",c+1]}),(0,b.jsxs)("span",{className:"text-gray-900 font-semibold",children:[a.amount.toFixed(2)," ج.م"]})]},a.id))})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-[#E5E7EB]",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"الحالة:"}),(0,b.jsx)(q.Badge,{className:P.isPaid?"bg-[#ECFDF5] border border-[#16A34A]/20 text-[#16A34A]":0===P.totalPaid||void 0===P.totalPaid?"bg-[#FEF2F2] border border-[#DC2626]/20 text-[#DC2626]":"bg-[#FFFBEB] border border-[#F59E0B]/20 text-[#F59E0B]",variant:"outline",children:ar(P).status})]}),!P.isPaid&&(0,b.jsxs)(o.Button,{onClick:()=>{U(""),Y(null),S(!0)},className:"w-full mt-6 bg-[#2563EB] hover:bg-[#1D4ED8] text-white",children:[(0,b.jsx)(f.DollarSign,{className:"h-4 w-4 ml-2"}),"إضافة دفعة"]})]})]})}),(0,b.jsx)(v.Dialog,{open:R,onOpenChange:a=>{a||(S(!1),U(""),Y(null))},children:(0,b.jsxs)(v.DialogContent,{className:"max-w-md bg-white",children:[(0,b.jsx)(v.DialogHeader,{children:(0,b.jsx)(v.DialogTitle,{className:"text-xl text-gray-900",children:"إضافة دفعة"})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"الفاتورة"}),(0,b.jsx)("p",{className:"text-gray-900 font-semibold",children:P?.invoiceNumber})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-[12px] p-4 border border-[#E5E7EB]",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:"المبلغ المتبقي"}),(0,b.jsxs)("p",{className:"text-gray-900 font-semibold text-2xl",children:[P?P.remainingBalance.toFixed(2):"0"," ج.م"]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-gray-500 text-sm font-medium",children:"المبلغ"}),(0,b.jsx)(u.Input,{type:"number",placeholder:"أدخل المبلغ",value:T,onChange:a=>{U(a.target.value),Y(null)},disabled:V,className:"bg-white border-gray-200 text-gray-900 placeholder:text-gray-400",step:"0.01",min:"0"})]}),X&&(0,b.jsxs)(r.Alert,{className:"bg-[#FEF2F2] border-[#DC2626]/30",children:[(0,b.jsx)(g.AlertCircle,{className:"h-4 w-4 text-[#DC2626]"}),(0,b.jsx)(r.AlertDescription,{className:"text-[#DC2626]",children:X})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)(o.Button,{onClick:()=>{S(!1),U(""),Y(null)},disabled:V,variant:"outline",className:"flex-1 border-gray-300 text-gray-700 hover:bg-gray-50",children:"إلغاء"}),(0,b.jsx)(o.Button,{onClick:aq,disabled:V,className:"flex-1 bg-[#2563EB] hover:bg-[#1D4ED8] text-white",children:V?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Loader,{className:"h-4 w-4 animate-spin ml-2"}),"جاري الحفظ..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.CheckCircle2,{className:"h-4 w-4 ml-2"}),"حفظ الدفعة"]})})]})]})]})})]})}):null}a.s(["default",()=>w])}];

//# sourceMappingURL=Desktop_cmd-main_src_app_dashboard_invoices_page_tsx_eedd054a._.js.map