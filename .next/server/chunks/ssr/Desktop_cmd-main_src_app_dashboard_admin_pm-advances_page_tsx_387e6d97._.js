module.exports=[98897,a=>{"use strict";let b,c,d;var e=a.i(43713),f=a.i(68599),g=a.i(84642),h=a.i(84194),i=a.i(41662),j=a.i(66128),k=a.i(20179),l=a.i(63395),m=a.i(57684),n=/[\\\/_+.#"@\[\(\{&]/,o=/[\\\/_+.#"@\[\(\{&]/g,p=/[\s-]/,q=/[\s-]/g;function r(a){return a.toLowerCase().replace(q," ")}var s=a.i(97882),t=a.i(58080),u=a.i(40523),v=a.i(78252),w='[cmdk-group=""]',x='[cmdk-group-items=""]',y='[cmdk-item=""]',z=`${y}:not([aria-disabled="true"])`,A="cmdk-item-select",B="data-value",C=(a,b,c)=>{var d;return d=a,function a(b,c,d,e,f,g,h){if(g===c.length)return f===b.length?1:.99;var i=`${f},${g}`;if(void 0!==h[i])return h[i];for(var j,k,l,m,r=e.charAt(g),s=d.indexOf(r,f),t=0;s>=0;)(j=a(b,c,d,e,s+1,g+1,h))>t&&(s===f?j*=1:n.test(b.charAt(s-1))?(j*=.8,(l=b.slice(f,s-1).match(o))&&f>0&&(j*=Math.pow(.999,l.length))):p.test(b.charAt(s-1))?(j*=.9,(m=b.slice(f,s-1).match(q))&&f>0&&(j*=Math.pow(.999,m.length))):(j*=.17,f>0&&(j*=Math.pow(.999,s-f))),b.charAt(s)!==c.charAt(g)&&(j*=.9999)),(j<.1&&d.charAt(s-1)===e.charAt(g+1)||e.charAt(g+1)===e.charAt(g)&&d.charAt(s-1)!==e.charAt(g))&&.1*(k=a(b,c,d,e,s+1,g+2,h))>j&&(j=.1*k),j>t&&(t=j),s=d.indexOf(r,s+1);return h[i]=t,t}(d=c&&c.length>0?`${d+" "+c.join(" ")}`:d,b,r(d),r(b),0,0,{})},D=f.createContext(void 0),E=f.createContext(void 0),F=f.createContext(void 0),G=f.forwardRef((a,b)=>{let c=Q(()=>{var b,c;return{search:"",value:null!=(c=null!=(b=a.value)?b:a.defaultValue)?c:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),d=Q(()=>new Set),e=Q(()=>new Map),g=Q(()=>new Map),h=Q(()=>new Set),i=O(a),{label:j,children:k,value:l,onValueChange:m,filter:n,shouldFilter:o,loop:p,disablePointerSelection:q=!1,vimBindings:r=!0,...s}=a,v=(0,u.useId)(),F=(0,u.useId)(),G=(0,u.useId)(),H=f.useRef(null),I=T();P(()=>{if(void 0!==l){let a=l.trim();c.current.value=a,J.emit()}},[l]),P(()=>{I(6,S)},[]);let J=f.useMemo(()=>({subscribe:a=>(h.current.add(a),()=>h.current.delete(a)),snapshot:()=>c.current,setState:(a,b,d)=>{var e,f,g,h;if(!Object.is(c.current[a],b)){if(c.current[a]=b,"search"===a)R(),M(),I(1,N);else if("value"===a){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let a=document.getElementById(G);a?a.focus():null==(e=document.getElementById(v))||e.focus()}if(I(7,()=>{var a;c.current.selectedItemId=null==(a=W())?void 0:a.id,J.emit()}),d||I(5,S),(null==(f=i.current)?void 0:f.value)!==void 0){null==(h=(g=i.current).onValueChange)||h.call(g,null!=b?b:"");return}}J.emit()}},emit:()=>{h.current.forEach(a=>a())}}),[]),K=f.useMemo(()=>({value:(a,b,d)=>{var e;b!==(null==(e=g.current.get(a))?void 0:e.value)&&(g.current.set(a,{value:b,keywords:d}),c.current.filtered.items.set(a,L(b,d)),I(2,()=>{M(),J.emit()}))},item:(a,b)=>(d.current.add(a),b&&(e.current.has(b)?e.current.get(b).add(a):e.current.set(b,new Set([a]))),I(3,()=>{R(),M(),c.current.value||N(),J.emit()}),()=>{g.current.delete(a),d.current.delete(a),c.current.filtered.items.delete(a);let b=W();I(4,()=>{R(),(null==b?void 0:b.getAttribute("id"))===a&&N(),J.emit()})}),group:a=>(e.current.has(a)||e.current.set(a,new Set),()=>{g.current.delete(a),e.current.delete(a)}),filter:()=>i.current.shouldFilter,label:j||a["aria-label"],getDisablePointerSelection:()=>i.current.disablePointerSelection,listId:v,inputId:G,labelId:F,listInnerRef:H}),[]);function L(a,b){var d,e;let f=null!=(e=null==(d=i.current)?void 0:d.filter)?e:C;return a?f(a,c.current.search,b):0}function M(){if(!c.current.search||!1===i.current.shouldFilter)return;let a=c.current.filtered.items,b=[];c.current.filtered.groups.forEach(c=>{let d=e.current.get(c),f=0;d.forEach(b=>{f=Math.max(a.get(b),f)}),b.push([c,f])});let d=H.current;X().sort((b,c)=>{var d,e;let f=b.getAttribute("id"),g=c.getAttribute("id");return(null!=(d=a.get(g))?d:0)-(null!=(e=a.get(f))?e:0)}).forEach(a=>{let b=a.closest(x);b?b.appendChild(a.parentElement===b?a:a.closest(`${x} > *`)):d.appendChild(a.parentElement===d?a:a.closest(`${x} > *`))}),b.sort((a,b)=>b[1]-a[1]).forEach(a=>{var b;let c=null==(b=H.current)?void 0:b.querySelector(`${w}[${B}="${encodeURIComponent(a[0])}"]`);null==c||c.parentElement.appendChild(c)})}function N(){let a=X().find(a=>"true"!==a.getAttribute("aria-disabled")),b=null==a?void 0:a.getAttribute(B);J.setState("value",b||void 0)}function R(){var a,b,f,h;if(!c.current.search||!1===i.current.shouldFilter){c.current.filtered.count=d.current.size;return}c.current.filtered.groups=new Set;let j=0;for(let e of d.current){let d=L(null!=(b=null==(a=g.current.get(e))?void 0:a.value)?b:"",null!=(h=null==(f=g.current.get(e))?void 0:f.keywords)?h:[]);c.current.filtered.items.set(e,d),d>0&&j++}for(let[a,b]of e.current)for(let d of b)if(c.current.filtered.items.get(d)>0){c.current.filtered.groups.add(a);break}c.current.filtered.count=j}function S(){var a,b,c;let d=W();d&&((null==(a=d.parentElement)?void 0:a.firstChild)===d&&(null==(c=null==(b=d.closest(w))?void 0:b.querySelector('[cmdk-group-heading=""]'))||c.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function W(){var a;return null==(a=H.current)?void 0:a.querySelector(`${y}[aria-selected="true"]`)}function X(){var a;return Array.from((null==(a=H.current)?void 0:a.querySelectorAll(z))||[])}function Y(a){let b=X()[a];b&&J.setState("value",b.getAttribute(B))}function Z(a){var b;let c=W(),d=X(),e=d.findIndex(a=>a===c),f=d[e+a];null!=(b=i.current)&&b.loop&&(f=e+a<0?d[d.length-1]:e+a===d.length?d[0]:d[e+a]),f&&J.setState("value",f.getAttribute(B))}function $(a){let b=W(),c=null==b?void 0:b.closest(w),d;for(;c&&!d;)d=null==(c=a>0?function(a,b){let c=a.nextElementSibling;for(;c;){if(c.matches(b))return c;c=c.nextElementSibling}}(c,w):function(a,b){let c=a.previousElementSibling;for(;c;){if(c.matches(b))return c;c=c.previousElementSibling}}(c,w))?void 0:c.querySelector(z);d?J.setState("value",d.getAttribute(B)):Z(a)}let _=()=>Y(X().length-1),aa=a=>{a.preventDefault(),a.metaKey?_():a.altKey?$(1):Z(1)},ab=a=>{a.preventDefault(),a.metaKey?Y(0):a.altKey?$(-1):Z(-1)};return f.createElement(t.Primitive.div,{ref:b,tabIndex:-1,...s,"cmdk-root":"",onKeyDown:a=>{var b;null==(b=s.onKeyDown)||b.call(s,a);let c=a.nativeEvent.isComposing||229===a.keyCode;if(!(a.defaultPrevented||c))switch(a.key){case"n":case"j":r&&a.ctrlKey&&aa(a);break;case"ArrowDown":aa(a);break;case"p":case"k":r&&a.ctrlKey&&ab(a);break;case"ArrowUp":ab(a);break;case"Home":a.preventDefault(),Y(0);break;case"End":a.preventDefault(),_();break;case"Enter":{a.preventDefault();let b=W();if(b){let a=new Event(A);b.dispatchEvent(a)}}}}},f.createElement("label",{"cmdk-label":"",htmlFor:K.inputId,id:K.labelId,style:V},j),U(a,a=>f.createElement(E.Provider,{value:J},f.createElement(D.Provider,{value:K},a))))}),H=f.forwardRef((a,b)=>{var c,d;let e=(0,u.useId)(),g=f.useRef(null),h=f.useContext(F),i=f.useContext(D),j=O(a),k=null!=(d=null==(c=j.current)?void 0:c.forceMount)?d:null==h?void 0:h.forceMount;P(()=>{if(!k)return i.item(e,null==h?void 0:h.id)},[k]);let l=S(e,g,[a.value,a.children,g],a.keywords),m=f.useContext(E),n=R(a=>a.value&&a.value===l.current),o=R(a=>!!k||!1===i.filter()||!a.search||a.filtered.items.get(e)>0);function p(){var a,b;q(),null==(b=(a=j.current).onSelect)||b.call(a,l.current)}function q(){m.setState("value",l.current,!0)}if(f.useEffect(()=>{let b=g.current;if(!(!b||a.disabled))return b.addEventListener(A,p),()=>b.removeEventListener(A,p)},[o,a.onSelect,a.disabled]),!o)return null;let{disabled:r,value:s,onSelect:w,forceMount:x,keywords:y,...z}=a;return f.createElement(t.Primitive.div,{ref:(0,v.composeRefs)(g,b),...z,id:e,"cmdk-item":"",role:"option","aria-disabled":!!r,"aria-selected":!!n,"data-disabled":!!r,"data-selected":!!n,onPointerMove:r||i.getDisablePointerSelection()?void 0:q,onClick:r?void 0:p},a.children)}),I=f.forwardRef((a,b)=>{let{heading:c,children:d,forceMount:e,...g}=a,h=(0,u.useId)(),i=f.useRef(null),j=f.useRef(null),k=(0,u.useId)(),l=f.useContext(D),m=R(a=>!!e||!1===l.filter()||!a.search||a.filtered.groups.has(h));P(()=>l.group(h),[]),S(h,i,[a.value,a.heading,j]);let n=f.useMemo(()=>({id:h,forceMount:e}),[e]);return f.createElement(t.Primitive.div,{ref:(0,v.composeRefs)(i,b),...g,"cmdk-group":"",role:"presentation",hidden:!m||void 0},c&&f.createElement("div",{ref:j,"cmdk-group-heading":"","aria-hidden":!0,id:k},c),U(a,a=>f.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":c?k:void 0},f.createElement(F.Provider,{value:n},a))))}),J=f.forwardRef((a,b)=>{let{alwaysRender:c,...d}=a,e=f.useRef(null),g=R(a=>!a.search);return c||g?f.createElement(t.Primitive.div,{ref:(0,v.composeRefs)(e,b),...d,"cmdk-separator":"",role:"separator"}):null}),K=f.forwardRef((a,b)=>{let{onValueChange:c,...d}=a,e=null!=a.value,g=f.useContext(E),h=R(a=>a.search),i=R(a=>a.selectedItemId),j=f.useContext(D);return f.useEffect(()=>{null!=a.value&&g.setState("search",a.value)},[a.value]),f.createElement(t.Primitive.input,{ref:b,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":j.listId,"aria-labelledby":j.labelId,"aria-activedescendant":i,id:j.inputId,type:"text",value:e?a.value:h,onChange:a=>{e||g.setState("search",a.target.value),null==c||c(a.target.value)}})}),L=f.forwardRef((a,b)=>{let{children:c,label:d="Suggestions",...e}=a,g=f.useRef(null),h=f.useRef(null),i=R(a=>a.selectedItemId),j=f.useContext(D);return f.useEffect(()=>{if(h.current&&g.current){let a=h.current,b=g.current,c,d=new ResizeObserver(()=>{c=requestAnimationFrame(()=>{let c=a.offsetHeight;b.style.setProperty("--cmdk-list-height",c.toFixed(1)+"px")})});return d.observe(a),()=>{cancelAnimationFrame(c),d.unobserve(a)}}},[]),f.createElement(t.Primitive.div,{ref:(0,v.composeRefs)(g,b),...e,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":i,"aria-label":d,id:j.listId},U(a,a=>f.createElement("div",{ref:(0,v.composeRefs)(h,j.listInnerRef),"cmdk-list-sizer":""},a)))}),M=f.forwardRef((a,b)=>{let{open:c,onOpenChange:d,overlayClassName:e,contentClassName:g,container:h,...i}=a;return f.createElement(s.Root,{open:c,onOpenChange:d},f.createElement(s.Portal,{container:h},f.createElement(s.Overlay,{"cmdk-overlay":"",className:e}),f.createElement(s.Content,{"aria-label":a.label,"cmdk-dialog":"",className:g},f.createElement(G,{ref:b,...i}))))}),N=Object.assign(G,{List:L,Item:H,Input:K,Group:I,Separator:J,Dialog:M,Empty:f.forwardRef((a,b)=>R(a=>0===a.filtered.count)?f.createElement(t.Primitive.div,{ref:b,...a,"cmdk-empty":"",role:"presentation"}):null),Loading:f.forwardRef((a,b)=>{let{progress:c,children:d,label:e="Loading...",...g}=a;return f.createElement(t.Primitive.div,{ref:b,...g,"cmdk-loading":"",role:"progressbar","aria-valuenow":c,"aria-valuemin":0,"aria-valuemax":100,"aria-label":e},U(a,a=>f.createElement("div",{"aria-hidden":!0},a)))})});function O(a){let b=f.useRef(a);return P(()=>{b.current=a}),b}var P=f.useEffect;function Q(a){let b=f.useRef();return void 0===b.current&&(b.current=a()),b}function R(a){let b=f.useContext(E),c=()=>a(b.snapshot());return f.useSyncExternalStore(b.subscribe,c,c)}function S(a,b,c,d=[]){let e=f.useRef(),g=f.useContext(D);return P(()=>{var f;let h=(()=>{var a;for(let b of c){if("string"==typeof b)return b.trim();if("object"==typeof b&&"current"in b)return b.current?null==(a=b.current.textContent)?void 0:a.trim():e.current}})(),i=d.map(a=>a.trim());g.value(a,h,i),null==(f=b.current)||f.setAttribute(B,h),e.current=h}),e}var T=()=>{let[a,b]=f.useState(),c=Q(()=>new Map);return P(()=>{c.current.forEach(a=>a()),c.current=new Map},[a]),(a,d)=>{c.current.set(a,d),b({})}};function U({asChild:a,children:b},c){let d;return a&&f.isValidElement(b)?f.cloneElement("function"==typeof(d=b.type)?d(b.props):"render"in d?d.render(b.props):b,{ref:b.ref},c(b.props.children)):c(b)}var V={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},W=a.i(886),W=W,X=a.i(48421);function Y({className:a,...b}){return(0,e.jsx)(N,{"data-slot":"command",className:(0,i.cn)("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",a),...b})}function Z({className:a,...b}){return(0,e.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,e.jsx)(W.default,{className:"size-4 shrink-0 opacity-50"}),(0,e.jsx)(N.Input,{"data-slot":"command-input",className:(0,i.cn)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",a),...b})]})}function $({className:a,...b}){return(0,e.jsx)(N.List,{"data-slot":"command-list",className:(0,i.cn)("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",a),...b})}function _({...a}){return(0,e.jsx)(N.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...a})}function aa({className:a,...b}){return(0,e.jsx)(N.Group,{"data-slot":"command-group",className:(0,i.cn)("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",a),...b})}function ab({className:a,...b}){return(0,e.jsx)(N.Item,{"data-slot":"command-item",className:(0,i.cn)("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...b})}var ac=a.i(17272),ad=a.i(59627),ae=a.i(61977),af=a.i(30737),ag=a.i(71949),ah=a.i(58159),ai=a.i(30308),aj=a.i(91290),ak=a.i(88423),al=a.i(22819),am=a.i(12477),an=Symbol("radix.slottable");function ao(a){return f.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===an}var ap=a.i(45158),aq=a.i(32038),ar=a.i(72925),as="Popover",[at,au]=(0,ag.createContextScope)(as,[ak.createPopperScope]),av=(0,ak.createPopperScope)(),[aw,ax]=at(as),ay=a=>{let{__scopePopover:b,children:c,open:d,defaultOpen:g,onOpenChange:h,modal:i=!1}=a,j=av(b),k=f.useRef(null),[l,m]=f.useState(!1),[n,o]=(0,ap.useControllableState)({prop:d,defaultProp:g??!1,onChange:h,caller:as});return(0,e.jsx)(ak.Root,{...j,children:(0,e.jsx)(aw,{scope:b,contentId:(0,u.useId)(),triggerRef:k,open:n,onOpenChange:o,onOpenToggle:f.useCallback(()=>o(a=>!a),[o]),hasCustomAnchor:l,onCustomAnchorAdd:f.useCallback(()=>m(!0),[]),onCustomAnchorRemove:f.useCallback(()=>m(!1),[]),modal:i,children:c})})};ay.displayName=as;var az="PopoverAnchor";f.forwardRef((a,b)=>{let{__scopePopover:c,...d}=a,g=ax(az,c),h=av(c),{onCustomAnchorAdd:i,onCustomAnchorRemove:j}=g;return f.useEffect(()=>(i(),()=>j()),[i,j]),(0,e.jsx)(ak.Anchor,{...h,...d,ref:b})}).displayName=az;var aA="PopoverTrigger",aB=f.forwardRef((a,b)=>{let{__scopePopover:c,...d}=a,f=ax(aA,c),g=av(c),h=(0,v.useComposedRefs)(b,f.triggerRef),i=(0,e.jsx)(t.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":f.open,"aria-controls":f.contentId,"data-state":aN(f.open),...d,ref:h,onClick:(0,af.composeEventHandlers)(a.onClick,f.onOpenToggle)});return f.hasCustomAnchor?i:(0,e.jsx)(ak.Anchor,{asChild:!0,...g,children:i})});aB.displayName=aA;var aC="PopoverPortal",[aD,aE]=at(aC,{forceMount:void 0}),aF=a=>{let{__scopePopover:b,forceMount:c,children:d,container:f}=a,g=ax(aC,b);return(0,e.jsx)(aD,{scope:b,forceMount:c,children:(0,e.jsx)(am.Presence,{present:c||g.open,children:(0,e.jsx)(al.Portal,{asChild:!0,container:f,children:d})})})};aF.displayName=aC;var aG="PopoverContent",aH=f.forwardRef((a,b)=>{let c=aE(aG,a.__scopePopover),{forceMount:d=c.forceMount,...f}=a,g=ax(aG,a.__scopePopover);return(0,e.jsx)(am.Presence,{present:d||g.open,children:g.modal?(0,e.jsx)(aJ,{...f,ref:b}):(0,e.jsx)(aK,{...f,ref:b})})});aH.displayName=aG;var aI=((d=f.forwardRef((a,b)=>{let{children:c,...d}=a;if(f.isValidElement(c)){var e;let a,g,h=(e=c,(g=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(g=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref),i=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==f.Fragment&&(i.ref=b?(0,v.composeRefs)(b,h):h),f.cloneElement(c,i)}return f.Children.count(c)>1?f.Children.only(null):null})).displayName="PopoverContent.RemoveScroll.SlotClone",b=d,(c=f.forwardRef((a,c)=>{let{children:d,...g}=a,h=f.Children.toArray(d),i=h.find(ao);if(i){let a=i.props.children,d=h.map(b=>b!==i?b:f.Children.count(a)>1?f.Children.only(null):f.isValidElement(a)?a.props.children:null);return(0,e.jsx)(b,{...g,ref:c,children:f.isValidElement(a)?f.cloneElement(a,void 0,d):null})}return(0,e.jsx)(b,{...g,ref:c,children:d})})).displayName="PopoverContent.RemoveScroll.Slot",c),aJ=f.forwardRef((a,b)=>{let c=ax(aG,a.__scopePopover),d=f.useRef(null),g=(0,v.useComposedRefs)(b,d),h=f.useRef(!1);return f.useEffect(()=>{let a=d.current;if(a)return(0,aq.hideOthers)(a)},[]),(0,e.jsx)(ar.RemoveScroll,{as:aI,allowPinchZoom:!0,children:(0,e.jsx)(aL,{...a,ref:g,trapFocus:c.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,af.composeEventHandlers)(a.onCloseAutoFocus,a=>{a.preventDefault(),h.current||c.triggerRef.current?.focus()}),onPointerDownOutside:(0,af.composeEventHandlers)(a.onPointerDownOutside,a=>{let b=a.detail.originalEvent,c=0===b.button&&!0===b.ctrlKey;h.current=2===b.button||c},{checkForDefaultPrevented:!1}),onFocusOutside:(0,af.composeEventHandlers)(a.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),aK=f.forwardRef((a,b)=>{let c=ax(aG,a.__scopePopover),d=f.useRef(!1),g=f.useRef(!1);return(0,e.jsx)(aL,{...a,ref:b,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:b=>{a.onCloseAutoFocus?.(b),b.defaultPrevented||(d.current||c.triggerRef.current?.focus(),b.preventDefault()),d.current=!1,g.current=!1},onInteractOutside:b=>{a.onInteractOutside?.(b),b.defaultPrevented||(d.current=!0,"pointerdown"===b.detail.originalEvent.type&&(g.current=!0));let e=b.target;c.triggerRef.current?.contains(e)&&b.preventDefault(),"focusin"===b.detail.originalEvent.type&&g.current&&b.preventDefault()}})}),aL=f.forwardRef((a,b)=>{let{__scopePopover:c,trapFocus:d,onOpenAutoFocus:f,onCloseAutoFocus:g,disableOutsidePointerEvents:h,onEscapeKeyDown:i,onPointerDownOutside:j,onFocusOutside:k,onInteractOutside:l,...m}=a,n=ax(aG,c),o=av(c);return(0,ai.useFocusGuards)(),(0,e.jsx)(aj.FocusScope,{asChild:!0,loop:!0,trapped:d,onMountAutoFocus:f,onUnmountAutoFocus:g,children:(0,e.jsx)(ah.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:h,onInteractOutside:l,onEscapeKeyDown:i,onPointerDownOutside:j,onFocusOutside:k,onDismiss:()=>n.onOpenChange(!1),children:(0,e.jsx)(ak.Content,{"data-state":aN(n.open),role:"dialog",id:n.contentId,...o,...m,ref:b,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),aM="PopoverClose";function aN(a){return a?"open":"closed"}function aO({...a}){return(0,e.jsx)(ay,{"data-slot":"popover",...a})}function aP({...a}){return(0,e.jsx)(aB,{"data-slot":"popover-trigger",...a})}function aQ({className:a,align:b="center",sideOffset:c=4,...d}){return(0,e.jsx)(aF,{children:(0,e.jsx)(aH,{"data-slot":"popover-content",align:b,sideOffset:c,className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",a),...d})})}f.forwardRef((a,b)=>{let{__scopePopover:c,...d}=a,f=ax(aM,c);return(0,e.jsx)(t.Primitive.button,{type:"button",...d,ref:b,onClick:(0,af.composeEventHandlers)(a.onClick,()=>f.onOpenChange(!1))})}).displayName=aM,f.forwardRef((a,b)=>{let{__scopePopover:c,...d}=a,f=av(c);return(0,e.jsx)(ak.Arrow,{...f,...d,ref:b})}).displayName="PopoverArrow";var aR=a.i(66689),aS=a.i(48367),aT=a.i(84177),aU=a.i(72760),aV=a.i(88497),aW=a.i(90306);let aX=(0,aW.default)("chevrons-up-down",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);var aY=a.i(94171);let aZ=(0,aW.default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var a$=a.i(61231),a_=a.i(22488),a0=a.i(50063);let a1="__NO_PROJECT__";function a2(){let{data:a}=(0,g.useSession)(),{toast:b}=(0,h.useToast)(),[c,d]=(0,f.useState)([]),[n,o]=(0,f.useState)(!0),[p,q]=(0,f.useState)(!1),[r,s]=(0,f.useState)(!1),[t,u]=(0,f.useState)({staffId:"",projectId:"",amount:""}),[v,w]=(0,f.useState)(!1),[x,y]=(0,f.useState)([]),[z,A]=(0,f.useState)([]),[B,C]=(0,f.useState)(!1),[D,E]=(0,f.useState)(null),[F,G]=(0,f.useState)({amount:"",projectId:""}),[H,I]=(0,f.useState)(!1),[J,K]=(0,f.useState)(!1),[L,M]=(0,f.useState)(null),[N,O]=(0,f.useState)(!1),[P,Q]=(0,f.useState)(null),R=a?.user?.role==="ADMIN"||a?.user?.role==="ACCOUNTANT",S=(0,f.useCallback)(async()=>{try{let a=await fetch("/api/pm-advances");if(!a.ok)throw Error("Failed to fetch");let b=await a.json();d(Array.isArray(b)?b:[])}catch(a){b({title:"خطأ",description:"تعذر تحديث قائمة العهد.",variant:"destructive"})}},[b]);(0,f.useEffect)(()=>{(async()=>{o(!0);try{await Promise.all([S(),fetch("/api/projects").then(a=>a.json()).then(a=>y(a)),fetch("/api/staff").then(a=>a.json()).then(a=>A(a))])}catch(a){console.error(a)}finally{o(!1)}})()},[S]);let{totalAllocated:T,totalSpent:U,totalRemaining:V,highUsageCount:W}=(0,f.useMemo)(()=>c.reduce((a,b)=>(a.totalAllocated+=b.amount,a.totalSpent+=b.totalSpent,a.totalRemaining+=b.remainingAmount,b.percentageUsed>=80&&a.highUsageCount++,a),{totalAllocated:0,totalSpent:0,totalRemaining:0,highUsageCount:0}),[c]),af=(0,f.useMemo)(()=>{let a=new Map;return c.forEach(b=>{let c=a.get(b.staff.id);c?(c.totalAmount+=b.amount,c.totalSpent+=b.totalSpent,c.totalRemaining+=b.remainingAmount,c.advances.push(b),c.percentageUsed=c.totalSpent/c.totalAmount*100):a.set(b.staff.id,{staffId:b.staff.id,staffName:b.staff.name,totalAmount:b.amount,totalSpent:b.totalSpent,totalRemaining:b.remainingAmount,percentageUsed:b.percentageUsed,advances:[b]})}),Array.from(a.values())},[c]),ag=async a=>{a.preventDefault(),s(!0);try{if(!(await fetch("/api/pm-advances",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error();b({title:"تمت الإضافة",description:"تم تخصيص العهدة بنجاح."}),q(!1),u({staffId:"",projectId:"",amount:""}),S()}catch(a){b({title:"خطأ",description:"فشل في إضافة العهدة.",variant:"destructive"})}finally{s(!1)}},ah=async a=>{if(a.preventDefault(),D){I(!0);try{if(!(await fetch(`/api/pm-advances/${D.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)})).ok)throw Error();C(!1),S(),b({title:"تم التحديث",description:"تم تعديل بيانات العهدة."})}catch(a){b({title:"خطأ",description:"فشل في التحديث.",variant:"destructive"})}finally{I(!1)}}},ai=async()=>{if(L){O(!0);try{if(!(await fetch(`/api/pm-advances/${L.id}`,{method:"DELETE"})).ok)throw Error();K(!1),S(),b({title:"تم الحذف",description:"تم حذف العهدة نهائياً."})}catch(a){b({title:"خطأ",description:"تعذر حذف العهدة.",variant:"destructive"})}finally{O(!1)}}};return n?(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(a=>(0,e.jsxs)(m.Card,{children:[(0,e.jsx)(m.CardHeader,{children:(0,e.jsx)(aT.Skeleton,{className:"h-4 w-24"})}),(0,e.jsx)(m.CardContent,{children:(0,e.jsx)(aT.Skeleton,{className:"h-8 w-32"})})]},a))}),(0,e.jsx)(aT.Skeleton,{className:"h-[400px] w-full"})]}):(0,e.jsxs)("div",{className:"space-y-6",dir:"rtl",children:[(0,e.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"عهد الموظفين"}),(0,e.jsx)("p",{className:"mt-2 text-muted-foreground",children:"تتبع العهد المخصصة لكل موظف ومراقبة الصرفيات والمتبقي لحظياً."})]}),R&&(0,e.jsxs)(X.Dialog,{open:p,onOpenChange:q,children:[(0,e.jsx)(X.DialogTrigger,{asChild:!0,children:(0,e.jsxs)(l.Button,{className:"gap-2",children:[(0,e.jsx)(a_.Plus,{className:"h-4 w-4"})," إضافة عهدة جديدة"]})}),(0,e.jsxs)(X.DialogContent,{className:"max-w-md",children:[(0,e.jsxs)(X.DialogHeader,{children:[(0,e.jsx)(X.DialogTitle,{children:"إضافة عهدة جديدة"}),(0,e.jsx)(X.DialogDescription,{children:"خصص عهدة مالية لأي موظف مع إمكانية ربطها بمشروع محدد."})]}),(0,e.jsxs)("form",{onSubmit:ag,className:"space-y-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(ae.Label,{children:"الموظف *"}),(0,e.jsxs)(aO,{open:v,onOpenChange:w,children:[(0,e.jsx)(aP,{asChild:!0,children:(0,e.jsxs)(l.Button,{variant:"outline",className:"w-full justify-between",children:[t.staffId?z.find(a=>a.id===t.staffId)?.name:"اختر الموظف",(0,e.jsx)(aX,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,e.jsx)(aQ,{className:"p-0",children:(0,e.jsxs)(Y,{children:[(0,e.jsx)(Z,{placeholder:"ابحث عن الموظف..."}),(0,e.jsxs)($,{children:[(0,e.jsx)(_,{children:"لا يوجد موظفون"}),(0,e.jsx)(aa,{children:z.map(a=>(0,e.jsxs)(ab,{onSelect:()=>{u({...t,staffId:a.id}),w(!1)},children:[(0,e.jsx)(aV.Check,{className:(0,i.cn)("ml-2 h-4 w-4",a.id===t.staffId?"opacity-100":"opacity-0")}),a.name]},a.id))})]})]})})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(ae.Label,{children:"المبلغ (جنيه) *"}),(0,e.jsx)(ad.Input,{type:"number",step:"0.01",value:t.amount,onChange:a=>u({...t,amount:a.target.value}),required:!0})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(ae.Label,{children:"المشروع (اختياري)"}),(0,e.jsxs)(aS.Select,{value:t.projectId||a1,onValueChange:a=>u({...t,projectId:a===a1?"":a}),children:[(0,e.jsx)(aS.SelectTrigger,{children:(0,e.jsx)(aS.SelectValue,{placeholder:"اختر المشروع"})}),(0,e.jsxs)(aS.SelectContent,{children:[(0,e.jsx)(aS.SelectItem,{value:a1,children:"بدون مشروع"}),x.map(a=>(0,e.jsx)(aS.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,e.jsx)(X.DialogFooter,{children:(0,e.jsxs)(l.Button,{type:"submit",disabled:r,children:[r&&(0,e.jsx)(aY.Loader2,{className:"ml-2 h-4 w-4 animate-spin"})," إضافة العهدة"]})})]})]})]})]}),(0,e.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,e.jsxs)(m.Card,{children:[(0,e.jsx)(m.CardHeader,{className:"pb-2",children:(0,e.jsx)(m.CardTitle,{className:"text-sm font-medium",children:"إجمالي العهد"})}),(0,e.jsxs)(m.CardContent,{children:[(0,e.jsxs)("div",{className:"text-2xl font-bold",children:[T.toFixed(2)," جنيه"]}),(0,e.jsxs)("p",{className:"text-xs text-muted-foreground",children:[af.length," موظفاً لديهم عهد"]})]})]}),(0,e.jsxs)(m.Card,{children:[(0,e.jsx)(m.CardHeader,{className:"pb-2",children:(0,e.jsx)(m.CardTitle,{className:"text-sm font-medium",children:"المصروف"})}),(0,e.jsxs)(m.CardContent,{children:[(0,e.jsxs)("div",{className:"text-2xl font-bold",children:[U.toFixed(2)," جنيه"]}),(0,e.jsx)("p",{className:"text-xs text-muted-foreground",children:"الصرف التشغيلي والوحدات معاً"})]})]}),(0,e.jsxs)(m.Card,{children:[(0,e.jsx)(m.CardHeader,{className:"pb-2",children:(0,e.jsx)(m.CardTitle,{className:"text-sm font-medium",children:"المتبقي"})}),(0,e.jsx)(m.CardContent,{children:(0,e.jsxs)("div",{className:(0,i.cn)("text-2xl font-bold",V<0?"text-red-600":"text-green-600"),children:[V.toFixed(2)," جنيه"]})})]}),(0,e.jsxs)(m.Card,{children:[(0,e.jsx)(m.CardHeader,{className:"pb-2",children:(0,e.jsx)(m.CardTitle,{className:"text-sm font-medium text-red-600",children:"تنبيهات الاستهلاك"})}),(0,e.jsx)(m.CardContent,{children:(0,e.jsx)("div",{className:"text-2xl font-bold",children:W})})]})]}),(0,e.jsx)("div",{className:"space-y-4",children:0===af.length?(0,e.jsxs)(j.Alert,{children:[(0,e.jsx)(aU.AlertCircle,{className:"h-4 w-4"}),(0,e.jsx)(j.AlertDescription,{children:"لا توجد عهد مسجلة"})]}):af.map(a=>(0,e.jsxs)(m.Card,{children:[(0,e.jsxs)(m.CardHeader,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>Q(P===a.staffId?null:a.staffId),children:[(0,e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(m.CardTitle,{children:a.staffName}),(0,e.jsxs)(m.CardDescription,{children:[a.advances.length," عهدة قائمة"]})]}),(0,e.jsxs)("div",{className:"text-left",children:[(0,e.jsxs)("div",{className:"font-bold text-lg",children:[a.totalAmount.toFixed(2)," ج.م"]}),(0,e.jsx)("div",{className:"text-sm text-muted-foreground",children:"الإجمالي"})]})]}),(0,e.jsx)(aR.Progress,{value:a.percentageUsed,className:"mt-4 h-2"})]}),P===a.staffId&&(0,e.jsx)(m.CardContent,{className:"pt-4 border-t space-y-4",children:a.advances.map(a=>(0,e.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/20",children:[(0,e.jsxs)("div",{className:"flex justify-between items-start",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"font-semibold",children:a.project?.name||"بدون مشروع"}),(0,e.jsxs)("div",{className:"text-xs text-muted-foreground",children:["بتاريخ: ",new Date(a.createdAt).toLocaleDateString("ar-EG")]})]}),(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsxs)("div",{className:"text-left",children:[(0,e.jsx)("div",{className:"font-bold",children:a.amount.toFixed(2)}),(0,e.jsxs)("div",{className:"text-xs font-semibold text-muted-foreground",children:["متبقي: ",a.remainingAmount.toFixed(2)]})]}),(0,e.jsxs)(ac.DropdownMenu,{children:[(0,e.jsx)(ac.DropdownMenuTrigger,{asChild:!0,children:(0,e.jsx)(l.Button,{variant:"ghost",size:"icon",children:(0,e.jsx)(aZ,{className:"h-4 w-4"})})}),(0,e.jsxs)(ac.DropdownMenuContent,{children:[(0,e.jsxs)(ac.DropdownMenuItem,{onClick:()=>{E(a),G({amount:a.amount.toString(),projectId:a.project?.id||""}),C(!0)},children:[(0,e.jsx)(a$.Pencil,{className:"ml-2 h-4 w-4"})," تعديل"]}),(0,e.jsxs)(ac.DropdownMenuItem,{className:"text-red-600",onClick:()=>{M(a),K(!0)},children:[(0,e.jsx)(a0.Trash2,{className:"ml-2 h-4 w-4"})," حذف"]})]})]})]})]}),(0,e.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,e.jsxs)("div",{className:"flex flex-wrap gap-2 text-[11px] text-muted-foreground",children:[(0,e.jsxs)("span",{className:"rounded-full bg-blue-50 px-3 py-1 text-blue-700",children:["إجمالي المصروف: ",(a.totalSpent??0).toFixed(2)," ج.م"]}),(0,e.jsxs)("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-emerald-700",children:["تشغيلي: ",(a.spendingBreakdown?.operationalExpenses??0).toFixed(2)]}),(0,e.jsxs)("span",{className:"rounded-full bg-sky-50 px-3 py-1 text-sky-700",children:["مصروفات وحدات: ",(a.spendingBreakdown?.unitExpenses??0).toFixed(2)]})]}),(0,e.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("h4",{className:"text-xs font-semibold text-muted-foreground",children:"مصروفات تشغيلية مسجلة"}),a.operationalExpenses&&a.operationalExpenses.length>0?(0,e.jsxs)("ul",{className:"space-y-1 text-xs",children:[a.operationalExpenses.slice(0,4).map(a=>(0,e.jsxs)("li",{className:"flex items-center justify-between rounded bg-background/60 px-3 py-2",children:[(0,e.jsxs)("div",{className:"flex-1 pr-3",children:[(0,e.jsx)("p",{className:"truncate font-medium text-sm",children:a.description||"مصروف بدون وصف"}),(a.unit?.project||a.unit)&&(0,e.jsxs)("p",{className:"mt-1 text-[10px] text-muted-foreground",children:[a.unit?.project?a.unit.project.name:"",a.unit?.project&&a.unit?.name?" • ":"",a.unit?.name?`وحدة ${a.unit.name}`:""]})]}),(0,e.jsx)("span",{className:"font-semibold text-xs",children:a.amount.toFixed(2)})]},a.id)),a.operationalExpenses.length>4&&(0,e.jsxs)("li",{className:"text-[11px] text-muted-foreground",children:["+ ",a.operationalExpenses.length-4," عناصر إضافية"]})]}):(0,e.jsx)("p",{className:"text-xs text-muted-foreground",children:"لا توجد مصروفات تشغيلية مسجلة بعد"})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("h4",{className:"text-xs font-semibold text-muted-foreground",children:"مصروفات وحدات"}),a.expenses&&a.expenses.length>0?(0,e.jsxs)("ul",{className:"space-y-1 text-xs",children:[a.expenses.slice(0,4).map(a=>(0,e.jsxs)("li",{className:"flex items-center justify-between rounded bg-background/60 px-3 py-2",children:[(0,e.jsxs)("div",{className:"flex-1 pr-3",children:[(0,e.jsx)("p",{className:"truncate font-medium text-sm",children:a.description||"مصروف بدون وصف"}),(a.unit?.project||a.unit)&&(0,e.jsxs)("p",{className:"mt-1 text-[10px] text-muted-foreground",children:[a.unit?.project?a.unit.project.name:"",a.unit?.project&&a.unit?.name?" • ":"",a.unit?.name?`وحدة ${a.unit.name}`:""]})]}),(0,e.jsx)("span",{className:"font-semibold text-xs",children:a.amount.toFixed(2)})]},a.id)),a.expenses.length>4&&(0,e.jsxs)("li",{className:"text-[11px] text-muted-foreground",children:["+ ",a.expenses.length-4," عناصر إضافية"]})]}):(0,e.jsx)("p",{className:"text-xs text-muted-foreground",children:"لم تُسجل مصروفات وحدات بعد"})]})]})]})]},a.id))})]},a.staffId))}),(0,e.jsx)(X.Dialog,{open:B,onOpenChange:C,children:(0,e.jsxs)(X.DialogContent,{children:[(0,e.jsx)(X.DialogHeader,{children:(0,e.jsx)(X.DialogTitle,{children:"تعديل العهدة"})}),(0,e.jsxs)("form",{onSubmit:ah,className:"space-y-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(ae.Label,{children:"المبلغ المعدل"}),(0,e.jsx)(ad.Input,{type:"number",step:"0.01",value:F.amount,onChange:a=>G({...F,amount:a.target.value})})]}),(0,e.jsx)(X.DialogFooter,{children:(0,e.jsxs)(l.Button,{type:"submit",disabled:H,children:[H&&(0,e.jsx)(aY.Loader2,{className:"ml-2 h-4 w-4 animate-spin"})," حفظ"]})})]})]})}),(0,e.jsx)(k.AlertDialog,{open:J,onOpenChange:K,children:(0,e.jsxs)(k.AlertDialogContent,{children:[(0,e.jsxs)(k.AlertDialogHeader,{children:[(0,e.jsx)(k.AlertDialogTitle,{children:"هل أنت متأكد؟"}),(0,e.jsx)(k.AlertDialogDescription,{children:"سيتم حذف سجل هذه العهدة نهائياً. لا يمكن التراجع عن هذا الإجراء."})]}),(0,e.jsxs)(k.AlertDialogFooter,{children:[(0,e.jsx)(k.AlertDialogCancel,{children:"إلغاء"}),(0,e.jsx)(k.AlertDialogAction,{onClick:ai,className:"bg-red-600",children:"حذف"})]})]})})]})}a.s(["default",()=>a2],98897)}];

//# sourceMappingURL=Desktop_cmd-main_src_app_dashboard_admin_pm-advances_page_tsx_387e6d97._.js.map