module.exports=[72760,a=>{"use strict";let b=(0,a.i(90306).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],72760)},66128,a=>{"use strict";var b=a.i(43713),c=a.i(38550),d=a.i(41662);let e=(0,c.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,d.cn)(e({variant:c}),a),...f})}function g({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-description",className:(0,d.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...c})}a.s(["Alert",()=>f,"AlertDescription",()=>g])},57684,a=>{"use strict";var b=a.i(43713),c=a.i(41662);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-4 rounded-[12px] border border-border p-4 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-4 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-4",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-4",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},96596,a=>{"use strict";var b=a.i(68599);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},84177,a=>{"use strict";var b=a.i(43713),c=a.i(41662);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"skeleton",className:(0,c.cn)("bg-accent animate-pulse rounded-md",a),...d})}a.s(["Skeleton",()=>d])},31572,a=>{"use strict";let b=(0,a.i(90306).default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["ShieldCheck",()=>b],31572)},82481,a=>{"use strict";var b=a.i(43713),c=a.i(68599),d=a.i(84642),e=a.i(17545),f=a.i(72760),g=a.i(31572),h=a.i(84194),i=a.i(57684),j=a.i(30737),k=a.i(78252),l=a.i(71949),m=a.i(45158),n=a.i(96596),o=a.i(92139),p=a.i(58080),q="Switch",[r,s]=(0,l.createContextScope)(q),[t,u]=r(q),v=c.forwardRef((a,d)=>{let{__scopeSwitch:e,name:f,checked:g,defaultChecked:h,required:i,disabled:l,value:n="on",onCheckedChange:o,form:r,...s}=a,[u,v]=c.useState(null),w=(0,k.useComposedRefs)(d,a=>v(a)),x=c.useRef(!1),A=!u||r||!!u.closest("form"),[B,C]=(0,m.useControllableState)({prop:g,defaultProp:h??!1,onChange:o,caller:q});return(0,b.jsxs)(t,{scope:e,checked:B,disabled:l,children:[(0,b.jsx)(p.Primitive.button,{type:"button",role:"switch","aria-checked":B,"aria-required":i,"data-state":z(B),"data-disabled":l?"":void 0,disabled:l,value:n,...s,ref:w,onClick:(0,j.composeEventHandlers)(a.onClick,a=>{C(a=>!a),A&&(x.current=a.isPropagationStopped(),x.current||a.stopPropagation())})}),A&&(0,b.jsx)(y,{control:u,bubbles:!x.current,name:f,value:n,checked:B,required:i,disabled:l,form:r,style:{transform:"translateX(-100%)"}})]})});v.displayName=q;var w="SwitchThumb",x=c.forwardRef((a,c)=>{let{__scopeSwitch:d,...e}=a,f=u(w,d);return(0,b.jsx)(p.Primitive.span,{"data-state":z(f.checked),"data-disabled":f.disabled?"":void 0,...e,ref:c})});x.displayName=w;var y=c.forwardRef(({__scopeSwitch:a,control:d,checked:e,bubbles:f=!0,...g},h)=>{let i=c.useRef(null),j=(0,k.useComposedRefs)(i,h),l=(0,n.usePrevious)(e),m=(0,o.useSize)(d);return c.useEffect(()=>{let a=i.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(l!==e&&b){let c=new Event("click",{bubbles:f});b.call(a,e),a.dispatchEvent(c)}},[l,e,f]),(0,b.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:e,...g,tabIndex:-1,ref:j,style:{...g.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function z(a){return a?"checked":"unchecked"}y.displayName="SwitchBubbleInput";var A=a.i(41662);function B({className:a,...c}){return(0,b.jsx)(v,{"data-slot":"switch",className:(0,A.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...c,children:(0,b.jsx)(x,{"data-slot":"switch-thumb",className:(0,A.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var C=a.i(66128),D=a.i(84177);function E(){let{data:a,status:j}=(0,d.useSession)(),k=(0,e.useRouter)(),{toast:l}=(0,h.useToast)(),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(null),u=a?.user?.role==="ADMIN";(0,c.useEffect)(()=>{if("loading"!==j){if(!a||!u)return void k.replace("/dashboard");v()}},[a,j,u,k]);let v=async()=>{try{p(!0),t(null);let a=await fetch("/api/users?role=PROJECT_MANAGER");if(!a.ok)throw Error("Failed to fetch project managers");let b=await a.json();n(Array.isArray(b)?b:[])}catch(a){console.error("Error fetching project managers:",a),t("تعذر تحميل مديري المشاريع")}finally{p(!1)}},w=(0,c.useMemo)(()=>[...m].sort((a,b)=>a.name.localeCompare(b.name,"ar")),[m]),x=async(a,b)=>{n(c=>c.map(c=>c.id===a?{...c,canViewAllProjects:b}:c)),r(b=>[...b,a]);try{if(!(await fetch(`/api/users/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({canViewAllProjects:b})})).ok)throw Error("Failed to update permissions");l({title:"تم تحديث الصلاحية",description:b?"تم منح صلاحية عرض جميع المشاريع":"تم تقييد العرض بالمشاريع المسنودة فقط"})}catch(a){console.error("Error updating permissions:",a),n(m),l({title:"تعذر تحديث الصلاحية",description:"حاول مرة أخرى",variant:"destructive"})}finally{r(b=>b.filter(b=>b!==a))}};return(0,b.jsx)("div",{className:"flex-1 p-8 lg:p-12",children:(0,b.jsx)("div",{className:"max-w-5xl mx-auto space-y-6",children:(0,b.jsxs)(i.Card,{className:"border-[#E5E7EB]",children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(g.ShieldCheck,{className:"h-5 w-5 text-emerald-600"}),"صلاحيات مديري المشاريع"]}),(0,b.jsx)(i.CardDescription,{children:"تحكم في إمكانية مشاهدة جميع المشاريع لكل مدير مشروع."})]}),(0,b.jsxs)(i.CardContent,{children:[s&&(0,b.jsxs)(C.Alert,{variant:"destructive",className:"mb-4",children:[(0,b.jsx)(f.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(C.AlertDescription,{children:s})]}),o?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(D.Skeleton,{className:"h-12 w-full"}),(0,b.jsx)(D.Skeleton,{className:"h-12 w-full"}),(0,b.jsx)(D.Skeleton,{className:"h-12 w-full"})]}):(0,b.jsx)("div",{className:"divide-y divide-gray-100",children:0===w.length?(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"لا يوجد مديرو مشاريع حاليا."}):w.map(a=>(0,b.jsxs)("div",{className:"flex flex-col gap-3 py-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:a.email})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"عرض كل المشاريع"}),(0,b.jsx)(B,{checked:a.canViewAllProjects,disabled:q.includes(a.id),onCheckedChange:b=>x(a.id,b)})]})]},a.id))})]})]})})})}a.s(["default",()=>E],82481)}];

//# sourceMappingURL=Desktop_cmd-main_10933921._.js.map