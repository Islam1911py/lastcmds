(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4800,e=>{"use strict";let t,r,n;var a=e.i(2985),l=e.i(40059),s=e.i(19007),i=e.i(51581),o=e.i(29234),d=e.i(13949),c=e.i(62140),u=e.i(11316),m=e.i(46658),p=/[\\\/_+.#"@\[\(\{&]/,f=/[\\\/_+.#"@\[\(\{&]/g,h=/[\s-]/,x=/[\s-]/g;function v(e){return e.toLowerCase().replace(x," ")}var g=e.i(48282),j=e.i(33912),b=e.i(39198),y=e.i(23531),C='[cmdk-group=""]',w='[cmdk-group-items=""]',N='[cmdk-item=""]',E=`${N}:not([aria-disabled="true"])`,S="cmdk-item-select",k="data-value",A=(e,t,r)=>{var n;return n=e,function e(t,r,n,a,l,s,i){if(s===r.length)return l===t.length?1:.99;var o=`${l},${s}`;if(void 0!==i[o])return i[o];for(var d,c,u,m,v=a.charAt(s),g=n.indexOf(v,l),j=0;g>=0;)(d=e(t,r,n,a,g+1,s+1,i))>j&&(g===l?d*=1:p.test(t.charAt(g-1))?(d*=.8,(u=t.slice(l,g-1).match(f))&&l>0&&(d*=Math.pow(.999,u.length))):h.test(t.charAt(g-1))?(d*=.9,(m=t.slice(l,g-1).match(x))&&l>0&&(d*=Math.pow(.999,m.length))):(d*=.17,l>0&&(d*=Math.pow(.999,g-l))),t.charAt(g)!==r.charAt(s)&&(d*=.9999)),(d<.1&&n.charAt(g-1)===a.charAt(s+1)||a.charAt(s+1)===a.charAt(s)&&n.charAt(g-1)!==a.charAt(s))&&.1*(c=e(t,r,n,a,g+1,s+2,i))>d&&(d=.1*c),d>j&&(j=d),g=n.indexOf(v,g+1);return i[o]=j,j}(n=r&&r.length>0?`${n+" "+r.join(" ")}`:n,t,v(n),v(t),0,0,{})},I=l.createContext(void 0),R=l.createContext(void 0),P=l.createContext(void 0),D=l.forwardRef((e,t)=>{let r=U(()=>{var t,r;return{search:"",value:null!=(r=null!=(t=e.value)?t:e.defaultValue)?r:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=U(()=>new Set),a=U(()=>new Map),s=U(()=>new Map),i=U(()=>new Set),o=$(e),{label:d,children:c,value:u,onValueChange:m,filter:p,shouldFilter:f,loop:h,disablePointerSelection:x=!1,vimBindings:v=!0,...g}=e,y=(0,b.useId)(),P=(0,b.useId)(),D=(0,b.useId)(),O=l.useRef(null),F=K();B(()=>{if(void 0!==u){let e=u.trim();r.current.value=e,M.emit()}},[u]),B(()=>{F(6,z)},[]);let M=l.useMemo(()=>({subscribe:e=>(i.current.add(e),()=>i.current.delete(e)),snapshot:()=>r.current,setState:(e,t,n)=>{var a,l,s,i;if(!Object.is(r.current[e],t)){if(r.current[e]=t,"search"===e)V(),H(),F(1,L);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(D);e?e.focus():null==(a=document.getElementById(y))||a.focus()}if(F(7,()=>{var e;r.current.selectedItemId=null==(e=G())?void 0:e.id,M.emit()}),n||F(5,z),(null==(l=o.current)?void 0:l.value)!==void 0){null==(i=(s=o.current).onValueChange)||i.call(s,null!=t?t:"");return}}M.emit()}},emit:()=>{i.current.forEach(e=>e())}}),[]),T=l.useMemo(()=>({value:(e,t,n)=>{var a;t!==(null==(a=s.current.get(e))?void 0:a.value)&&(s.current.set(e,{value:t,keywords:n}),r.current.filtered.items.set(e,_(t,n)),F(2,()=>{H(),M.emit()}))},item:(e,t)=>(n.current.add(e),t&&(a.current.has(t)?a.current.get(t).add(e):a.current.set(t,new Set([e]))),F(3,()=>{V(),H(),r.current.value||L(),M.emit()}),()=>{s.current.delete(e),n.current.delete(e),r.current.filtered.items.delete(e);let t=G();F(4,()=>{V(),(null==t?void 0:t.getAttribute("id"))===e&&L(),M.emit()})}),group:e=>(a.current.has(e)||a.current.set(e,new Set),()=>{s.current.delete(e),a.current.delete(e)}),filter:()=>o.current.shouldFilter,label:d||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:y,inputId:D,labelId:P,listInnerRef:O}),[]);function _(e,t){var n,a;let l=null!=(a=null==(n=o.current)?void 0:n.filter)?a:A;return e?l(e,r.current.search,t):0}function H(){if(!r.current.search||!1===o.current.shouldFilter)return;let e=r.current.filtered.items,t=[];r.current.filtered.groups.forEach(r=>{let n=a.current.get(r),l=0;n.forEach(t=>{l=Math.max(e.get(t),l)}),t.push([r,l])});let n=O.current;J().sort((t,r)=>{var n,a;let l=t.getAttribute("id"),s=r.getAttribute("id");return(null!=(n=e.get(s))?n:0)-(null!=(a=e.get(l))?a:0)}).forEach(e=>{let t=e.closest(w);t?t.appendChild(e.parentElement===t?e:e.closest(`${w} > *`)):n.appendChild(e.parentElement===n?e:e.closest(`${w} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let r=null==(t=O.current)?void 0:t.querySelector(`${C}[${k}="${encodeURIComponent(e[0])}"]`);null==r||r.parentElement.appendChild(r)})}function L(){let e=J().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(k);M.setState("value",t||void 0)}function V(){var e,t,l,i;if(!r.current.search||!1===o.current.shouldFilter){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let d=0;for(let a of n.current){let n=_(null!=(t=null==(e=s.current.get(a))?void 0:e.value)?t:"",null!=(i=null==(l=s.current.get(a))?void 0:l.keywords)?i:[]);r.current.filtered.items.set(a,n),n>0&&d++}for(let[e,t]of a.current)for(let n of t)if(r.current.filtered.items.get(n)>0){r.current.filtered.groups.add(e);break}r.current.filtered.count=d}function z(){var e,t,r;let n=G();n&&((null==(e=n.parentElement)?void 0:e.firstChild)===n&&(null==(r=null==(t=n.closest(C))?void 0:t.querySelector('[cmdk-group-heading=""]'))||r.scrollIntoView({block:"nearest"})),n.scrollIntoView({block:"nearest"}))}function G(){var e;return null==(e=O.current)?void 0:e.querySelector(`${N}[aria-selected="true"]`)}function J(){var e;return Array.from((null==(e=O.current)?void 0:e.querySelectorAll(E))||[])}function Z(e){let t=J()[e];t&&M.setState("value",t.getAttribute(k))}function Q(e){var t;let r=G(),n=J(),a=n.findIndex(e=>e===r),l=n[a+e];null!=(t=o.current)&&t.loop&&(l=a+e<0?n[n.length-1]:a+e===n.length?n[0]:n[a+e]),l&&M.setState("value",l.getAttribute(k))}function X(e){let t=G(),r=null==t?void 0:t.closest(C),n;for(;r&&!n;)n=null==(r=e>0?function(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}(r,C):function(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}(r,C))?void 0:r.querySelector(E);n?M.setState("value",n.getAttribute(k)):Q(e)}let Y=()=>Z(J().length-1),ee=e=>{e.preventDefault(),e.metaKey?Y():e.altKey?X(1):Q(1)},et=e=>{e.preventDefault(),e.metaKey?Z(0):e.altKey?X(-1):Q(-1)};return l.createElement(j.Primitive.div,{ref:t,tabIndex:-1,...g,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=g.onKeyDown)||t.call(g,e);let r=e.nativeEvent.isComposing||229===e.keyCode;if(!(e.defaultPrevented||r))switch(e.key){case"n":case"j":v&&e.ctrlKey&&ee(e);break;case"ArrowDown":ee(e);break;case"p":case"k":v&&e.ctrlKey&&et(e);break;case"ArrowUp":et(e);break;case"Home":e.preventDefault(),Z(0);break;case"End":e.preventDefault(),Y();break;case"Enter":{e.preventDefault();let t=G();if(t){let e=new Event(S);t.dispatchEvent(e)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:T.inputId,id:T.labelId,style:W},d),q(e,e=>l.createElement(R.Provider,{value:M},l.createElement(I.Provider,{value:T},e))))}),O=l.forwardRef((e,t)=>{var r,n;let a=(0,b.useId)(),s=l.useRef(null),i=l.useContext(P),o=l.useContext(I),d=$(e),c=null!=(n=null==(r=d.current)?void 0:r.forceMount)?n:null==i?void 0:i.forceMount;B(()=>{if(!c)return o.item(a,null==i?void 0:i.id)},[c]);let u=z(a,s,[e.value,e.children,s],e.keywords),m=l.useContext(R),p=V(e=>e.value&&e.value===u.current),f=V(e=>!!c||!1===o.filter()||!e.search||e.filtered.items.get(a)>0);function h(){var e,t;x(),null==(t=(e=d.current).onSelect)||t.call(e,u.current)}function x(){m.setState("value",u.current,!0)}if(l.useEffect(()=>{let t=s.current;if(!(!t||e.disabled))return t.addEventListener(S,h),()=>t.removeEventListener(S,h)},[f,e.onSelect,e.disabled]),!f)return null;let{disabled:v,value:g,onSelect:C,forceMount:w,keywords:N,...E}=e;return l.createElement(j.Primitive.div,{ref:(0,y.composeRefs)(s,t),...E,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!p,"data-disabled":!!v,"data-selected":!!p,onPointerMove:v||o.getDisablePointerSelection()?void 0:x,onClick:v?void 0:h},e.children)}),F=l.forwardRef((e,t)=>{let{heading:r,children:n,forceMount:a,...s}=e,i=(0,b.useId)(),o=l.useRef(null),d=l.useRef(null),c=(0,b.useId)(),u=l.useContext(I),m=V(e=>!!a||!1===u.filter()||!e.search||e.filtered.groups.has(i));B(()=>u.group(i),[]),z(i,o,[e.value,e.heading,d]);let p=l.useMemo(()=>({id:i,forceMount:a}),[a]);return l.createElement(j.Primitive.div,{ref:(0,y.composeRefs)(o,t),...s,"cmdk-group":"",role:"presentation",hidden:!m||void 0},r&&l.createElement("div",{ref:d,"cmdk-group-heading":"","aria-hidden":!0,id:c},r),q(e,e=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?c:void 0},l.createElement(P.Provider,{value:p},e))))}),M=l.forwardRef((e,t)=>{let{alwaysRender:r,...n}=e,a=l.useRef(null),s=V(e=>!e.search);return r||s?l.createElement(j.Primitive.div,{ref:(0,y.composeRefs)(a,t),...n,"cmdk-separator":"",role:"separator"}):null}),T=l.forwardRef((e,t)=>{let{onValueChange:r,...n}=e,a=null!=e.value,s=l.useContext(R),i=V(e=>e.search),o=V(e=>e.selectedItemId),d=l.useContext(I);return l.useEffect(()=>{null!=e.value&&s.setState("search",e.value)},[e.value]),l.createElement(j.Primitive.input,{ref:t,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":o,id:d.inputId,type:"text",value:a?e.value:i,onChange:e=>{a||s.setState("search",e.target.value),null==r||r(e.target.value)}})}),_=l.forwardRef((e,t)=>{let{children:r,label:n="Suggestions",...a}=e,s=l.useRef(null),i=l.useRef(null),o=V(e=>e.selectedItemId),d=l.useContext(I);return l.useEffect(()=>{if(i.current&&s.current){let e=i.current,t=s.current,r,n=new ResizeObserver(()=>{r=requestAnimationFrame(()=>{let r=e.offsetHeight;t.style.setProperty("--cmdk-list-height",r.toFixed(1)+"px")})});return n.observe(e),()=>{cancelAnimationFrame(r),n.unobserve(e)}}},[]),l.createElement(j.Primitive.div,{ref:(0,y.composeRefs)(s,t),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":n,id:d.listId},q(e,e=>l.createElement("div",{ref:(0,y.composeRefs)(i,d.listInnerRef),"cmdk-list-sizer":""},e)))}),H=l.forwardRef((e,t)=>{let{open:r,onOpenChange:n,overlayClassName:a,contentClassName:s,container:i,...o}=e;return l.createElement(g.Root,{open:r,onOpenChange:n},l.createElement(g.Portal,{container:i},l.createElement(g.Overlay,{"cmdk-overlay":"",className:a}),l.createElement(g.Content,{"aria-label":e.label,"cmdk-dialog":"",className:s},l.createElement(D,{ref:t,...o}))))}),L=Object.assign(D,{List:_,Item:O,Input:T,Group:F,Separator:M,Dialog:H,Empty:l.forwardRef((e,t)=>V(e=>0===e.filtered.count)?l.createElement(j.Primitive.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Loading:l.forwardRef((e,t)=>{let{progress:r,children:n,label:a="Loading...",...s}=e;return l.createElement(j.Primitive.div,{ref:t,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},q(e,e=>l.createElement("div",{"aria-hidden":!0},e)))})});function $(e){let t=l.useRef(e);return B(()=>{t.current=e}),t}var B="u"<typeof window?l.useEffect:l.useLayoutEffect;function U(e){let t=l.useRef();return void 0===t.current&&(t.current=e()),t}function V(e){let t=l.useContext(R),r=()=>e(t.snapshot());return l.useSyncExternalStore(t.subscribe,r,r)}function z(e,t,r,n=[]){let a=l.useRef(),s=l.useContext(I);return B(()=>{var l;let i=(()=>{var e;for(let t of r){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():a.current}})(),o=n.map(e=>e.trim());s.value(e,i,o),null==(l=t.current)||l.setAttribute(k,i),a.current=i}),a}var K=()=>{let[e,t]=l.useState(),r=U(()=>new Map);return B(()=>{r.current.forEach(e=>e()),r.current=new Map},[e]),(e,n)=>{r.current.set(e,n),t({})}};function q({asChild:e,children:t},r){let n;return e&&l.isValidElement(t)?l.cloneElement("function"==typeof(n=t.type)?n(t.props):"render"in n?n.render(t.props):t,{ref:t.ref},r(t.props.children)):r(t)}var W={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},G=e.i(95003),G=G,J=e.i(26633);function Z({className:e,...t}){return(0,a.jsx)(L,{"data-slot":"command",className:(0,o.cn)("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function Q({className:e,...t}){return(0,a.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,a.jsx)(G.default,{className:"size-4 shrink-0 opacity-50"}),(0,a.jsx)(L.Input,{"data-slot":"command-input",className:(0,o.cn)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function X({className:e,...t}){return(0,a.jsx)(L.List,{"data-slot":"command-list",className:(0,o.cn)("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function Y({...e}){return(0,a.jsx)(L.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function ee({className:e,...t}){return(0,a.jsx)(L.Group,{"data-slot":"command-group",className:(0,o.cn)("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function et({className:e,...t}){return(0,a.jsx)(L.Item,{"data-slot":"command-item",className:(0,o.cn)("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}var er=e.i(78317),en=e.i(97546),ea=e.i(2678),el=e.i(87839),es=e.i(65553),ei=e.i(58324),eo=e.i(67418),ed=e.i(21504),ec=e.i(10817),eu=e.i(31397),em=e.i(55907),ep=Symbol("radix.slottable");function ef(e){return l.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===ep}var eh=e.i(88118),ex=e.i(96590),ev=e.i(19675),eg="Popover",[ej,eb]=(0,es.createContextScope)(eg,[ec.createPopperScope]),ey=(0,ec.createPopperScope)(),[eC,ew]=ej(eg),eN=e=>{let{__scopePopover:t,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:o=!1}=e,d=ey(t),c=l.useRef(null),[u,m]=l.useState(!1),[p,f]=(0,eh.useControllableState)({prop:n,defaultProp:s??!1,onChange:i,caller:eg});return(0,a.jsx)(ec.Root,{...d,children:(0,a.jsx)(eC,{scope:t,contentId:(0,b.useId)(),triggerRef:c,open:p,onOpenChange:f,onOpenToggle:l.useCallback(()=>f(e=>!e),[f]),hasCustomAnchor:u,onCustomAnchorAdd:l.useCallback(()=>m(!0),[]),onCustomAnchorRemove:l.useCallback(()=>m(!1),[]),modal:o,children:r})})};eN.displayName=eg;var eE="PopoverAnchor";l.forwardRef((e,t)=>{let{__scopePopover:r,...n}=e,s=ew(eE,r),i=ey(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:d}=s;return l.useEffect(()=>(o(),()=>d()),[o,d]),(0,a.jsx)(ec.Anchor,{...i,...n,ref:t})}).displayName=eE;var eS="PopoverTrigger",ek=l.forwardRef((e,t)=>{let{__scopePopover:r,...n}=e,l=ew(eS,r),s=ey(r),i=(0,y.useComposedRefs)(t,l.triggerRef),o=(0,a.jsx)(j.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":l.open,"aria-controls":l.contentId,"data-state":eL(l.open),...n,ref:i,onClick:(0,el.composeEventHandlers)(e.onClick,l.onOpenToggle)});return l.hasCustomAnchor?o:(0,a.jsx)(ec.Anchor,{asChild:!0,...s,children:o})});ek.displayName=eS;var eA="PopoverPortal",[eI,eR]=ej(eA,{forceMount:void 0}),eP=e=>{let{__scopePopover:t,forceMount:r,children:n,container:l}=e,s=ew(eA,t);return(0,a.jsx)(eI,{scope:t,forceMount:r,children:(0,a.jsx)(em.Presence,{present:r||s.open,children:(0,a.jsx)(eu.Portal,{asChild:!0,container:l,children:n})})})};eP.displayName=eA;var eD="PopoverContent",eO=l.forwardRef((e,t)=>{let r=eR(eD,e.__scopePopover),{forceMount:n=r.forceMount,...l}=e,s=ew(eD,e.__scopePopover);return(0,a.jsx)(em.Presence,{present:n||s.open,children:s.modal?(0,a.jsx)(eM,{...l,ref:t}):(0,a.jsx)(eT,{...l,ref:t})})});eO.displayName=eD;var eF=((n=l.forwardRef((e,t)=>{let{children:r,...n}=e;if(l.isValidElement(r)){var a;let e,s,i=(a=r,(s=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(s=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),o=function(e,t){let r={...t};for(let n in t){let a=e[n],l=t[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...e)=>{let t=l(...e);return a(...e),t}:a&&(r[n]=a):"style"===n?r[n]={...a,...l}:"className"===n&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==l.Fragment&&(o.ref=t?(0,y.composeRefs)(t,i):i),l.cloneElement(r,o)}return l.Children.count(r)>1?l.Children.only(null):null})).displayName="PopoverContent.RemoveScroll.SlotClone",t=n,(r=l.forwardRef((e,r)=>{let{children:n,...s}=e,i=l.Children.toArray(n),o=i.find(ef);if(o){let e=o.props.children,n=i.map(t=>t!==o?t:l.Children.count(e)>1?l.Children.only(null):l.isValidElement(e)?e.props.children:null);return(0,a.jsx)(t,{...s,ref:r,children:l.isValidElement(e)?l.cloneElement(e,void 0,n):null})}return(0,a.jsx)(t,{...s,ref:r,children:n})})).displayName="PopoverContent.RemoveScroll.Slot",r),eM=l.forwardRef((e,t)=>{let r=ew(eD,e.__scopePopover),n=l.useRef(null),s=(0,y.useComposedRefs)(t,n),i=l.useRef(!1);return l.useEffect(()=>{let e=n.current;if(e)return(0,ex.hideOthers)(e)},[]),(0,a.jsx)(ev.RemoveScroll,{as:eF,allowPinchZoom:!0,children:(0,a.jsx)(e_,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,el.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),i.current||r.triggerRef.current?.focus()}),onPointerDownOutside:(0,el.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;i.current=2===t.button||r},{checkForDefaultPrevented:!1}),onFocusOutside:(0,el.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),eT=l.forwardRef((e,t)=>{let r=ew(eD,e.__scopePopover),n=l.useRef(!1),s=l.useRef(!1);return(0,a.jsx)(e_,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(n.current||r.triggerRef.current?.focus(),t.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(n.current=!0,"pointerdown"===t.detail.originalEvent.type&&(s.current=!0));let a=t.target;r.triggerRef.current?.contains(a)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&s.current&&t.preventDefault()}})}),e_=l.forwardRef((e,t)=>{let{__scopePopover:r,trapFocus:n,onOpenAutoFocus:l,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:u,...m}=e,p=ew(eD,r),f=ey(r);return(0,eo.useFocusGuards)(),(0,a.jsx)(ed.FocusScope,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:l,onUnmountAutoFocus:s,children:(0,a.jsx)(ei.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:c,onDismiss:()=>p.onOpenChange(!1),children:(0,a.jsx)(ec.Content,{"data-state":eL(p.open),role:"dialog",id:p.contentId,...f,...m,ref:t,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),eH="PopoverClose";function eL(e){return e?"open":"closed"}function e$({...e}){return(0,a.jsx)(eN,{"data-slot":"popover",...e})}function eB({...e}){return(0,a.jsx)(ek,{"data-slot":"popover-trigger",...e})}function eU({className:e,align:t="center",sideOffset:r=4,...n}){return(0,a.jsx)(eP,{children:(0,a.jsx)(eO,{"data-slot":"popover-content",align:t,sideOffset:r,className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...n})})}l.forwardRef((e,t)=>{let{__scopePopover:r,...n}=e,l=ew(eH,r);return(0,a.jsx)(j.Primitive.button,{type:"button",...n,ref:t,onClick:(0,el.composeEventHandlers)(e.onClick,()=>l.onOpenChange(!1))})}).displayName=eH,l.forwardRef((e,t)=>{let{__scopePopover:r,...n}=e,l=ey(r);return(0,a.jsx)(ec.Arrow,{...l,...n,ref:t})}).displayName="PopoverArrow";var eV=e.i(49807),ez=e.i(92825),eK=e.i(65990),eq=e.i(2251),eW=e.i(57336),eG=e.i(72188);let eJ=(0,eG.default)("chevrons-up-down",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);var eZ=e.i(4295);let eQ=(0,eG.default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var eX=e.i(4301),eY=e.i(26486),e0=e.i(50186);let e1="__NO_PROJECT__";function e2(){let{data:e}=(0,s.useSession)(),{toast:t}=(0,i.useToast)(),[r,n]=(0,l.useState)([]),[p,f]=(0,l.useState)(!0),[h,x]=(0,l.useState)(!1),[v,g]=(0,l.useState)(!1),[j,b]=(0,l.useState)({staffId:"",projectId:"",amount:""}),[y,C]=(0,l.useState)(!1),[w,N]=(0,l.useState)([]),[E,S]=(0,l.useState)([]),[k,A]=(0,l.useState)(!1),[I,R]=(0,l.useState)(null),[P,D]=(0,l.useState)({amount:"",projectId:""}),[O,F]=(0,l.useState)(!1),[M,T]=(0,l.useState)(!1),[_,H]=(0,l.useState)(null),[L,$]=(0,l.useState)(!1),[B,U]=(0,l.useState)(null),V=e?.user?.role==="ADMIN"||e?.user?.role==="ACCOUNTANT",z=(0,l.useCallback)(async()=>{try{let e=await fetch("/api/pm-advances");if(!e.ok)throw Error("Failed to fetch");let t=await e.json();n(Array.isArray(t)?t:[])}catch(e){t({title:"خطأ",description:"تعذر تحديث قائمة العهد.",variant:"destructive"})}},[t]);(0,l.useEffect)(()=>{(async()=>{f(!0);try{await Promise.all([z(),fetch("/api/projects").then(e=>e.json()).then(e=>N(e)),fetch("/api/staff").then(e=>e.json()).then(e=>S(e))])}catch(e){console.error(e)}finally{f(!1)}})()},[z]);let{totalAllocated:K,totalSpent:q,totalRemaining:W,highUsageCount:G}=(0,l.useMemo)(()=>r.reduce((e,t)=>(e.totalAllocated+=t.amount,e.totalSpent+=t.totalSpent,e.totalRemaining+=t.remainingAmount,t.percentageUsed>=80&&e.highUsageCount++,e),{totalAllocated:0,totalSpent:0,totalRemaining:0,highUsageCount:0}),[r]),el=(0,l.useMemo)(()=>{let e=new Map;return r.forEach(t=>{let r=e.get(t.staff.id);r?(r.totalAmount+=t.amount,r.totalSpent+=t.totalSpent,r.totalRemaining+=t.remainingAmount,r.advances.push(t),r.percentageUsed=r.totalSpent/r.totalAmount*100):e.set(t.staff.id,{staffId:t.staff.id,staffName:t.staff.name,totalAmount:t.amount,totalSpent:t.totalSpent,totalRemaining:t.remainingAmount,percentageUsed:t.percentageUsed,advances:[t]})}),Array.from(e.values())},[r]),es=async e=>{e.preventDefault(),g(!0);try{if(!(await fetch("/api/pm-advances",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)})).ok)throw Error();t({title:"تمت الإضافة",description:"تم تخصيص العهدة بنجاح."}),x(!1),b({staffId:"",projectId:"",amount:""}),z()}catch(e){t({title:"خطأ",description:"فشل في إضافة العهدة.",variant:"destructive"})}finally{g(!1)}},ei=async e=>{if(e.preventDefault(),I){F(!0);try{if(!(await fetch(`/api/pm-advances/${I.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)})).ok)throw Error();A(!1),z(),t({title:"تم التحديث",description:"تم تعديل بيانات العهدة."})}catch(e){t({title:"خطأ",description:"فشل في التحديث.",variant:"destructive"})}finally{F(!1)}}},eo=async()=>{if(_){$(!0);try{if(!(await fetch(`/api/pm-advances/${_.id}`,{method:"DELETE"})).ok)throw Error();T(!1),z(),t({title:"تم الحذف",description:"تم حذف العهدة نهائياً."})}catch(e){t({title:"خطأ",description:"تعذر حذف العهدة.",variant:"destructive"})}finally{$(!1)}}};return p?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(e=>(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(m.CardHeader,{children:(0,a.jsx)(eK.Skeleton,{className:"h-4 w-24"})}),(0,a.jsx)(m.CardContent,{children:(0,a.jsx)(eK.Skeleton,{className:"h-8 w-32"})})]},e))}),(0,a.jsx)(eK.Skeleton,{className:"h-[400px] w-full"})]}):(0,a.jsxs)("div",{className:"space-y-6",dir:"rtl",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"عهد الموظفين"}),(0,a.jsx)("p",{className:"mt-2 text-muted-foreground",children:"تتبع العهد المخصصة لكل موظف ومراقبة الصرفيات والمتبقي لحظياً."})]}),V&&(0,a.jsxs)(J.Dialog,{open:h,onOpenChange:x,children:[(0,a.jsx)(J.DialogTrigger,{asChild:!0,children:(0,a.jsxs)(u.Button,{className:"gap-2",children:[(0,a.jsx)(eY.Plus,{className:"h-4 w-4"})," إضافة عهدة جديدة"]})}),(0,a.jsxs)(J.DialogContent,{className:"max-w-md",children:[(0,a.jsxs)(J.DialogHeader,{children:[(0,a.jsx)(J.DialogTitle,{children:"إضافة عهدة جديدة"}),(0,a.jsx)(J.DialogDescription,{children:"خصص عهدة مالية لأي موظف مع إمكانية ربطها بمشروع محدد."})]}),(0,a.jsxs)("form",{onSubmit:es,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ea.Label,{children:"الموظف *"}),(0,a.jsxs)(e$,{open:y,onOpenChange:C,children:[(0,a.jsx)(eB,{asChild:!0,children:(0,a.jsxs)(u.Button,{variant:"outline",className:"w-full justify-between",children:[j.staffId?E.find(e=>e.id===j.staffId)?.name:"اختر الموظف",(0,a.jsx)(eJ,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,a.jsx)(eU,{className:"p-0",children:(0,a.jsxs)(Z,{children:[(0,a.jsx)(Q,{placeholder:"ابحث عن الموظف..."}),(0,a.jsxs)(X,{children:[(0,a.jsx)(Y,{children:"لا يوجد موظفون"}),(0,a.jsx)(ee,{children:E.map(e=>(0,a.jsxs)(et,{onSelect:()=>{b({...j,staffId:e.id}),C(!1)},children:[(0,a.jsx)(eW.Check,{className:(0,o.cn)("ml-2 h-4 w-4",e.id===j.staffId?"opacity-100":"opacity-0")}),e.name]},e.id))})]})]})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ea.Label,{children:"المبلغ (جنيه) *"}),(0,a.jsx)(en.Input,{type:"number",step:"0.01",value:j.amount,onChange:e=>b({...j,amount:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ea.Label,{children:"المشروع (اختياري)"}),(0,a.jsxs)(ez.Select,{value:j.projectId||e1,onValueChange:e=>b({...j,projectId:e===e1?"":e}),children:[(0,a.jsx)(ez.SelectTrigger,{children:(0,a.jsx)(ez.SelectValue,{placeholder:"اختر المشروع"})}),(0,a.jsxs)(ez.SelectContent,{children:[(0,a.jsx)(ez.SelectItem,{value:e1,children:"بدون مشروع"}),w.map(e=>(0,a.jsx)(ez.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsx)(J.DialogFooter,{children:(0,a.jsxs)(u.Button,{type:"submit",disabled:v,children:[v&&(0,a.jsx)(eZ.Loader2,{className:"ml-2 h-4 w-4 animate-spin"})," إضافة العهدة"]})})]})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(m.CardHeader,{className:"pb-2",children:(0,a.jsx)(m.CardTitle,{className:"text-sm font-medium",children:"إجمالي العهد"})}),(0,a.jsxs)(m.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[K.toFixed(2)," جنيه"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[el.length," موظفاً لديهم عهد"]})]})]}),(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(m.CardHeader,{className:"pb-2",children:(0,a.jsx)(m.CardTitle,{className:"text-sm font-medium",children:"المصروف"})}),(0,a.jsxs)(m.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[q.toFixed(2)," جنيه"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"الصرف التشغيلي والوحدات معاً"})]})]}),(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(m.CardHeader,{className:"pb-2",children:(0,a.jsx)(m.CardTitle,{className:"text-sm font-medium",children:"المتبقي"})}),(0,a.jsx)(m.CardContent,{children:(0,a.jsxs)("div",{className:(0,o.cn)("text-2xl font-bold",W<0?"text-red-600":"text-green-600"),children:[W.toFixed(2)," جنيه"]})})]}),(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(m.CardHeader,{className:"pb-2",children:(0,a.jsx)(m.CardTitle,{className:"text-sm font-medium text-red-600",children:"تنبيهات الاستهلاك"})}),(0,a.jsx)(m.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:G})})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===el.length?(0,a.jsxs)(d.Alert,{children:[(0,a.jsx)(eq.AlertCircle,{className:"h-4 w-4"}),(0,a.jsx)(d.AlertDescription,{children:"لا توجد عهد مسجلة"})]}):el.map(e=>(0,a.jsxs)(m.Card,{children:[(0,a.jsxs)(m.CardHeader,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>U(B===e.staffId?null:e.staffId),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(m.CardTitle,{children:e.staffName}),(0,a.jsxs)(m.CardDescription,{children:[e.advances.length," عهدة قائمة"]})]}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsxs)("div",{className:"font-bold text-lg",children:[e.totalAmount.toFixed(2)," ج.م"]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"الإجمالي"})]})]}),(0,a.jsx)(eV.Progress,{value:e.percentageUsed,className:"mt-4 h-2"})]}),B===e.staffId&&(0,a.jsx)(m.CardContent,{className:"pt-4 border-t space-y-4",children:e.advances.map(e=>(0,a.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/20",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:e.project?.name||"بدون مشروع"}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["بتاريخ: ",new Date(e.createdAt).toLocaleDateString("ar-EG")]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-bold",children:e.amount.toFixed(2)}),(0,a.jsxs)("div",{className:"text-xs font-semibold text-muted-foreground",children:["متبقي: ",e.remainingAmount.toFixed(2)]})]}),(0,a.jsxs)(er.DropdownMenu,{children:[(0,a.jsx)(er.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(u.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(eQ,{className:"h-4 w-4"})})}),(0,a.jsxs)(er.DropdownMenuContent,{children:[(0,a.jsxs)(er.DropdownMenuItem,{onClick:()=>{R(e),D({amount:e.amount.toString(),projectId:e.project?.id||""}),A(!0)},children:[(0,a.jsx)(eX.Pencil,{className:"ml-2 h-4 w-4"})," تعديل"]}),(0,a.jsxs)(er.DropdownMenuItem,{className:"text-red-600",onClick:()=>{H(e),T(!0)},children:[(0,a.jsx)(e0.Trash2,{className:"ml-2 h-4 w-4"})," حذف"]})]})]})]})]}),(0,a.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 text-[11px] text-muted-foreground",children:[(0,a.jsxs)("span",{className:"rounded-full bg-blue-50 px-3 py-1 text-blue-700",children:["إجمالي المصروف: ",(e.totalSpent??0).toFixed(2)," ج.م"]}),(0,a.jsxs)("span",{className:"rounded-full bg-emerald-50 px-3 py-1 text-emerald-700",children:["تشغيلي: ",(e.spendingBreakdown?.operationalExpenses??0).toFixed(2)]}),(0,a.jsxs)("span",{className:"rounded-full bg-sky-50 px-3 py-1 text-sky-700",children:["مصروفات وحدات: ",(e.spendingBreakdown?.unitExpenses??0).toFixed(2)]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-xs font-semibold text-muted-foreground",children:"مصروفات تشغيلية مسجلة"}),e.operationalExpenses&&e.operationalExpenses.length>0?(0,a.jsxs)("ul",{className:"space-y-1 text-xs",children:[e.operationalExpenses.slice(0,4).map(e=>(0,a.jsxs)("li",{className:"flex items-center justify-between rounded bg-background/60 px-3 py-2",children:[(0,a.jsxs)("div",{className:"flex-1 pr-3",children:[(0,a.jsx)("p",{className:"truncate font-medium text-sm",children:e.description||"مصروف بدون وصف"}),(e.unit?.project||e.unit)&&(0,a.jsxs)("p",{className:"mt-1 text-[10px] text-muted-foreground",children:[e.unit?.project?e.unit.project.name:"",e.unit?.project&&e.unit?.name?" • ":"",e.unit?.name?`وحدة ${e.unit.name}`:""]})]}),(0,a.jsx)("span",{className:"font-semibold text-xs",children:e.amount.toFixed(2)})]},e.id)),e.operationalExpenses.length>4&&(0,a.jsxs)("li",{className:"text-[11px] text-muted-foreground",children:["+ ",e.operationalExpenses.length-4," عناصر إضافية"]})]}):(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"لا توجد مصروفات تشغيلية مسجلة بعد"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-xs font-semibold text-muted-foreground",children:"مصروفات وحدات"}),e.expenses&&e.expenses.length>0?(0,a.jsxs)("ul",{className:"space-y-1 text-xs",children:[e.expenses.slice(0,4).map(e=>(0,a.jsxs)("li",{className:"flex items-center justify-between rounded bg-background/60 px-3 py-2",children:[(0,a.jsxs)("div",{className:"flex-1 pr-3",children:[(0,a.jsx)("p",{className:"truncate font-medium text-sm",children:e.description||"مصروف بدون وصف"}),(e.unit?.project||e.unit)&&(0,a.jsxs)("p",{className:"mt-1 text-[10px] text-muted-foreground",children:[e.unit?.project?e.unit.project.name:"",e.unit?.project&&e.unit?.name?" • ":"",e.unit?.name?`وحدة ${e.unit.name}`:""]})]}),(0,a.jsx)("span",{className:"font-semibold text-xs",children:e.amount.toFixed(2)})]},e.id)),e.expenses.length>4&&(0,a.jsxs)("li",{className:"text-[11px] text-muted-foreground",children:["+ ",e.expenses.length-4," عناصر إضافية"]})]}):(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"لم تُسجل مصروفات وحدات بعد"})]})]})]})]},e.id))})]},e.staffId))}),(0,a.jsx)(J.Dialog,{open:k,onOpenChange:A,children:(0,a.jsxs)(J.DialogContent,{children:[(0,a.jsx)(J.DialogHeader,{children:(0,a.jsx)(J.DialogTitle,{children:"تعديل العهدة"})}),(0,a.jsxs)("form",{onSubmit:ei,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ea.Label,{children:"المبلغ المعدل"}),(0,a.jsx)(en.Input,{type:"number",step:"0.01",value:P.amount,onChange:e=>D({...P,amount:e.target.value})})]}),(0,a.jsx)(J.DialogFooter,{children:(0,a.jsxs)(u.Button,{type:"submit",disabled:O,children:[O&&(0,a.jsx)(eZ.Loader2,{className:"ml-2 h-4 w-4 animate-spin"})," حفظ"]})})]})]})}),(0,a.jsx)(c.AlertDialog,{open:M,onOpenChange:T,children:(0,a.jsxs)(c.AlertDialogContent,{children:[(0,a.jsxs)(c.AlertDialogHeader,{children:[(0,a.jsx)(c.AlertDialogTitle,{children:"هل أنت متأكد؟"}),(0,a.jsx)(c.AlertDialogDescription,{children:"سيتم حذف سجل هذه العهدة نهائياً. لا يمكن التراجع عن هذا الإجراء."})]}),(0,a.jsxs)(c.AlertDialogFooter,{children:[(0,a.jsx)(c.AlertDialogCancel,{children:"إلغاء"}),(0,a.jsx)(c.AlertDialogAction,{onClick:eo,className:"bg-red-600",children:"حذف"})]})]})})]})}e.s(["default",()=>e2],4800)}]);