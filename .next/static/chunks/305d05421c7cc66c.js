(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,97546,e=>{"use strict";var t=e.i(2985),a=e.i(29234);function i({className:e,type:i,...r}){return(0,t.jsx)("input",{type:i,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}e.s(["Input",()=>i])},2678,e=>{"use strict";var t=e.i(2985),a=e.i(40059);e.i(98969);var i=e.i(99442),r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let s=(0,i.createSlot)(`Primitive.${r}`),l=a.forwardRef((e,a)=>{let{asChild:i,...l}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(i?s:r,{...l,ref:a})});return l.displayName=`Primitive.${r}`,{...e,[r]:l}},{}),s=a.forwardRef((e,a)=>(0,t.jsx)(r.label,{...e,ref:a,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));s.displayName="Label";var l=e.i(29234);function n({className:e,...a}){return(0,t.jsx)(s,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...a})}e.s(["Label",()=>n],2678)},2251,e=>{"use strict";let t=(0,e.i(72188).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],2251)},13949,e=>{"use strict";var t=e.i(2985),a=e.i(63886),i=e.i(29234);let r=(0,a.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function s({className:e,variant:a,...s}){return(0,t.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,i.cn)(r({variant:a}),e),...s})}function l({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"alert-description",className:(0,i.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...a})}e.s(["Alert",()=>s,"AlertDescription",()=>l])},73258,e=>{"use strict";let t=(0,e.i(72188).default)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);e.s(["Loader",()=>t],73258)},52936,e=>{"use strict";var t=e.i(2985),a=e.i(29234);function i({className:e,...i}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,a.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...i})}e.s(["Textarea",()=>i])},17878,e=>{"use strict";let t=(0,e.i(72188).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],17878)},16813,e=>{"use strict";var t=e.i(2985),a=e.i(40059),i=e.i(88020),r=e.i(19007),s=e.i(2251),l=e.i(73258),n=e.i(17878),d=e.i(13949),c=e.i(11316),o=e.i(46658),u=e.i(97546),h=e.i(2678),m=e.i(52936),x=e.i(92825);function p(){let{data:e}=(0,r.useSession)(),p=(0,i.useRouter)(),f=(0,i.useSearchParams)().get("unitId"),[g,b]=(0,a.useState)([]),[v,j]=(0,a.useState)(!0),[y,w]=(0,a.useState)(null),[N,z]=(0,a.useState)(!1),[S,k]=(0,a.useState)(null),[C,I]=(0,a.useState)(!1),[E,L]=(0,a.useState)({name:"",email:"",phone:"",address:"",unitId:f||""}),[F,A]=(0,a.useState)("");(0,a.useEffect)(()=>{e&&P()},[e]),(0,a.useEffect)(()=>{f&&(async()=>{try{I(!0);let e=await fetch(`/api/operational-units/${f}`);if(!e.ok)throw Error("Failed to fetch unit");let t=await e.json();k(t),A(t.project?.id||""),L(e=>({...e,unitId:t.id}))}catch(e){console.error("Error fetching unit:",e),k(null)}finally{I(!1)}})()},[f]),(0,a.useEffect)(()=>{if(!f||0===g.length)return;let e=g.find(e=>e.operationalUnits.some(e=>e.id===f));e&&(A(e.id),L(e=>({...e,unitId:f})))},[f,g]),(0,a.useEffect)(()=>{if(!F)return;let e=g.find(e=>e.id===F);!e?.operationalUnits.some(e=>e.id===E.unitId)&&E.unitId&&L(e=>({...e,unitId:""}))},[F,g,E.unitId]);let P=async()=>{try{j(!0),w(null);let e=await fetch("/api/projects");if(!e.ok)throw Error("Failed to fetch projects");let t=await e.json();b(t)}catch(e){console.error("Error:",e),w("Failed to load projects")}finally{j(!1)}},T=async e=>{if(e.preventDefault(),!E.name.trim()||!E.unitId)return void alert("Please fill in all required fields");try{z(!0);let e=await fetch("/api/residents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:E.name,email:E.email,phone:E.phone,address:E.address,unitId:E.unitId})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to create resident")}p.push("/dashboard/residents")}catch(e){console.error("Error:",e),alert(e instanceof Error?e.message:"Failed to create resident")}finally{z(!1)}},R=S?[{id:S.id,name:S.name,code:S.code}]:F&&g.find(e=>e.id===F)?.operationalUnits||[];return v?(0,t.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,t.jsx)(l.Loader,{className:"h-8 w-8 text-emerald-500 animate-spin"})}):(0,t.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(c.Button,{variant:"ghost",onClick:()=>p.back(),className:"gap-2 text-zinc-300 hover:text-white hover:bg-zinc-800",children:[(0,t.jsx)(n.ChevronLeft,{className:"h-4 w-4"}),"Back"]}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Add New Resident"})]}),y&&(0,t.jsxs)(d.Alert,{variant:"destructive",children:[(0,t.jsx)(s.AlertCircle,{className:"h-4 w-4"}),(0,t.jsx)(d.AlertDescription,{children:y})]}),(0,t.jsx)(o.Card,{className:"bg-zinc-900 border-zinc-800",children:(0,t.jsx)(o.CardContent,{className:"pt-6",children:(0,t.jsxs)("form",{onSubmit:T,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.Label,{htmlFor:"name",className:"text-white",children:"Full Name *"}),(0,t.jsx)(u.Input,{id:"name",placeholder:"Enter resident name",value:E.name,onChange:e=>L({...E,name:e.target.value}),className:"bg-zinc-800 border-zinc-700 text-white placeholder:text-zinc-500"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.Label,{htmlFor:"email",className:"text-white",children:"Email Address"}),(0,t.jsx)(u.Input,{id:"email",type:"email",placeholder:"Enter email address",value:E.email,onChange:e=>L({...E,email:e.target.value}),className:"bg-zinc-800 border-zinc-700 text-white placeholder:text-zinc-500"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.Label,{htmlFor:"phone",className:"text-white",children:"Phone Number"}),(0,t.jsx)(u.Input,{id:"phone",placeholder:"Enter phone number",value:E.phone,onChange:e=>L({...E,phone:e.target.value}),className:"bg-zinc-800 border-zinc-700 text-white placeholder:text-zinc-500"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.Label,{htmlFor:"address",className:"text-white",children:"Address"}),(0,t.jsx)(m.Textarea,{id:"address",placeholder:"Enter address",value:E.address,onChange:e=>L({...E,address:e.target.value}),className:"bg-zinc-800 border-zinc-700 text-white placeholder:text-zinc-500"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.Label,{htmlFor:"project",className:"text-white",children:"Project *"}),(0,t.jsxs)(x.Select,{value:F,onValueChange:A,children:[(0,t.jsx)(x.SelectTrigger,{className:"bg-zinc-800 border-zinc-700 text-white",disabled:!!f,children:(0,t.jsx)(x.SelectValue,{placeholder:C?"Loading...":"Select a project"})}),(0,t.jsx)(x.SelectContent,{className:"bg-zinc-800 border-zinc-700",children:g.map(e=>(0,t.jsx)(x.SelectItem,{value:e.id,className:"text-white",children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.Label,{htmlFor:"unit",className:"text-white",children:"Operational Unit *"}),(0,t.jsxs)(x.Select,{value:E.unitId,onValueChange:e=>L({...E,unitId:e}),children:[(0,t.jsx)(x.SelectTrigger,{className:"bg-zinc-800 border-zinc-700 text-white",disabled:!!f,children:(0,t.jsx)(x.SelectValue,{placeholder:C?"Loading...":"Select a unit"})}),(0,t.jsx)(x.SelectContent,{className:"bg-zinc-800 border-zinc-700",children:R.map(e=>(0,t.jsxs)(x.SelectItem,{value:e.id,className:"text-white",children:[e.code," - ",e.name]},e.id))})]})]}),(0,t.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,t.jsx)(c.Button,{type:"submit",disabled:N,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:N?"Creating...":"Create Resident"}),(0,t.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>p.back(),className:"border-zinc-700 text-zinc-300 hover:bg-zinc-800",children:"Cancel"})]})]})})})]})}e.s(["default",()=>p])}]);