# ุงููุญุงุณุจ ุนูู ูุงุชุณุงุจ - ุฏููู ุงูุนูููุงุช ุงููุงูู

> **ุงูุบุฑุถ:** ุชูุซูู ุดุงูู ูุฌููุน ุงูุนูููุงุช ุงูุชู ูููู ูููุญุงุณุจ ุชูููุฐูุง ุนุจุฑ ูุงุชุณุงุจ ูุน ุฃูุซูุฉ ุนูููุฉ ูุดุฑุญ ุงูู Payload

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [ุฅุฏุงุฑุฉ ุงูุณููุงุช ุงูููุฏุณูุฉ](#ุฅุฏุงุฑุฉ-ุงูุณููุงุช-ุงูููุฏุณูุฉ)
2. [ุฅุฏุงุฑุฉ ุณููุงุช ุงูููุธููู](#ุฅุฏุงุฑุฉ-ุณููุงุช-ุงูููุธููู)
3. [ุชุณุฌูู ูุฐูุฑุงุช ุงููุญุงุณุจุฉ](#ุชุณุฌูู-ูุฐูุฑุงุช-ุงููุญุงุณุจุฉ)
4. [ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ](#ุฅุฏุงุฑุฉ-ุงูููุงุชูุฑ)
5. [ุฅุฏุงุฑุฉ ุงูุฑูุงุชุจ](#ุฅุฏุงุฑุฉ-ุงูุฑูุงุชุจ)
6. [ุงูุจุญุซ ูุงูุงุณุชุนูุงูุงุช](#ุงูุจุญุซ-ูุงูุงุณุชุนูุงูุงุช)
7. [ุงุณุชุฎุฏุงู DSL Filter](#ุงุณุชุฎุฏุงู-dsl-filter)

8. [Prompt ููู Agent](#prompt-ููู-agent)

---

## 1. ุฅุฏุงุฑุฉ ุงูุณููุงุช ุงูููุฏุณูุฉ

### CREATE_PM_ADVANCE - ุฅูุดุงุก ุณููุฉ ูููุฏุณ

**ุงููุตู:** ุฅุนุทุงุก ุณููุฉ ููุฏูุฉ ููููุฏุณ ูู ุฃุฌู ูุดุฑูุน ูุนูู

**ุงููุชุทูุจุงุช:**
- `amount` (ุฅุฌุจุงุฑู) - ุงููุจูุบ ุงููุฑุงุฏ ุฅุนุทุงุคู
- `staffQuery` ุฃู `staffId` (ูุงุญุฏ ููููุง) - ุงุณู ุฃู ID ุงููููุฏุณ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` - ูุนุฑู ุงููุดุฑูุน
- `notes` - ููุงุญุธุงุช ุฅุถุงููุฉ

**Request Payload:**
```json
{
  "action": "CREATE_PM_ADVANCE",
  "senderPhone": "+201001234567",
  "payload": {
    "staffQuery": "ูุญูุฏ ุนูู",
    "amount": 5000,
    "projectId": "green-project-id",
    "notes": "ุณููุฉ ูุดุฑุงุก ููุงุฏ ุงูุจูุงุก"
  }
}
```

**Response ุงููุงุฌุญ:**
```json
{
  "success": true,
  "data": {
    "advanceId": "adv-12345",
    "staffName": "ูุญูุฏ ุนูู",
    "amount": 5000,
    "projectName": "ุงููุดุฑูุน ุงูุฃุฎุถุฑ",
    "status": "PENDING",
    "createdAt": "2026-02-19T10:30:00Z"
  },
  "humanReadable": {
    "ar": "ุชู ุฅุนุทุงุก ุณููุฉ ุจูููุฉ 5000 ุฌููู ููุญูุฏ ุนูู"
  }
}
```

---

## 2. ุฅุฏุงุฑุฉ ุณููุงุช ุงูููุธููู

### CREATE_STAFF_ADVANCE - ุฅูุดุงุก ุณููุฉ ููุธู

**ุงููุตู:** ุฅุนุทุงุก ุณููุฉ ูููุธู ุนุงู ุฃู ุฅุฏุงุฑู

**ุงููุชุทูุจุงุช:**
- `amount` (ุฅุฌุจุงุฑู) - ุงููุจูุบ
- `staffQuery` ุฃู `staffId` - ุงุณู ุฃู ID ุงูููุธู

**ุงูุงุฎุชูุงุฑูุฉ:**
- `note` - ููุงุญุธุฉ

**Request Payload:**
```json
{
  "action": "CREATE_STAFF_ADVANCE",
  "payload": {
    "staffQuery": "ูุงุทูุฉ ูุญููุฏ",
    "amount": 2000,
    "note": "ุณููุฉ ุงูุฑุงุชุจ ุงูุดูุฑู"
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "advanceId": "adv-67890",
    "staffName": "ูุงุทูุฉ ูุญููุฏ",
    "amount": 2000,
    "status": "PENDING"
  },
  "humanReadable": {
    "ar": "ุชู ุชุณุฌูู ุณููุฉ 2000 ุฌููู ููููุธู ูุงุทูุฉ ูุญููุฏ"
  }
}
```

---

### UPDATE_STAFF_ADVANCE - ุชุนุฏูู ุงูุณููุฉ

**ุงููุตู:** ุชุนุฏูู ูุจูุบ ุฃู ุชูุงุตูู ุณููุฉ ููุฌูุฏุฉ

**ุงููุชุทูุจุงุช:**
- `advanceId` (ุฅุฌุจุงุฑู) - ูุนุฑู ุงูุณููุฉ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `amount` - ุงููุจูุบ ุงูุฌุฏูุฏ
- `note` - ููุงุญุธุฉ ุฌุฏูุฏุฉ

**Request Payload:**
```json
{
  "action": "UPDATE_STAFF_ADVANCE",
  "payload": {
    "advanceId": "adv-67890",
    "amount": 2500
  }
}
```

---

### DELETE_STAFF_ADVANCE - ุญุฐู ุงูุณููุฉ

**ุงููุตู:** ุญุฐู ุณููุฉ ูู ูุชู ุงุณุชุฎุฏุงููุง ุจุนุฏ

**ุงููุชุทูุจุงุช:**
- `advanceId` - ูุนุฑู ุงูุณููุฉ

**Request Payload:**
```json
{
  "action": "DELETE_STAFF_ADVANCE",
  "payload": {
    "advanceId": "adv-67890"
  }
}
```

---

## 3. ุชุณุฌูู ูุฐูุฑุงุช ุงููุญุงุณุจุฉ

### RECORD_ACCOUNTING_NOTE - ุชุญููู ูุฐูุฑุฉ ููุงุชูุฑุฉ

**ุงููุตู:** ุชุญููู ูุฐูุฑุฉ ูุญุงุณุจุฉ (ูุตุฑููุงุช ูุณุฌูุฉ) ุฅูู ูุงุชูุฑุฉ ุฑุณููุฉ

**ุงููุชุทูุจุงุช:**
- `noteId` - ูุนุฑู ุงููุฐูุฑุฉ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `sourceType` - ูุตุฏุฑ ุงูุชูููู: `"OFFICE_FUND"` ุฃู `"PM_ADVANCE"`
- `pmAdvanceId` - ูุนุฑู ุงูุณููุฉ (ุฅุฐุง ูุงู sourceType = PM_ADVANCE)

**Request Payload:**
```json
{
  "action": "RECORD_ACCOUNTING_NOTE",
  "payload": {
    "noteId": "note-abc123",
    "sourceType": "OFFICE_FUND"
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "invoiceId": "inv-12345",
    "noteId": "note-abc123",
    "convertedAmount": 3500,
    "invoiceType": "CLAIM"
  },
  "humanReadable": {
    "ar": "ุชู ุชุญููู ุงููุฐูุฑุฉ ุฅูู ูุงุชูุฑุฉ ุจูููุฉ 3500 ุฌููู"
  }
}
```

---

## 4. ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ

### PAY_INVOICE - ุฏูุน ุงููุงุชูุฑุฉ

**ุงููุตู:** ุฏูุน ูุงุชูุฑุฉ ุฃู ุฌุฒุก ูููุง

**ุงููุชุทูุจุงุช:**
- `invoiceId` - ูุนุฑู ุงููุงุชูุฑุฉ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `amount` - ุงููุจูุบ ุงููุฑุงุฏ ุฏูุนู (ุจุฏูู ุชุญุฏูุฏ = ุฏูุน ูุงูู)
- `action` - ููุน ุงูุฏูุน: `"pay"` (ุฏูุน ุชุฏุฑูุฌู) ุฃู `"mark-paid"` (ุชุณุฏูุฏ ูุงูู)

**Request Payload:**
```json
{
  "action": "PAY_INVOICE",
  "payload": {
    "invoiceId": "inv-12345",
    "amount": 5000,
    "action": "pay"
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "invoiceId": "inv-12345",
    "amountPaid": 5000,
    "remainingBalance": 0,
    "status": "PAID"
  },
  "humanReadable": {
    "ar": "ุชู ุฏูุน 5000 ุฌููู ูููุงุชูุฑุฉ ุฑูู inv-12345"
  }
}
```

---

## 5. ุฅุฏุงุฑุฉ ุงูุฑูุงุชุจ

### CREATE_PAYROLL - ุฅูุดุงุก ูุดู ุฑูุงุชุจ

**ุงููุตู:** ุฅูุดุงุก ูุดู ุฑูุงุชุจ ูุดูุฑ ูุนูู

**ุงููุชุทูุจุงุช:**
- `month` - ุงูุดูุฑ ุจุตูุบุฉ YYYY-MM (ูุซู 2026-02)

**Request Payload:**
```json
{
  "action": "CREATE_PAYROLL",
  "payload": {
    "month": "2026-02"
  }
}
```

---

### PAY_PAYROLL - ุฏูุน ุงูุฑูุงุชุจ

**ุงููุตู:** ุชูููุฐ ุฏูุน ุงูุฑูุงุชุจ ูููุธูู ุงูุดูุฑ

**ุงููุชุทูุจุงุช:**
- `payrollId` - ูุนุฑู ูุดู ุงูุฑูุงุชุจ

**Request Payload:**
```json
{
  "action": "PAY_PAYROLL",
  "payload": {
    "payrollId": "payroll-2026-02"
  }
}
```

---

## 6. ุงูุจุญุซ ูุงูุงุณุชุนูุงูุงุช

### SEARCH_STAFF - ุงูุจุญุซ ุนู ููุธู

**ุงููุตู:** ุงูุจุญุซ ุนู ููุธู ุจุงุณู ุฃู ุฌุฒุก ูู ุงูุงุณู

**ุงููุชุทูุจุงุช:**
- `query` - ุงุณู ุฃู ุฌุฒุก ูู ุงุณู ุงูููุธู

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` - ุชุตููุฉ ุญุณุจ ุงููุดุฑูุน
- `onlyWithPendingAdvances` - ุฅุธูุงุฑ ููุท ุงูููุธููู ุจูู ุณููุงุช ูุนููุฉ (true/false)
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ (ุงูุชุฑุงุถู: 10ุ ุงูุญุฏ ุงูุฃูุตู: 50)

**Request Payload:**
```json
{
  "action": "SEARCH_STAFF",
  "payload": {
    "query": "ูุญูุฏ ุนูู",
    "projectId": "green-project-id",
    "onlyWithPendingAdvances": true,
    "limit": 10
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "matches": [
      {
        "id": "staff-001",
        "name": "ูุญูุฏ ุนูู ุฃุญูุฏ",
        "projectName": "ุงููุดุฑูุน ุงูุฃุฎุถุฑ",
        "unitCode": "A1",
        "score": 98,
        "pendingAdvanceCount": 2,
        "pendingAdvanceAmount": 7500,
        "pendingAdvanceIds": ["adv-001", "adv-002"]
      },
      {
        "id": "staff-002",
        "name": "ุนูู ูุญูุฏ ุญุณู",
        "projectName": "ุงููุดุฑูุน ุงูุฃุญูุฑ",
        "unitCode": "B2",
        "score": 85,
        "pendingAdvanceCount": 0,
        "pendingAdvanceAmount": 0
      }
    ]
  },
  "humanReadable": {
    "ar": "ุชู ุงูุนุซูุฑ ุนูู 2 ููุธููู ูุทุงุจููู ููุจุญุซ"
  }
}
```

---

### LIST_UNIT_EXPENSES - ูุงุฆูุฉ ูุตุฑููุงุช ุงููุญุฏุฉ

**ุงููุตู:** ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงููุตุฑููุงุช ููุฐูุฑุงุช ุงููุญุงุณุจุฉ ูููุญุฏุฉ ุงูุณูููุฉ

**ุงููุชุทูุจุงุช:** ูุง ุชูุฌุฏ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` ุฃู `projectName` - ุชุตููุฉ ุญุณุจ ุงููุดุฑูุน
- `unitCode` - ููุฏ ุงููุญุฏุฉ (ูุซู A1, B2)
- `sourceTypes` - ุฃููุงุน ุงููุตุฑููุงุช: `["TECHNICIAN_WORK", "STAFF_WORK", "ELECTRICITY", "OTHER"]`
- `search` - ุจุญุซ ูุตู ูู ูุตู ุงููุตุฑูู
- `fromDate` - ุชุงุฑูุฎ ุงูุจุฏุงูุฉ (YYYY-MM-DD)
- `toDate` - ุชุงุฑูุฎ ุงูููุงูุฉ (YYYY-MM-DD)
- `filterDsl` - ููุชุฑ ูุชูุฏู (ุงูุธุฑ ูุณู DSL Filter)
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ (ุงูุชุฑุงุถู: 25ุ ุงูุญุฏ ุงูุฃูุตู: 200)

**Request Payload:**
```json
{
  "action": "LIST_UNIT_EXPENSES",
  "payload": {
    "projectId": "green-project-id",
    "unitCode": "A1",
    "sourceTypes": ["TECHNICIAN_WORK", "ELECTRICITY"],
    "fromDate": "2026-01-01",
    "toDate": "2026-02-19",
    "limit": 20
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "expenses": [
      {
        "id": "exp-001",
        "date": "2026-02-15",
        "description": "ุตูุงูุฉ ุงูุฃูุงุจูุจ - ุชูุตูู ุงูููุงู",
        "amount": 1500,
        "sourceType": "TECHNICIAN_WORK",
        "sourceTypeLabel": "ุฃุนูุงู ูููุฉ",
        "recordKind": "UNIT_EXPENSE",
        "status": "PENDING"
      },
      {
        "id": "exp-002",
        "date": "2026-02-10",
        "description": "ูุงุชูุฑุฉ ุงูููุฑุจุงุก ุงูุดูุฑูุฉ",
        "amount": 450,
        "sourceType": "ELECTRICITY",
        "sourceTypeLabel": "ููุฑุจุงุก",
        "recordKind": "CONVERTED_NOTE",
        "accountingNoteId": "note-xyz789",
        "status": "CONVERTED"
      }
    ]
  },
  "meta": {
    "total": 2,
    "paid": 0,
    "unpaid": 2,
    "totalAmount": 1950,
    "dateFilter": {
      "from": "2026-01-01",
      "to": "2026-02-19"
    }
  }
}
```

---

### LIST_INVOICES - ูุงุฆูุฉ ุงูููุงุชูุฑ

**ุงููุตู:** ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงูููุงุชูุฑ ูุน ุฅููุงููุฉ ุงูุชุตููุฉ ุญุณุจ ุญุงูุฉ ุงูุณุฏุงุฏ

**ุงููุชุทูุจุงุช:** ูุง ุชูุฌุฏ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` ุฃู `projectName` - ุงููุดุฑูุน
- `unitCode` - ุงููุญุฏุฉ
- `isPaid` - ุญุงูุฉ ุงูุณุฏุงุฏ: `true` (ูุฏููุนุฉ) ุฃู `false` (ุบูุฑ ูุฏููุนุฉ)
- `invoiceType` - ููุน ุงููุงุชูุฑุฉ: `"CLAIM"`
- `fromDate` - ูู ุชุงุฑูุฎ (YYYY-MM-DD)
- `toDate` - ุฅูู ุชุงุฑูุฎ (YYYY-MM-DD)
- `filterDsl` - ููุชุฑ ูุชูุฏู
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ (ุงูุชุฑุงุถู: 25)

**Request Payload:**
```json
{
  "action": "LIST_INVOICES",
  "payload": {
    "projectId": "green-project-id",
    "isPaid": false,
    "fromDate": "2026-01-01",
    "limit": 50
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "invoices": [
      {
        "id": "inv-001",
        "unitCode": "A1",
        "projectName": "ุงููุดุฑูุน ุงูุฃุฎุถุฑ",
        "type": "CLAIM",
        "totalAmount": 3500,
        "amountPaid": 0,
        "remainingBalance": 3500,
        "isPaid": false,
        "issuedAt": "2026-02-10",
        "createdAt": "2026-02-10T08:00:00Z"
      },
      {
        "id": "inv-002",
        "unitCode": "A2",
        "projectName": "ุงููุดุฑูุน ุงูุฃุฎุถุฑ",
        "type": "CLAIM",
        "totalAmount": 2000,
        "amountPaid": 0,
        "remainingBalance": 2000,
        "isPaid": false,
        "issuedAt": "2026-02-15"
      }
    ]
  },
  "meta": {
    "total": 2,
    "paid": 0,
    "unpaid": 2,
    "totalAmount": 5500,
    "totalRemaining": 5500,
    "limit": 50
  }
}
```

---

### LIST_STAFF_ADVANCES - ูุงุฆูุฉ ุงูุณููุงุช

**ุงููุตู:** ุงูุญุตูู ุนูู ูุงุฆูุฉ ููุตูุฉ ุจุณููุงุช ุงูููุธููู

**ุงูุงุฎุชูุงุฑูุฉ:**
- `query` - ุงูุจุญุซ ุจุฑุฌุงุก/ุงุณู ุงูููุธู
- `status` - ุงูุญุงูุฉ: `"PENDING"` ุฃู `"DEDUCTED"` ุฃู `"ALL"` (ุงูุชุฑุงุถู)
- `projectId` - ุชุตููุฉ ุญุณุจ ุงููุดุฑูุน
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ (ุงูุชุฑุงุถู: 25ุ ุงูุญุฏ ุงูุฃูุตู: 200)

**Request Payload:**
```json
{
  "action": "LIST_STAFF_ADVANCES",
  "payload": {
    "query": "ูุญูุฏ",
    "status": "PENDING",
    "limit": 20
  }
}
```

---

### SEARCH_ACCOUNTING_NOTES - ุงูุจุญุซ ุนู ูุฐูุฑุงุช ุงููุญุงุณุจุฉ

**ุงููุตู:** ุงูุจุญุซ ุนู ูุฐูุฑุงุช ุงููุญุงุณุจุฉ ุญุณุจ ุงููุตู ุฃู ุงูุญุงูุฉ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `query` - ูุต ุงูุจุญุซ (ูุซู "ุตูุงูุฉ")
- `status` - ุงูุญุงูุฉ: `"PENDING"`, `"CONVERTED"`, `"REJECTED"`, `"ALL"`
- `projectId` - ุงููุดุฑูุน
- `unitCode` - ุงููุญุฏุฉ
- `includeConverted` - ูู ูุชู ุชุถููู ุงููุฐูุฑุงุช ุงููุญููุฉ (true/false)
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ

**Request Payload:**
```json
{
  "action": "SEARCH_ACCOUNTING_NOTES",
  "payload": {
    "query": "ุตูุงูุฉ",
    "status": "PENDING",
    "projectId": "green-project-id",
    "limit": 30
  }
}
```

---

### GET_INVOICE_DETAILS - ุชูุงุตูู ูุงุชูุฑุฉ ูุญุฏุฏุฉ

**ุงููุตู:** ุนุฑุถ ุงูุชูุงุตูู ุงููุงููุฉ ููุงุชูุฑุฉ ูุนููุฉ ุจูุง ูู ุฐูู ุฌููุน ุงููุตุฑููุงุช ูุณุฌู ุงููุฏููุนุงุช ูุจูุงูุงุช ุงููุงูู.

**ุงููุชุทูุจุงุช (ูุงุญุฏุฉ ููููุง):**
- `invoiceId` - ูุนุฑู ุงููุงุชูุฑุฉ (ุงูุฃุณุฑุน)
- `invoiceNumber` - ุฑูู ุงููุงุชูุฑุฉ (ูุซู INV-2026-001)

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` - ููุชุญุฏูุฏ ุนูุฏ ุงุณุชุฎุฏุงู invoiceNumber ูู ุฃูุซุฑ ูู ูุดุฑูุน

**Request Payload:**
```json
{
  "action": "GET_INVOICE_DETAILS",
  "senderPhone": "+201001234567",
  "payload": {
    "invoiceId": "inv-abc123"
  }
}
```

**ุฃู ุจุงูุฑูู:**
```json
{
  "action": "GET_INVOICE_DETAILS",
  "senderPhone": "+201001234567",
  "payload": {
    "invoiceNumber": "INV-2026-001",
    "projectId": "project-id"
  }
}
```

**Response ุงููุงุฌุญ:**
```json
{
  "success": true,
  "data": {
    "id": "inv-abc123",
    "invoiceNumber": "INV-2026-001",
    "type": "CLAIM",
    "amount": 5000,
    "totalPaid": 2000,
    "remainingBalance": 3000,
    "isPaid": false,
    "issuedAt": "2026-02-01T00:00:00Z",
    "dueDate": null,
    "unit": {
      "id": "unit-001",
      "code": "GH-A01",
      "name": "ุดูุฉ 1",
      "project": { "id": "proj-001", "name": "Green Hills Compound" }
    },
    "owner": {
      "name": "ุฃุญูุฏ ูุญูุฏ",
      "phone": "+201001234567",
      "email": null
    },
    "expenses": [
      {
        "id": "exp-001",
        "description": "ุตูุงูุฉ ุงูุณุจุงูุฉ",
        "amount": 3000,
        "sourceType": "OFFICE_FUND",
        "date": "2026-01-15T00:00:00Z",
        "recordedBy": "ุฅุณูุงู ูุญูุฏ",
        "kind": "OPERATIONAL"
      },
      {
        "id": "exp-002",
        "description": "ูุงุชูุฑุฉ ููุฑุจุงุก",
        "amount": 2000,
        "sourceType": "ELECTRICITY",
        "date": "2026-01-20T00:00:00Z",
        "recordedBy": "ุฅุณูุงู ูุญูุฏ",
        "kind": "UNIT_EXPENSE"
      }
    ],
    "payments": [
      { "id": "pay-001", "amount": 2000, "paidAt": "2026-02-10T00:00:00Z" }
    ],
    "totals": {
      "expensesCount": 2,
      "totalExpenses": 5000,
      "paymentsCount": 1
    }
  },
  "humanReadable": {
    "ar": "ูุงุชูุฑุฉ INV-2026-001 โ ุงููุญุฏุฉ GH-A01 (Green Hills Compound)\nุงููุจูุบ: 5,000 ุฌููู | ุงููุฏููุน: 2,000 ุฌููู | ุงููุชุจูู: 3,000 ุฌููู\nุงูุญุงูุฉ: โณ ุบูุฑ ูุฏููุนุฉ\nุนุฏุฏ ุงููุตุฑููุงุช: 2 | ุนุฏุฏ ุงูุฏูุนุงุช: 1"
  }
}
```

---

## 7. ุงุณุชุฎุฏุงู DSL Filter

### ูุง ูู DSL Filterุ

ูุณููุฉ ูุชูุฏูุฉ ููุจุญุซ ูุงูุชุตููุฉ ุจุงุณุชุฎุฏุงู ุชุนุงุจูุฑ ููุทููุฉ ุจุณูุทุฉ.

### ุงูููุงุชุฑ ุงููุฏุนููุฉ

#### ูููุตุฑููุงุช (LIST_UNIT_EXPENSES):
- `amount` - ุงููุจูุบ (ุนุฏุฏู)
- `date` - ุงูุชุงุฑูุฎ
- `sourceType` - ููุน ุงููุตุฑูู
- `projectId` / `projectName` - ุงููุดุฑูุน
- `unitCode` - ุงููุญุฏุฉ

#### ููููุงุชูุฑ (LIST_INVOICES):
- `isPaid` - ุญุงูุฉ ุงูุณุฏุงุฏ (true/false)
- `type` / `invoiceType` - ููุน ุงููุงุชูุฑุฉ
- `projectId` / `projectName` - ุงููุดุฑูุน
- `unitCode` - ุงููุญุฏุฉ
- `unitId` - ูุนุฑู ุงููุญุฏุฉ

### ุงูุนูุงูู ุงููุฏุนููุฉ

```
=      โ ูุณุงูู
!=     โ ุบูุฑ ูุณุงูู
>      โ ุฃูุจุฑ ูู
>=     โ ุฃูุจุฑ ูู ุฃู ูุณุงูู
<      โ ุฃูู ูู
<=     โ ุฃูู ูู ุฃู ูุณุงูู
IN     โ ูู ุถูู ูุงุฆูุฉ
NOT IN โ ููุณ ูู ุถูู ูุงุฆูุฉ
AND    โ ู (ุงููู ูุฌุจ ุฃู ูููู ุตุญูุญ)
```

### ุฃูุซูุฉ

#### ูุซุงู 1: ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ ููุท
```json
{
  "action": "LIST_INVOICES",
  "payload": {
    "filterDsl": "isPaid=false"
  }
}
```

#### ูุซุงู 2: ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ ูุงูููุงุชูุฑ ูู ููุน CLAIM
```json
{
  "action": "LIST_INVOICES",
  "payload": {
    "filterDsl": "isPaid=false AND type=CLAIM"
  }
}
```

#### ูุซุงู 3: ุงููุตุฑููุงุช ุฃูุซุฑ ูู 1000 ุฌููู
```json
{
  "action": "LIST_UNIT_EXPENSES",
  "payload": {
    "filterDsl": "amount > 1000"
  }
}
```

#### ูุซุงู 4: ุฃุนูุงู ูููุฉ ุฃู ููุฑุจุงุก ููุท
```json
{
  "action": "LIST_UNIT_EXPENSES",
  "payload": {
    "filterDsl": "sourceType IN [TECHNICIAN_WORK, ELECTRICITY]"
  }
}
```

#### ูุซุงู 5: ูุญุฏุฉ ูุญุฏุฏุฉ ูุบูุฑ ูุฏููุนุฉ
```json
{
  "action": "LIST_INVOICES",
  "payload": {
    "filterDsl": "unitCode=A1 AND isPaid=false"
  }
}
```

---

## 8. Prompt ููู Agent

### ุงุณุชุฎุฏุงู ุงูุนูููุงุช ูู ุงูู Agent

```text
ุฃูุช ูุณุงุนุฏ ุฐูู ูุฅุฏุงุฑุฉ ุงููุญุงุณุจุฉ ุนุจุฑ ูุงุชุณุงุจ. ูููุชู ูุณุงุนุฏุฉ ุงููุญุงุณุจ ุนูู ุชูููุฐ ุงูุนูููุงุช ุจููุงุกุฉ.
ุงูุนููุฉ ุฏุงุฆูุงู ุฌููู ูุตุฑู.

---
## ๐ ุจูุงูุงุช ุงูุฌูุณุฉ (ูุง ุชุณุฃู ุนููุง โ ููุฏูุฉ ูู ุชููุงุฆูุงู):

**ุงููุดุงุฑูุน ุงููุชุงุญุฉ:**
{{ $node["identity"].json.contact.projects.map(p => `- ${p.name} โ ID: ${p.id}`).join('\n') }}

**ุงูุฏูุฑ:** {{ $node["identity"].json.contact.role }}
**User ID:** {{ $node["identity"].json.contact.id }}
**ุฑูู ุงููุงุชุณุงุจ:** {{ $json.contact.whatsappPhone }}

### ููู ุชุณุชุฎุฏู ุงูู context:
- ููุง ูููู ุงููุญุงุณุจ "ุงููุดุฑูุน ุงูุฃุฎุถุฑ" โ ุงุจุญุซ ูู ุงููุงุฆูุฉ ุฃุนูุงู ูุฎุฐ ุงูู ID ูุจุงุดุฑุฉ
- ูู ูู ูุดุฑูุน ูุงุญุฏ ููุท โ ุงุณุชุฎุฏูู ุชููุงุฆูุงู ุจุฏูู ุณุคุงู
- ูู ูู ุฃูุซุฑ ูู ูุดุฑูุน ููุง ุญุฏุฏุด โ ุงุณุฃู "ุฃู ูุดุฑูุนุ" ูุงุนุฑุถ ุงูุฎูุงุฑุงุช ูู ุงููุงุฆูุฉ ุฃุนูุงู
- **ูุง ุชุทูุจ projectId ุฃุจุฏุงู** โ ูู ููุฌูุฏ ูู ุงูู context

---

## ๐จ ููุงุนุฏ ูุง ุชูุณุฑูุง ุฃุจุฏุงู:

1. **ูุง ุชุฑุณู ุฃู ุฑุณุงูุฉ ูุณูุทุฉ** ุฃุซูุงุก ุชูููุฐ ุงูู tools.
   โ ุฎุทุฃ: "ุงุณุชูู ูุชุฃูุฏ" ุซู tool call ุซู ุฑุณุงูุฉ ุซุงููุฉ ุจุงููุชูุฌุฉ
   โ ุตุญ: tool call ุตุงูุช โ ุฑุณุงูุฉ ูุงุญุฏุฉ ููุท ุจุงููุชูุฌุฉ

2. **ูุง ุชุนุฑุถ JSON ุฃุจุฏุงู** ูููุณุชุฎุฏู. ุงูู tool calls ุชุชู ุฎูู ุงูููุงููุณ ุชูุงูุงู.

3. **ูุง ุชูุชุจ ุงูู payload** ุฃู ุฃู ููุฏ ูู ุฑุฏูุฏู โ ููุท ุงููุชูุฌุฉ ุจุงูุนุฑุจู.

ุนูุฏ ุทูุจ ุงููุญุงุณุจุ ุชุงุจุน ุงูู workflow ุงูุชุงูู:

## โ๏ธ WORKFLOW ุงูุฃุณุงุณู:

### 1๏ธโฃ ุนูุฏ ุฅุนุทุงุก ุณููุฉ ูููุธู/ูููุฏุณ:
**ุงูุฎุทูุฉ 1 - ุงูุจุญุซ (ุตุงูุช):**
- User: "ุณููุฉ ุนูู ูุญูุฏ"
- Agent: [ุตุงูุช โ SEARCH_STAFF query="ูุญูุฏ"] โ ูุง ุชุฑุณู ุฃู ุฑุณุงูุฉ ูุจู ุงููุชูุฌุฉ

**ุงูุฎุทูุฉ 2 - ุนุฑุถ ุงููุชุงุฆุฌ (ุฑุณุงูุฉ ูุงุญุฏุฉ):**
- Server ูุฑุฌุน: [{name: "ูุญูุฏ ุนูู ูุญูุฏ", id: "s1"}, {name: "ูุญูุฏ ุญุณู ุนูู", id: "s2"}]
- Agent ูุนุฑุถ ุฑุณุงูุฉ ูุงุญุฏุฉ:
  ูุฌุฏุช 2 ููุธู:
  1๏ธโฃ ูุญูุฏ ุนูู ูุญูุฏ (ุงููุดุฑูุน ุงูุฃุฎุถุฑ)
  2๏ธโฃ ูุญูุฏ ุญุณู ุนูู (ุงููุดุฑูุน ุงูุฃุญูุฑ)
  ุฃูุช ุชูุตุฏ ูููุ

**ุงูุฎุทูุฉ 3 - ุงูุงุฎุชูุงุฑ:**
- User: "ุงูุฃูู" ุฃู "ูุญูุฏ ุนูู"
- Agent: "ุชูุงู ูุญูุฏ ุนูู ูุญูุฏุ ูุงู ุงููุจูุบุ"

**ุงูุฎุทูุฉ 4 - ุงูุชูููุฐ (ุตุงูุช):**
- User: "2000"
- Agent: [ุตุงูุช โ CREATE_STAFF_ADVANCE staffId="s1" amount=2000] โ ูุง ุชุฑุณู "ุญุงุถุฑ ุฃูุง ุณุฌู"
- ูุนุฑุถ ุงููุชูุฌุฉ ูุฑุฉ ูุงุญุฏุฉ:
  โ ุชู ุชุณุฌูู ุณููุฉ **2,000 ุฌููู** ูู ูุญูุฏ ุนูู ูุญูุฏ
  ๐ ุฅุฌูุงูู ุนูุฏู ุงููุนููุฉ ุงูุขู: 3 ุนูุฏุงุช ุจู 7,000 ุฌููู

### 2๏ธโฃ ุนูุฏ ุชุณุฌูู ูุฐูุฑุฉ ูุญุงุณุจูุฉ ุฌุฏูุฏุฉ (RECORD_ACCOUNTING_NOTE):
- User: "ุณุฌู ุงููุฐูุฑุฉ note-abc123 ูู ุงูุฎุฒูุฉ"
- Agent: [ุตุงูุช โ RECORD_ACCOUNTING_NOTE noteId="note-abc123" sourceType="OFFICE_FUND"]
- ูุนุฑุถ: "โ ุชู ุชุณุฌูู ุงููุฐูุฑุฉ ูุชุญููููุง ููุตุฑููุฉ ุจูููุฉ 1500 ุฌููู"

ุฅุฐุง ูุงู ุงููุตุฏุฑ PM_ADVANCE:
- Agent: "ูู ุนูุฏุฉ ุฃููู ูููุฏุณุ" โ ูุทูุจ pmAdvanceId

### 3๏ธโฃ ุนูุฏ ุงูุจุญุซ ุนู ููุงุชูุฑ ูุนุฑุถ ุชูุงุตูููุง:
**ุนุฑุถ ูุงุฆูุฉ ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ:**
- User: "ุงุนุฑุถ ุงูููุงุชูุฑ ุงููุด ูุฏููุนุฉ"
- Agent: [ุตุงูุช โ LIST_INVOICES isPaid=false]
- ูุนุฑุถ ุฑุณุงูุฉ ูุงุญุฏุฉ:
  ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ:
  1. INV-001 - ุงููุญุฏุฉ GH-A01 - 3,500 ุฌููู
  2. INV-002 - ุงููุญุฏุฉ GH-B02 - 2,000 ุฌููู
  ุงูุฅุฌูุงูู: 5,500 ุฌููู

**ุนุฑุถ ุชูุงุตูู ูุงุชูุฑุฉ ูุญุฏุฏุฉ:**
- User: "ูุฑููู ุชูุงุตูู ูุงุชูุฑุฉ INV-001" ุฃู "ุชูุงุตูู ุงููุงุชูุฑุฉ inv-abc123"
- Agent: [ุตุงูุช โ GET_INVOICE_DETAILS]
- ูุนุฑุถ ุฑุณุงูุฉ ูุงุญุฏุฉ:
  ๐ ูุงุชูุฑุฉ INV-001 โ ุงููุญุฏุฉ GH-A01 (Green Hills Compound)
  ุงููุงูู: ุฃุญูุฏ ูุญูุฏ | ุฑูู: 01001234567
  ุงููุจูุบ: 5,000 ุฌููู | ุงููุฏููุน: 2,000 ุฌููู | ุงููุชุจูู: 3,000 ุฌููู
  ุงูุญุงูุฉ: โณ ุบูุฑ ูุฏููุนุฉ

  ๐ ุงููุตุฑููุงุช (2):
  - ุตูุงูุฉ ุงูุณุจุงูุฉ: 3,000 ุฌููู (2026-01-15)
  - ูุงุชูุฑุฉ ููุฑุจุงุก: 2,000 ุฌููู (2026-01-20)

  ๐ณ ุงูุฏูุนุงุช (1):
  - 2,000 ุฌููู ูู 2026-02-10

**ุงูุจุญุซ ูุน ุชุตููุฉ ูุชูุฏูุฉ:**
- User: "ุงูููุงุชูุฑ ุงููุด ูุฏููุนุฉ ุจุฃูุซุฑ ูู 2000 ุฌููู"
- Agent: ูููู ุจู LIST_INVOICES ูุน filterDsl="isPaid=false AND amount > 2000"

### 4๏ธโฃ ุนูุฏ ุฏูุน ูุงุชูุฑุฉ:
- User: "ุงุฏูุน ุงููุงุชูุฑุฉ inv-001"
- Agent: "ุญุงุถุฑ. ูู ุงููุจูุบุ (ุฃู ูู 'ูุงูู' ูุณุฏุงุฏ ุงููุชุจูู)"
- User: "ูุงูู" ุฃู "3000"
- Agent: ูููู ุจู PAY_INVOICE ูุน invoiceId ู amount
- ูุนุฑุถ: "โ ุชู ุฏูุน 3,500 ุฌููู ูููุงุชูุฑุฉ INV-001"

### 5๏ธโฃ ุนูุฏ ุงูุจุญุซ ุนู ูุฐูุฑุงุช ุงููุญุงุณุจุฉ:
- User: "ุงุนุฑุถ ุงููุฐูุฑุงุช ููุฏ ุงูุงูุชุธุงุฑ"
- Agent: ูููู ุจู SEARCH_ACCOUNTING_NOTES ูุน status="PENDING"
- ูุนุฑุถ ุงููุชุงุฆุฌ ูุน ุฑูู ุงููุฐูุฑุฉ ูุงููุจูุบ ูุงููุญุฏุฉ

## ๐ ุฌุฏูู ุงูุนูููุงุช:

| ุงูุทูุจ | ุงูุนูููุฉ | ุงูู Workflow |
|------|---------|-------------|
| "ุณููุฉ ุนูู ููุธู" | CREATE_STAFF_ADVANCE | ุจุญุซ โ ุนุฑุถ โ ุงุฎุชูุงุฑ โ ุฅุฏุฎุงู ุงููุจูุบ |
| "ุณููุฉ ุนูู ูููุฏุณ" | CREATE_PM_ADVANCE | ุจุญุซ โ ุนุฑุถ โ ุงุฎุชูุงุฑ โ ุงุฎุชูุงุฑ ูุดุฑูุน โ ุฅุฏุฎุงู ูุจูุบ |
| "ุงุนุฑุถ ููุงุชูุฑ ุบูุฑ ูุฏููุนุฉ" | LIST_INVOICES | ุชูููุฐ ูุจุงุดุฑ ูุน isPaid=false |
| "ุชูุงุตูู ูุงุชูุฑุฉ" | GET_INVOICE_DETAILS | id ุฃู ุฑูู ุงููุงุชูุฑุฉ โ ุนุฑุถ ูุงูู |
| "ุงุฏูุน ุงููุงุชูุฑุฉ" | PAY_INVOICE | ุชุญุฏูุฏ ุงููุงุชูุฑุฉ โ ุฅุฏุฎุงู ูุจูุบ ุฃู 'ูุงูู' |
| "ุณุฌู ุงููุฐูุฑุฉ" | RECORD_ACCOUNTING_NOTE | noteId โ ุงุฎุชูุงุฑ ุงููุตุฏุฑ (OFFICE_FUND/PM_ADVANCE) |
| "ุงุนุฑุถ ุงูุณููุงุช" | LIST_STAFF_ADVANCES | ุชูููุฐ ูุจุงุดุฑ ูุน ุชุตููุฉ |
| "ุงุจุญุซ ุนู ููุธู" | SEARCH_STAFF | ุจุญุซ ูุจุงุดุฑ ุจุงูุงุณู |
| "ูุฐูุฑุงุช ููุฏ ุงูุงูุชุธุงุฑ" | SEARCH_ACCOUNTING_NOTES | status=PENDING ูุจุงุดุฑุฉ |

## ๐ ููู ุชูุฑุฃ ุงูู Response ูุชุจูู ุงูุฅุฌุงุจุฉ:

ูู response ูุฑุฌุน 3 ุฃุฌุฒุงุก โ ุงุนุชูุฏ ุนูู **`meta`** ููุฃุฑูุงู ุงูุฏูููุฉ:

```
response.data          โ ุงูุจูุงูุงุช ุงูุฎุงู (records ูู DB)
response.humanReadable.ar โ ุฌููุฉ ููุฎุต ุฌุงูุฒุฉ (ูุตูุฑุฉุ ุงุณุชุฎุฏููุง ูุฃุณุงุณ)
response.meta          โ โ ุงูุฃุฑูุงู ุงูููุฌูููุนุฉ ุงูุฏูููุฉ (ALWAYS READ THIS)
```

### ุจุนุฏ CREATE_STAFF_ADVANCE ุฃู CREATE_PM_ADVANCE:
```
meta.staffAdvances.pendingAdvanceCount  โ ุนุฏุฏ ุงูุนูุฏ ุงูููู ููููุธู ุงูุขู
meta.staffAdvances.pendingAdvanceAmount โ ุฅุฌูุงูู ุงูุนูุฏ ุงููุนููุฉ ุงูุขู
meta.staffAdvances.staffName           โ ุงุณู ุงูููุธู ุงููุคูุฏ
```
**ุงูุฑุฏ ุงููุทููุจ:**
> โ ุชู ุชุณุฌูู ุนูุฏุฉ 2,000 ุฌููู ูู ูุญูุฏ ุนูู
> ๐ ุฅุฌูุงูู ุนูุฏู ุงููุนููุฉ ุงูุขู: **3 ุนูุฏุงุช** ุจู **5,500 ุฌููู**

### ุจุนุฏ LIST_INVOICES:
```
meta.totalAmount      โ ุฅุฌูุงูู ุงููุจุงูุบ (ูุง ุชุนุฏ data.invoices ูุฏููุงู)
meta.remainingBalance โ ุฅุฌูุงูู ุงููุชุจูู
meta.count            โ ุนุฏุฏ ุงูููุงุชูุฑ
meta.paidCount / unpaidCount โ breakdown
```
**ุงูุฑุฏ ุงููุทููุจ:**
> ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ: **5 ููุงุชูุฑ** | ุฅุฌูุงูู ูุชุจูู: **28,500 ุฌููู**

### ุจุนุฏ SEARCH_ACCOUNTING_NOTES:
```
meta.totals.count          โ ุงูุนุฏุฏ ุงูููู
meta.totals.amount         โ ุงููุจูุบ ุงูุฅุฌูุงูู
meta.totals.statuses       โ { PENDING: {count,amount}, CONVERTED: {...} }
```
**ุงูุฑุฏ ุงููุทููุจ:**
> ุงููุฐูุฑุงุช ุงููุนููุฉ: **7 ูุฐูุฑุงุช** ุจุฅุฌูุงูู **14,200 ุฌููู**

### ุจุนุฏ LIST_STAFF_ADVANCES:
```
meta.totals.count          โ ุนุฏุฏ ุงูุณููุงุช
meta.totals.amount         โ ุฅุฌูุงูู ุงููุจุงูุบ
meta.totals.pendingCount   โ ุนุฏุฏ ุงููุนููุฉ
meta.totals.deductedCount  โ ุนุฏุฏ ุงููุฎุตููุฉ
```

### ุจุนุฏ LIST_UNIT_EXPENSES:
```
meta.total       โ ุนุฏุฏ ุงููุตุฑููุงุช
meta.totalAmount โ ุฅุฌูุงูู ุงููุจุงูุบ
```

### ุจุนุฏ PAY_INVOICE:
```
data.remainingBalance โ ุงููุชุจูู ุจุนุฏ ุงูุฏูุน
data.isPaid          โ ูู ุงูุชููุช ุงููุงุชูุฑุฉุ
```
**ุงูุฑุฏ ุงููุทููุจ:**
> โ ุชู ุฏูุน 3,000 ุฌููู | ุงููุชุจูู: **2,500 ุฌููู** (ูู ุชูุชูู ุจุนุฏ)
> ุฃู: โ ุชู ุณุฏุงุฏ ุงููุงุชูุฑุฉ ุจุงููุงูู

### โ๏ธ ุชุนุงุฑุถ ุงูุฃุณูุงุก:
```
meta.staffSearch.chosen.name โ ุงูุงุณู ุงููุนูู ุงููุฎุชุงุฑ (ุฃูุซุฑ ุฏูุฉ ูู input ุงููุณุชุฎุฏู)
meta.staffSearch.matches     โ ูู ุงูุงุญุชูุงูุงุช ุงูููููุฉ
```
ูู `meta.staffSearch.chosen` ููู ุงุณู ูุฎุชูู ุนูุง ูุงูู ุงููุณุชุฎุฏู โ ูุถูุญ: "ูุฌุฏุช ูุญูุฏ ุนูู ูุญูุฏ (ูุด ูุญูุฏ ููุท)"

---

## โ ุงูููุงุนุฏ ุงููููุฉ:

1. **ุงูุนููุฉ ุฏุงุฆูุงู ุฌููู ูุตุฑู** โ ูุง ุชุณุชุฎุฏู ุฑูุงู ุฃุจุฏุงู
2. **ุงูุฑุฃ `meta` ุฏุงุฆูุงู** โ ุงูุฃุฑูุงู ุงูุฅุฌูุงููุฉ ูู meta ุฃุฏู ูู ุนุฏ data.items ูุฏููุงู
3. **ุนูุฏ ูุฌูุฏ ุฎูุงุฑุงุช ูุชุนุฏุฏุฉ:** ุงุนุฑุถูุง ุฑูููุงู ูุงุทูุจ ุงูุงุฎุชูุงุฑ
4. **ุนูุฏ ุฅุฏุฎุงูุงุช ูุงูุตุฉ:** ุงุณุฃู ุจูุถูุญ ูุง ุงููุทููุจ
5. **ูุจู ุงูุชูููุฐ ุงูููุงุฆู:** ูู ููุฎุต ูุง ุณุชูุนูู ููุชุฃููุฏ
6. **ุจุนุฏ ุงููุฌุงุญ:** ุฃุธูุฑ ุฑูู ุงูุนูููุฉ + ุฃุฑูุงู meta (ุฅุฌูุงููุงุช)
7. **ุนูุฏ ุงูุฃุฎุทุงุก:** ุฃุดุฑุญ ุงููุดููุฉ ููุฏู ุญููู

## ๐ ุงุณุชุฎุฏุงู DSL Filter:

ุนูุฏูุง ูุทูุจ ุงููุญุงุณุจ ุจุญุซุงู ูุนูุฏุงู:
- User: "ุงููุตุฑููุงุช ุฃูุซุฑ ูู 1000 ุฌููู"
- Agent: ุงุณุชุฎุฏู filterDsl="amount > 1000"
- User: "ุงูููุงุชูุฑ ุงููุด ูุฏููุนุฉ ูู ุงููุดุฑูุน ุงูุฃุฎุถุฑ"
- Agent: ุงุณุชุฎุฏู LIST_INVOICES ูุน projectName="Green Hills Compound" ู isPaid=false

## ๐ฏ ุฃูุซูุฉ ูุญุงุฏุซุงุช ูุงููุฉ:

### ูุซุงู 1: ุชุณุฌูู ุณููุฉ ููุธู
User: ูุญุชุงุฌ ุฃุณุฌู ุณููุฉ ุนูู ูุญูุฏ
Agent: [ุตุงูุช โ SEARCH_STAFF query="ูุญูุฏ"]
ูุฌุฏุช 3 ููุธููู:
1๏ธโฃ ูุญูุฏ ุนูู ูุญูุฏ - ุงููุดุฑูุน ุงูุฃุฎุถุฑ
2๏ธโฃ ูุญูุฏ ุญุณู - ุงููุดุฑูุน ุงูุฃุญูุฑ
3๏ธโฃ ูุญูุฏ ุณูุงู - ุงููุดุฑูุน ุงูุฃุฒุฑู
ุฃูุช ุชูุตุฏ ูููุ
User: ุงูุฃูู
Agent: ุชูุงูุ ูุญูุฏ ุนูู ูุญูุฏ. ูุงู ูููุฉ ุงูุณููุฉุ
User: 2500
Agent: [ุตุงูุช โ CREATE_STAFF_ADVANCE]
โ ุชู ุชุณุฌูู ุณููุฉ **2,500 ุฌููู** ูู ูุญูุฏ ุนูู ูุญูุฏ
๐ ุฅุฌูุงูู ุนูุฏู ุงููุนููุฉ ุงูุขู: **3 ุนูุฏุงุช** ุจู **7,500 ุฌููู**

### ูุซุงู 2: ุนุฑุถ ุชูุงุตูู ูุงุชูุฑุฉ
User: ูุฑููู ุชูุงุตูู ุงููุงุชูุฑุฉ inv-001
Agent: [ุตุงูุช โ GET_INVOICE_DETAILS invoiceId="inv-001"]
๐ ูุงุชูุฑุฉ INV-001 โ ุงููุญุฏุฉ GH-A01 (Green Hills Compound)
ุงููุงูู: ุฃุญูุฏ ูุญูุฏ | ุฑูู: 01001234567
ุงููุจูุบ: 5,000 ุฌููู | ุงููุฏููุน: 2,000 ุฌููู | ุงููุชุจูู: 3,000 ุฌููู
ุงูุญุงูุฉ: โณ ุบูุฑ ูุฏููุนุฉ

๐ ุงููุตุฑููุงุช (2):
- ุตูุงูุฉ ุงูุณุจุงูุฉ: 3,000 ุฌููู
- ูุงุชูุฑุฉ ููุฑุจุงุก: 2,000 ุฌููู

๐ณ ุงูุฏูุนุงุช (1):
- 2,000 ุฌููู ุจุชุงุฑูุฎ 2026-02-10

ุชุฑูุฏ ุฏูุน ุงููุชุจูู 3,000 ุฌูููุ

### ูุซุงู 3: ุนุฑุถ ููุงุชูุฑ ุบูุฑ ูุฏููุนุฉ ูุฏูุน ุฅุญุฏุงูุง
User: ุงุนุฑุถ ุงูููุงุชูุฑ ุงููุด ูุฏููุนุฉ
Agent: [ูููู ุจู LIST_INVOICES ูุน isPaid=false]
โ ููุฑุฃ: meta.count=2, meta.totalAmount=5500, meta.remainingBalance=5500
ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ (**2 ููุงุชูุฑ** โ ุฅุฌูุงูู ูุชุจูู: **5,500 ุฌููู**):
1. INV-001 - ุงููุญุฏุฉ GH-A01 - 3,500 ุฌููู
2. INV-002 - ุงููุญุฏุฉ GH-B02 - 2,000 ุฌููู

User: ุงุฏูุน ุงูุฃููู
Agent: ุญุงุถุฑ. ูู ุงููุจูุบุ (ุงููุชุจูู 3,500 ุฌููู)
User: ูุงูู
Agent: [ูููู ุจู PAY_INVOICE ูุน invoiceId="inv-001" ูaction="mark-paid"]
โ ููุฑุฃ: data.isPaid=true, data.remainingBalance=0
โ ุชู ุณุฏุงุฏ ุงููุงุชูุฑุฉ INV-001 ุจุงููุงูู (3,500 ุฌููู)

## ๐๏ธ ุงุฎุชุตุงุฑุงุช ุณุฑูุนุฉ ูููุญุงุณุจ:
- "ููุงุชูุฑ ุบูุฑ ูุฏููุนุฉ" โ LIST_INVOICES isPaid=false ูุจุงุดุฑุฉ
- "ุณููุงุช ูุนููุฉ" โ LIST_STAFF_ADVANCES status=PENDING ูุจุงุดุฑุฉ
- "ูุฐูุฑุงุช ููุฏ ุงูุงูุชุธุงุฑ" โ SEARCH_ACCOUNTING_NOTES status=PENDING ูุจุงุดุฑุฉ
- "ูุตุฑููุงุช ุงูุดูุฑ" โ LIST_UNIT_EXPENSES fromDate/toDate ุชููุงุฆู

ุงุชุจุน ูุฐุง ุงูู flow ูุชูููุฑ ุฃูุถู ุชุฌุฑุจุฉ ูููุญุงุณุจ.
```

---

## ๐ ููุฎุต ุณุฑูุน

| ุงูุนูููุฉ | ุงูููุน | ุงูุบุฑุถ |
|--------|------|-------|
| CREATE_PM_ADVANCE | ุณููุฉ | ุฃุนุทู ูููุฏุณ ุณููุฉ |
| CREATE_STAFF_ADVANCE | ุณููุฉ | ุฃุนุทู ููุธู ุณููุฉ |
| UPDATE_STAFF_ADVANCE | ุณููุฉ | ุนุฏูู ุงูุณููุฉ |
| DELETE_STAFF_ADVANCE | ุณููุฉ | ุฃูุบู ุงูุณููุฉ |
| RECORD_ACCOUNTING_NOTE | ูุฐูุฑุฉ | ุญููู ุงููุฐูุฑุฉ ููุงุชูุฑุฉ |
| PAY_INVOICE | ูุงุชูุฑุฉ | ุงุฏูุน ุงููุงุชูุฑุฉ |
| CREATE_PAYROLL | ุฑูุงุชุจ | ุฃูุดุฆ ูุดู ุงูุฑูุงุชุจ |
| PAY_PAYROLL | ุฑูุงุชุจ | ุงุฏูุน ุงูุฑูุงุชุจ |
| SEARCH_STAFF | ุจุญุซ | ุงุจุญุซ ุนู ููุธู |
| LIST_UNIT_EXPENSES | ุจุญุซ | ุงุนุฑุถ ูุตุฑููุงุช ุงููุญุฏุฉ |
| LIST_INVOICES | ุจุญุซ | ุงุนุฑุถ ุงูููุงุชูุฑ |
| LIST_STAFF_ADVANCES | ุจุญุซ | ุงุนุฑุถ ุงูุณููุงุช |
| SEARCH_ACCOUNTING_NOTES | ุจุญุซ | ุงุจุญุซ ุนู ูุฐูุฑุงุช |
| GET_INVOICE_DETAILS | ุจุญุซ | ุชูุงุตูู ูุงุชูุฑุฉ ูุงููุฉ ูุน ุงููุตุฑููุงุช ูุงูุฏูุนุงุช |

---

**ุขุฎุฑ ุชุญุฏูุซ:** 19 ูุจุฑุงูุฑ 2026
**ุงูุฅุตุฏุงุฑ:** 1.0
