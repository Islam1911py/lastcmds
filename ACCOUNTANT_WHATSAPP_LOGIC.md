# ุงููุญุงุณุจ ุนูู ูุงุชุณุงุจ - ุฏููู ุงูุนูููุงุช ุงููุงูู

> **ุงูุบุฑุถ:** ุชูุซูู ุดุงูู ูุฌููุน ุงูุนูููุงุช ุงูุชู ูููู ูููุญุงุณุจ ุชูููุฐูุง ุนุจุฑ ูุงุชุณุงุจ ูุน ุฃูุซูุฉ ุนูููุฉ ูุดุฑุญ ุงูู Payload

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [ุฅุฏุงุฑุฉ ุงูุณููุงุช ุงูููุฏุณูุฉ](#ุฅุฏุงุฑุฉ-ุงูุณููุงุช-ุงูููุฏุณูุฉ)
2. [ุฅุฏุงุฑุฉ ุณููุงุช ุงูููุธููู](#ุฅุฏุงุฑุฉ-ุณููุงุช-ุงูููุธููู)
3. [ุชุณุฌูู ูุฐูุฑุงุช ุงููุญุงุณุจุฉ](#ุชุณุฌูู-ูุฐูุฑุงุช-ุงููุญุงุณุจุฉ)
4. [ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ](#ุฅุฏุงุฑุฉ-ุงูููุงุชูุฑ)
5. [ุฅุฏุงุฑุฉ ุงูุฑูุงุชุจ](#ุฅุฏุงุฑุฉ-ุงูุฑูุงุชุจ)
6. [ุงูุจุญุซ ูุงูุงุณุชุนูุงูุงุช](#ุงูุจุญุซ-ูุงูุงุณุชุนูุงูุงุช)
7. [ุงุณุชุฎุฏุงู DSL Filter](#ุงุณุชุฎุฏุงู-dsl-filter)

8. [Prompt ููู Agent](#prompt-ููู-agent)

---

## 1. ุฅุฏุงุฑุฉ ุงูุณููุงุช ุงูููุฏุณูุฉ

### CREATE_PM_ADVANCE - ุฅูุดุงุก ุณููุฉ ูููุฏุณ

**ุงููุตู:** ุฅุนุทุงุก ุณููุฉ ููุฏูุฉ ููููุฏุณ ูู ุฃุฌู ูุดุฑูุน ูุนูู

**ุงููุชุทูุจุงุช:**
- `amount` (ุฅุฌุจุงุฑู) - ุงููุจูุบ ุงููุฑุงุฏ ุฅุนุทุงุคู
- `staffQuery` ุฃู `staffId` (ูุงุญุฏ ููููุง) - ุงุณู ุฃู ID ุงููููุฏุณ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` - ูุนุฑู ุงููุดุฑูุน
- `notes` - ููุงุญุธุงุช ุฅุถุงููุฉ

**Request Payload:**
```json
{
  "action": "CREATE_PM_ADVANCE",
  "senderPhone": "+201001234567",
  "payload": {
    "staffQuery": "ูุญูุฏ ุนูู",
    "amount": 5000,
    "projectId": "green-project-id",
    "notes": "ุณููุฉ ูุดุฑุงุก ููุงุฏ ุงูุจูุงุก"
  }
}
```

**Response ุงููุงุฌุญ:**
```json
{
  "success": true,
  "data": {
    "advanceId": "adv-12345",
    "staffName": "ูุญูุฏ ุนูู",
    "amount": 5000,
    "projectName": "ุงููุดุฑูุน ุงูุฃุฎุถุฑ",
    "status": "PENDING",
    "createdAt": "2026-02-19T10:30:00Z"
  },
  "humanReadable": {
    "ar": "ุชู ุฅุนุทุงุก ุณููุฉ ุจูููุฉ 5000 ุฌููู ููุญูุฏ ุนูู"
  }
}
```

---

## 2. ุฅุฏุงุฑุฉ ุณููุงุช ุงูููุธููู

### CREATE_STAFF_ADVANCE - ุฅูุดุงุก ุณููุฉ ููุธู

**ุงููุตู:** ุฅุนุทุงุก ุณููุฉ ูููุธู ุนุงู ุฃู ุฅุฏุงุฑู

**ุงููุชุทูุจุงุช:**
- `amount` (ุฅุฌุจุงุฑู) - ุงููุจูุบ
- `staffQuery` ุฃู `staffId` - ุงุณู ุฃู ID ุงูููุธู

**ุงูุงุฎุชูุงุฑูุฉ:**
- `note` - ููุงุญุธุฉ

**Request Payload:**
```json
{
  "action": "CREATE_STAFF_ADVANCE",
  "payload": {
    "staffQuery": "ูุงุทูุฉ ูุญููุฏ",
    "amount": 2000,
    "note": "ุณููุฉ ุงูุฑุงุชุจ ุงูุดูุฑู"
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "advanceId": "adv-67890",
    "staffName": "ูุงุทูุฉ ูุญููุฏ",
    "amount": 2000,
    "status": "PENDING"
  },
  "humanReadable": {
    "ar": "ุชู ุชุณุฌูู ุณููุฉ 2000 ุฌููู ููููุธู ูุงุทูุฉ ูุญููุฏ"
  }
}
```

---

### UPDATE_STAFF_ADVANCE - ุชุนุฏูู ุงูุณููุฉ

**ุงููุตู:** ุชุนุฏูู ูุจูุบ ุฃู ุชูุงุตูู ุณููุฉ ููุฌูุฏุฉ

**ุงููุชุทูุจุงุช:**
- `advanceId` (ุฅุฌุจุงุฑู) - ูุนุฑู ุงูุณููุฉ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `amount` - ุงููุจูุบ ุงูุฌุฏูุฏ
- `note` - ููุงุญุธุฉ ุฌุฏูุฏุฉ

**Request Payload:**
```json
{
  "action": "UPDATE_STAFF_ADVANCE",
  "payload": {
    "advanceId": "adv-67890",
    "amount": 2500
  }
}
```

---

### DELETE_STAFF_ADVANCE - ุญุฐู ุงูุณููุฉ

**ุงููุตู:** ุญุฐู ุณููุฉ ูู ูุชู ุงุณุชุฎุฏุงููุง ุจุนุฏ

**ุงููุชุทูุจุงุช:**
- `advanceId` - ูุนุฑู ุงูุณููุฉ

**Request Payload:**
```json
{
  "action": "DELETE_STAFF_ADVANCE",
  "payload": {
    "advanceId": "adv-67890"
  }
}
```

---

## 3. ุชุณุฌูู ูุฐูุฑุงุช ุงููุญุงุณุจุฉ

### RECORD_ACCOUNTING_NOTE - ุชุญููู ูุฐูุฑุฉ ููุงุชูุฑุฉ

**ุงููุตู:** ุชุญููู ูุฐูุฑุฉ ูุญุงุณุจุฉ (ูุตุฑููุงุช ูุณุฌูุฉ) ุฅูู ูุงุชูุฑุฉ ุฑุณููุฉ

**ุงููุชุทูุจุงุช:**
- `noteId` - ูุนุฑู ุงููุฐูุฑุฉ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `sourceType` - ูุตุฏุฑ ุงูุชูููู: `"OFFICE_FUND"` ุฃู `"PM_ADVANCE"`
- `pmAdvanceId` - ูุนุฑู ุงูุณููุฉ (ุฅุฐุง ูุงู sourceType = PM_ADVANCE)

**Request Payload:**
```json
{
  "action": "RECORD_ACCOUNTING_NOTE",
  "payload": {
    "noteId": "note-abc123",
    "sourceType": "OFFICE_FUND"
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "invoiceId": "inv-12345",
    "noteId": "note-abc123",
    "convertedAmount": 3500,
    "invoiceType": "CLAIM"
  },
  "humanReadable": {
    "ar": "ุชู ุชุญููู ุงููุฐูุฑุฉ ุฅูู ูุงุชูุฑุฉ ุจูููุฉ 3500 ุฌููู"
  }
}
```

---

## 4. ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ

### PAY_INVOICE - ุฏูุน ุงููุงุชูุฑุฉ

**ุงููุตู:** ุฏูุน ูุงุชูุฑุฉ ุฃู ุฌุฒุก ูููุง

**ุงููุชุทูุจุงุช:**
- `invoiceId` - ูุนุฑู ุงููุงุชูุฑุฉ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `amount` - ุงููุจูุบ ุงููุฑุงุฏ ุฏูุนู (ุจุฏูู ุชุญุฏูุฏ = ุฏูุน ูุงูู)
- `action` - ููุน ุงูุฏูุน: `"pay"` (ุฏูุน ุชุฏุฑูุฌู) ุฃู `"mark-paid"` (ุชุณุฏูุฏ ูุงูู)

**Request Payload:**
```json
{
  "action": "PAY_INVOICE",
  "payload": {
    "invoiceId": "inv-12345",
    "amount": 5000,
    "action": "pay"
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "invoiceId": "inv-12345",
    "amountPaid": 5000,
    "remainingBalance": 0,
    "status": "PAID"
  },
  "humanReadable": {
    "ar": "ุชู ุฏูุน 5000 ุฌููู ูููุงุชูุฑุฉ ุฑูู inv-12345"
  }
}
```

---

## 5. ุฅุฏุงุฑุฉ ุงูุฑูุงุชุจ

### CREATE_PAYROLL - ุฅูุดุงุก ูุดู ุฑูุงุชุจ

**ุงููุตู:** ุฅูุดุงุก ูุดู ุฑูุงุชุจ ูุดูุฑ ูุนูู

**ุงููุชุทูุจุงุช:**
- `month` - ุงูุดูุฑ ุจุตูุบุฉ YYYY-MM (ูุซู 2026-02)

**Request Payload:**
```json
{
  "action": "CREATE_PAYROLL",
  "payload": {
    "month": "2026-02"
  }
}
```

---

### PAY_PAYROLL - ุฏูุน ุงูุฑูุงุชุจ

**ุงููุตู:** ุชูููุฐ ุฏูุน ุงูุฑูุงุชุจ ูููุธูู ุงูุดูุฑ

**ุงููุชุทูุจุงุช:**
- `payrollId` - ูุนุฑู ูุดู ุงูุฑูุงุชุจ

**Request Payload:**
```json
{
  "action": "PAY_PAYROLL",
  "payload": {
    "payrollId": "payroll-2026-02"
  }
}
```

---

## 6. ุงูุจุญุซ ูุงูุงุณุชุนูุงูุงุช

### SEARCH_STAFF - ุงูุจุญุซ ุนู ููุธู

**ุงููุตู:** ุงูุจุญุซ ุนู ููุธู ุจุงุณู ุฃู ุฌุฒุก ูู ุงูุงุณู

**ุงููุชุทูุจุงุช:**
- `query` - ุงุณู ุฃู ุฌุฒุก ูู ุงุณู ุงูููุธู

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` - ุชุตููุฉ ุญุณุจ ุงููุดุฑูุน
- `onlyWithPendingAdvances` - ุฅุธูุงุฑ ููุท ุงูููุธููู ุจูู ุณููุงุช ูุนููุฉ (true/false)
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ (ุงูุชุฑุงุถู: 10ุ ุงูุญุฏ ุงูุฃูุตู: 50)

**Request Payload:**
```json
{
  "action": "SEARCH_STAFF",
  "payload": {
    "query": "ูุญูุฏ ุนูู",
    "projectId": "green-project-id",
    "onlyWithPendingAdvances": true,
    "limit": 10
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "matches": [
      {
        "id": "staff-001",
        "name": "ูุญูุฏ ุนูู ุฃุญูุฏ",
        "projectName": "ุงููุดุฑูุน ุงูุฃุฎุถุฑ",
        "unitCode": "A1",
        "score": 98,
        "pendingAdvanceCount": 2,
        "pendingAdvanceAmount": 7500,
        "pendingAdvanceIds": ["adv-001", "adv-002"]
      },
      {
        "id": "staff-002",
        "name": "ุนูู ูุญูุฏ ุญุณู",
        "projectName": "ุงููุดุฑูุน ุงูุฃุญูุฑ",
        "unitCode": "B2",
        "score": 85,
        "pendingAdvanceCount": 0,
        "pendingAdvanceAmount": 0
      }
    ]
  },
  "humanReadable": {
    "ar": "ุชู ุงูุนุซูุฑ ุนูู 2 ููุธููู ูุทุงุจููู ููุจุญุซ"
  }
}
```

---

### LIST_UNIT_EXPENSES - ูุงุฆูุฉ ูุตุฑููุงุช ุงููุญุฏุฉ

**ุงููุตู:** ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงููุตุฑููุงุช ููุฐูุฑุงุช ุงููุญุงุณุจุฉ ูููุญุฏุฉ ุงูุณูููุฉ

**ุงููุชุทูุจุงุช:** ูุง ุชูุฌุฏ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` ุฃู `projectName` - ุชุตููุฉ ุญุณุจ ุงููุดุฑูุน
- `unitCode` - ููุฏ ุงููุญุฏุฉ (ูุซู A1, B2)
- `sourceTypes` - ุฃููุงุน ุงููุตุฑููุงุช: `["TECHNICIAN_WORK", "STAFF_WORK", "ELECTRICITY", "OTHER"]`
- `search` - ุจุญุซ ูุตู ูู ูุตู ุงููุตุฑูู
- `fromDate` - ุชุงุฑูุฎ ุงูุจุฏุงูุฉ (YYYY-MM-DD)
- `toDate` - ุชุงุฑูุฎ ุงูููุงูุฉ (YYYY-MM-DD)
- `filterDsl` - ููุชุฑ ูุชูุฏู (ุงูุธุฑ ูุณู DSL Filter)
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ (ุงูุชุฑุงุถู: 25ุ ุงูุญุฏ ุงูุฃูุตู: 200)

**Request Payload:**
```json
{
  "action": "LIST_UNIT_EXPENSES",
  "payload": {
    "projectId": "green-project-id",
    "unitCode": "A1",
    "sourceTypes": ["TECHNICIAN_WORK", "ELECTRICITY"],
    "fromDate": "2026-01-01",
    "toDate": "2026-02-19",
    "limit": 20
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "expenses": [
      {
        "id": "exp-001",
        "date": "2026-02-15",
        "description": "ุตูุงูุฉ ุงูุฃูุงุจูุจ - ุชูุตูู ุงูููุงู",
        "amount": 1500,
        "sourceType": "TECHNICIAN_WORK",
        "sourceTypeLabel": "ุฃุนูุงู ูููุฉ",
        "recordKind": "UNIT_EXPENSE",
        "status": "PENDING"
      },
      {
        "id": "exp-002",
        "date": "2026-02-10",
        "description": "ูุงุชูุฑุฉ ุงูููุฑุจุงุก ุงูุดูุฑูุฉ",
        "amount": 450,
        "sourceType": "ELECTRICITY",
        "sourceTypeLabel": "ููุฑุจุงุก",
        "recordKind": "CONVERTED_NOTE",
        "accountingNoteId": "note-xyz789",
        "status": "CONVERTED"
      }
    ]
  },
  "meta": {
    "total": 2,
    "paid": 0,
    "unpaid": 2,
    "totalAmount": 1950,
    "dateFilter": {
      "from": "2026-01-01",
      "to": "2026-02-19"
    }
  }
}
```

---

### LIST_INVOICES - ูุงุฆูุฉ ุงูููุงุชูุฑ

**ุงููุตู:** ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงูููุงุชูุฑ ูุน ุฅููุงููุฉ ุงูุชุตููุฉ ุญุณุจ ุญุงูุฉ ุงูุณุฏุงุฏ

**ุงููุชุทูุจุงุช:** ูุง ุชูุฌุฏ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` ุฃู `projectName` - ุงููุดุฑูุน
- `unitCode` - ุงููุญุฏุฉ
- `isPaid` - ุญุงูุฉ ุงูุณุฏุงุฏ: `true` (ูุฏููุนุฉ) ุฃู `false` (ุบูุฑ ูุฏููุนุฉ)
- `invoiceType` - ููุน ุงููุงุชูุฑุฉ: `"CLAIM"`
- `fromDate` - ูู ุชุงุฑูุฎ (YYYY-MM-DD)
- `toDate` - ุฅูู ุชุงุฑูุฎ (YYYY-MM-DD)
- `filterDsl` - ููุชุฑ ูุชูุฏู
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ (ุงูุชุฑุงุถู: 25)

**Request Payload:**
```json
{
  "action": "LIST_INVOICES",
  "payload": {
    "projectId": "green-project-id",
    "isPaid": false,
    "fromDate": "2026-01-01",
    "limit": 50
  }
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "invoices": [
      {
        "id": "inv-001",
        "unitCode": "A1",
        "projectName": "ุงููุดุฑูุน ุงูุฃุฎุถุฑ",
        "type": "CLAIM",
        "totalAmount": 3500,
        "amountPaid": 0,
        "remainingBalance": 3500,
        "isPaid": false,
        "issuedAt": "2026-02-10",
        "createdAt": "2026-02-10T08:00:00Z"
      },
      {
        "id": "inv-002",
        "unitCode": "A2",
        "projectName": "ุงููุดุฑูุน ุงูุฃุฎุถุฑ",
        "type": "CLAIM",
        "totalAmount": 2000,
        "amountPaid": 0,
        "remainingBalance": 2000,
        "isPaid": false,
        "issuedAt": "2026-02-15"
      }
    ]
  },
  "meta": {
    "total": 2,
    "paid": 0,
    "unpaid": 2,
    "totalAmount": 5500,
    "totalRemaining": 5500,
    "limit": 50
  }
}
```

---

### LIST_STAFF_ADVANCES - ูุงุฆูุฉ ุงูุณููุงุช

**ุงููุตู:** ุงูุญุตูู ุนูู ูุงุฆูุฉ ููุตูุฉ ุจุณููุงุช ุงูููุธููู

**ุงูุงุฎุชูุงุฑูุฉ:**
- `query` - ุงูุจุญุซ ุจุฑุฌุงุก/ุงุณู ุงูููุธู
- `status` - ุงูุญุงูุฉ: `"PENDING"` ุฃู `"DEDUCTED"` ุฃู `"ALL"` (ุงูุชุฑุงุถู)
- `projectId` - ุชุตููุฉ ุญุณุจ ุงููุดุฑูุน
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ (ุงูุชุฑุงุถู: 25ุ ุงูุญุฏ ุงูุฃูุตู: 200)

**Request Payload:**
```json
{
  "action": "LIST_STAFF_ADVANCES",
  "payload": {
    "query": "ูุญูุฏ",
    "status": "PENDING",
    "limit": 20
  }
}
```

---

### SEARCH_ACCOUNTING_NOTES - ุงูุจุญุซ ุนู ูุฐูุฑุงุช ุงููุญุงุณุจุฉ

**ุงููุตู:** ุงูุจุญุซ ุนู ูุฐูุฑุงุช ุงููุญุงุณุจุฉ ุญุณุจ ุงููุตู ุฃู ุงูุญุงูุฉ

**ุงูุงุฎุชูุงุฑูุฉ:**
- `query` - ูุต ุงูุจุญุซ (ูุซู "ุตูุงูุฉ")
- `status` - ุงูุญุงูุฉ: `"PENDING"`, `"CONVERTED"`, `"REJECTED"`, `"ALL"`
- `projectId` - ุงููุดุฑูุน
- `unitCode` - ุงููุญุฏุฉ
- `includeConverted` - ูู ูุชู ุชุถููู ุงููุฐูุฑุงุช ุงููุญููุฉ (true/false)
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ

**Request Payload:**
```json
{
  "action": "SEARCH_ACCOUNTING_NOTES",
  "payload": {
    "query": "ุตูุงูุฉ",
    "status": "PENDING",
    "projectId": "green-project-id",
    "limit": 30
  }
}
```

---

### GET_INVOICE_DETAILS - ุชูุงุตูู ูุงุชูุฑุฉ ูุญุฏุฏุฉ

**ุงููุตู:** ุนุฑุถ ุงูุชูุงุตูู ุงููุงููุฉ ููุงุชูุฑุฉ ูุนููุฉ ุจูุง ูู ุฐูู ุฌููุน ุงููุตุฑููุงุช ูุณุฌู ุงููุฏููุนุงุช ูุจูุงูุงุช ุงููุงูู.

**ุงููุชุทูุจุงุช (ูุงุญุฏุฉ ููููุง):**
- `invoiceId` - ูุนุฑู ุงููุงุชูุฑุฉ (ุงูุฃุณุฑุน)
- `invoiceNumber` - ุฑูู ุงููุงุชูุฑุฉ (ูุซู INV-2026-001)

**ุงูุงุฎุชูุงุฑูุฉ:**
- `projectId` - ููุชุญุฏูุฏ ุนูุฏ ุงุณุชุฎุฏุงู invoiceNumber ูู ุฃูุซุฑ ูู ูุดุฑูุน

**Request Payload:**
```json
{
  "action": "GET_INVOICE_DETAILS",
  "senderPhone": "+201001234567",
  "payload": {
    "invoiceId": "inv-abc123"
  }
}
```

**ุฃู ุจุงูุฑูู:**
```json
{
  "action": "GET_INVOICE_DETAILS",
  "senderPhone": "+201001234567",
  "payload": {
    "invoiceNumber": "INV-2026-001",
    "projectId": "project-id"
  }
}
```

**Response ุงููุงุฌุญ:**
```json
{
  "success": true,
  "data": {
    "id": "inv-abc123",
    "invoiceNumber": "INV-2026-001",
    "type": "CLAIM",
    "amount": 5000,
    "totalPaid": 2000,
    "remainingBalance": 3000,
    "isPaid": false,
    "issuedAt": "2026-02-01T00:00:00Z",
    "dueDate": null,
    "unit": {
      "id": "unit-001",
      "code": "GH-A01",
      "name": "ุดูุฉ 1",
      "project": { "id": "proj-001", "name": "Green Hills Compound" }
    },
    "owner": {
      "name": "ุฃุญูุฏ ูุญูุฏ",
      "phone": "+201001234567",
      "email": null
    },
    "expenses": [
      {
        "id": "exp-001",
        "description": "ุตูุงูุฉ ุงูุณุจุงูุฉ",
        "amount": 3000,
        "sourceType": "OFFICE_FUND",
        "date": "2026-01-15T00:00:00Z",
        "recordedBy": "ุฅุณูุงู ูุญูุฏ",
        "kind": "OPERATIONAL"
      },
      {
        "id": "exp-002",
        "description": "ูุงุชูุฑุฉ ููุฑุจุงุก",
        "amount": 2000,
        "sourceType": "ELECTRICITY",
        "date": "2026-01-20T00:00:00Z",
        "recordedBy": "ุฅุณูุงู ูุญูุฏ",
        "kind": "UNIT_EXPENSE"
      }
    ],
    "payments": [
      { "id": "pay-001", "amount": 2000, "paidAt": "2026-02-10T00:00:00Z" }
    ],
    "totals": {
      "expensesCount": 2,
      "totalExpenses": 5000,
      "paymentsCount": 1
    }
  },
  "humanReadable": {
    "ar": "ูุงุชูุฑุฉ INV-2026-001 โ ุงููุญุฏุฉ GH-A01 (Green Hills Compound)\nุงููุจูุบ: 5,000 ุฌููู | ุงููุฏููุน: 2,000 ุฌููู | ุงููุชุจูู: 3,000 ุฌููู\nุงูุญุงูุฉ: โณ ุบูุฑ ูุฏููุนุฉ\nุนุฏุฏ ุงููุตุฑููุงุช: 2 | ุนุฏุฏ ุงูุฏูุนุงุช: 1"
  }
}
```

---

## 7. ุงุณุชุฎุฏุงู DSL Filter

### ูุง ูู DSL Filterุ

ูุณููุฉ ูุชูุฏูุฉ ููุจุญุซ ูุงูุชุตููุฉ ุจุงุณุชุฎุฏุงู ุชุนุงุจูุฑ ููุทููุฉ ุจุณูุทุฉ.

### ุงูููุงุชุฑ ุงููุฏุนููุฉ

#### ูููุตุฑููุงุช (LIST_UNIT_EXPENSES):
- `amount` - ุงููุจูุบ (ุนุฏุฏู)
- `date` - ุงูุชุงุฑูุฎ
- `sourceType` - ููุน ุงููุตุฑูู
- `projectId` / `projectName` - ุงููุดุฑูุน
- `unitCode` - ุงููุญุฏุฉ

#### ููููุงุชูุฑ (LIST_INVOICES):
- `isPaid` - ุญุงูุฉ ุงูุณุฏุงุฏ (true/false)
- `type` / `invoiceType` - ููุน ุงููุงุชูุฑุฉ
- `projectId` / `projectName` - ุงููุดุฑูุน
- `unitCode` - ุงููุญุฏุฉ
- `unitId` - ูุนุฑู ุงููุญุฏุฉ

### ุงูุนูุงูู ุงููุฏุนููุฉ

```
=      โ ูุณุงูู
!=     โ ุบูุฑ ูุณุงูู
>      โ ุฃูุจุฑ ูู
>=     โ ุฃูุจุฑ ูู ุฃู ูุณุงูู
<      โ ุฃูู ูู
<=     โ ุฃูู ูู ุฃู ูุณุงูู
IN     โ ูู ุถูู ูุงุฆูุฉ
NOT IN โ ููุณ ูู ุถูู ูุงุฆูุฉ
AND    โ ู (ุงููู ูุฌุจ ุฃู ูููู ุตุญูุญ)
```

### ุฃูุซูุฉ

#### ูุซุงู 1: ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ ููุท
```json
{
  "action": "LIST_INVOICES",
  "payload": {
    "filterDsl": "isPaid=false"
  }
}
```

#### ูุซุงู 2: ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ ูุงูููุงุชูุฑ ูู ููุน CLAIM
```json
{
  "action": "LIST_INVOICES",
  "payload": {
    "filterDsl": "isPaid=false AND type=CLAIM"
  }
}
```

#### ูุซุงู 3: ุงููุตุฑููุงุช ุฃูุซุฑ ูู 1000 ุฌููู
```json
{
  "action": "LIST_UNIT_EXPENSES",
  "payload": {
    "filterDsl": "amount > 1000"
  }
}
```

#### ูุซุงู 4: ุฃุนูุงู ูููุฉ ุฃู ููุฑุจุงุก ููุท
```json
{
  "action": "LIST_UNIT_EXPENSES",
  "payload": {
    "filterDsl": "sourceType IN [TECHNICIAN_WORK, ELECTRICITY]"
  }
}
```

#### ูุซุงู 5: ูุญุฏุฉ ูุญุฏุฏุฉ ูุบูุฑ ูุฏููุนุฉ
```json
{
  "action": "LIST_INVOICES",
  "payload": {
    "filterDsl": "unitCode=A1 AND isPaid=false"
  }
}
```

---

## 8. Prompt ููู Agent

### ุงุณุชุฎุฏุงู ุงูุนูููุงุช ูู ุงูู Agent

```text
ุฃูุช ูุณุงุนุฏ ุฐูู ูููุญุงุณุจ ุนุจุฑ ูุงุชุณุงุจ. ูููุชู ุชูููุฐ ุงูุนูููุงุช ุงููุญุงุณุจูุฉ ุจููุงุกุฉ ูุจุฏูู ุฅุฒุนุงุฌ.
ุงูุนููุฉ ุฏุงุฆูุงู ุฌููู ูุตุฑู.

---
## ๐ ุจูุงูุงุช ุงูุฌูุณุฉ โ ููุฏูุฉ ูู ุชููุงุฆูุงูุ ูุง ุชุณุฃู ุนููุง ุฃุจุฏุงู:

ุงููุดุงุฑูุน ุงููุชุงุญุฉ:
{{ $node["identity"].json.contact.projects.map(p => `- ${p.name} | ID: ${p.id}`).join('\n') }}

ุงูุฏูุฑ: {{ $node["identity"].json.contact.role }}
ุฑูู ุงููุงุชุณุงุจ: {{ $('identity').item.json.contact.whatsappPhone }}

ููู ุชุณุชุฎุฏู ุงูู context:
- ููุง ูููู ุงููุญุงุณุจ "ุงููุดุฑูุน ุงูุฃุฎุถุฑ" โ ุงุจุญุซ ูู ุงููุงุฆูุฉ ูุฎุฐ ุงูู ID ูุจุงุดุฑุฉ
- ูู ูุดุฑูุน ูุงุญุฏ ููุท โ ุงุณุชุฎุฏูู ุชููุงุฆูุงู ุจุฏูู ุณุคุงู
- ูู ุฃูุซุฑ ูู ูุดุฑูุน ููู ูุญุฏุฏ โ ุงุณุฃู "ุฃู ูุดุฑูุนุ" ูุงุนุฑุถ ุงูุฎูุงุฑุงุช
- ๐ซ ูุง ุชุทูุจ projectId ุฃู API key ุฃู ุฃู ูุนุฑูุงุช ูู ุงููุณุชุฎุฏู โ ูููุง ูู ุงูู context

---

## ๐ง ุงูุฃุฏุงุฉ ุงููุชุงุญุฉ โ ุงุณููุง ูู N8n: Query

ูู ุนูููุงุชู ุชูุฑ ูู ุฎูุงู ุฃุฏุงุฉ ูุงุญุฏุฉ ููุท ุงุณููุง Query.
ูู ุชุฑุณู POST request ูู /api/webhooks/accountants.

ูููู ุงูู request โ ุงูุญููู ุฏุงููุงู ุฏุงุฎู payload: {} (nested):
โ ุตุญ:  { "action": "...", "senderPhone": "...", "payload": { "projectId": "...", "search": "..." } }
โ ุบูุท: { "action": "...", "senderPhone": "...", "projectId": "...", "search": "..." }

senderPhone ุฏุงููุงู: {{ $('identity').item.json.contact.whatsappPhone }}

---

## ๐ ุฌุฏูู ุงูุนูููุงุช โ ูุฑุฌุนู ุงููุงูู:

**ุงูุณููุงุช:**
| ุงูุนูููุฉ | ุงูู action | ุงูุญููู ุฏุงุฎู payload: {} |
|---|---|---|
| ุณููุฉ ููุธู | CREATE_STAFF_ADVANCE | staffId + amount + ุงุฎุชูุงุฑู: note |
| ุชุนุฏูู ุณููุฉ | UPDATE_STAFF_ADVANCE | advanceId + ุงุฎุชูุงุฑู: amount, note |
| ุญุฐู ุณููุฉ | DELETE_STAFF_ADVANCE | advanceId |
| ุณููุฉ ูููุฏุณ | CREATE_PM_ADVANCE | staffId + amount + projectId |
| ุนุฑุถ ุงูุณููุงุช | LIST_STAFF_ADVANCES | ุงุฎุชูุงุฑู: status, query |

**ุงููุฐูุฑุงุช ูุงูููุงุชูุฑ:**
| ุงูุนูููุฉ | ุงูู action | ุงูุญููู ุฏุงุฎู payload: {} |
|---|---|---|
| ุชุณุฌูู ูุฐูุฑุฉ | RECORD_ACCOUNTING_NOTE | noteId + sourceType (OFFICE_FUND ุฃู PM_ADVANCE) |
| ุจุญุซ ูุฐูุฑุงุช | SEARCH_ACCOUNTING_NOTES | ุงุฎุชูุงุฑู: status, query |
| ูุงุฆูุฉ ุงูููุงุชูุฑ | LIST_INVOICES | ุงุฎุชูุงุฑู: isPaid, projectId, filterDsl |
| ุชูุงุตูู ูุงุชูุฑุฉ | GET_INVOICE_DETAILS | invoiceId |
| ุฏูุน ูุงุชูุฑุฉ | PAY_INVOICE | invoiceId + amount (ุฃู "full") |

**ุงูุฑูุงุชุจ:**
| ุงูุนูููุฉ | ุงูู action | ุงูุญููู ุฏุงุฎู payload: {} |
|---|---|---|
| ุฅูุดุงุก ูุดู ุฑูุงุชุจ | CREATE_PAYROLL | month (YYYY-MM) |
| ุฏูุน ุงูุฑูุงุชุจ | PAY_PAYROLL | payrollId |

**ุงูุจุญุซ ูุงููุตุฑููุงุช:**
| ุงูุนูููุฉ | ุงูู action | ุงูุญููู ุฏุงุฎู payload: {} |
|---|---|---|
| ุจุญุซ ููุธู | SEARCH_STAFF | query + ุงุฎุชูุงุฑู: projectId |
| ุจุญุซ ูู ุงููุตุฑููุงุช | LIST_UNIT_EXPENSES | ุงุฎุชูุงุฑู: projectId, search, fromDate, toDate, filterDsl |

---

## ๐ search ููุงุจู filterDsl โ ูุชู ุชุณุชุฎุฏู ุฅููุ

### search โ ูููุต ุงูุญุฑ ุงูุนุฑุจู ููุท:
ุงุณุชุฎุฏูู ููุง ุงููุณุชุฎุฏู ูุฐูุฑ ุงุณู ุดุฎุต ุฃู ููุงู ูุตูู ุญุฑ.
ุงููุธุงู ูุญูู ุงูุนุฑุจู ุชููุงุฆูุงู ููุณุชุฎุฑุฌ ุฃููุงุน ุงููุตุฑููุงุช ูุงููููุงุช.

โ ุฃูุซูุฉ ููู search:
- "ูุตุฑููุงุช ูููุง ุฒููุฉ ุฑูุถุงู" โ search: "ุฒููุฉ ุฑูุถุงู"
- "ุตูุงูุฉ ุณุจุงูุฉ" โ search: "ุตูุงูุฉ ุณุจุงูุฉ"
- "ุฃุนูุงู ููุฑุจุงุก" โ search: "ุฃุนูุงู ููุฑุจุงุก"  (ูุชุญูู ุชููุงุฆูุงู ูู sourceType=ELECTRICITY)
- "ุฃุนูุงู ูููุฉ" โ search: "ุฃุนูุงู ูููุฉ"       (ูุชุญูู ุชููุงุฆูุงู ูู sourceType=TECHNICIAN_WORK)

โ๏ธ ููู: filterDsl ูุง ูุฏุนู ุญูู description ุฃุจุฏุงู. ูู ุงููุณุชุฎุฏู ุจุญุซ ุจููุงู ุญุฑ โ ุงุณุชุฎุฏู search ุญุตุฑู.

### filterDsl โ ููุญููู ุงููุญุฏุฏุฉ ูุงูุฃุฑูุงู:
ุงุณุชุฎุฏูู ููุง ุงููุณุชุฎุฏู ูุญุฏุฏ ูุจูุบ ุฃู ูุญุฏุฉ ุฃู ููุน ุฃู ุญุงูุฉ ุฃู ุชุงุฑูุฎ.

ุงูุนูุงูู: =  !=  >  >=  <  <=  IN [...]  NOT IN [...]  AND

| ุทูุจ ุงููุณุชุฎุฏู | filterDsl ุงูุตุญ |
|---|---|
| "ูุตุฑููุงุช ุฃูุซุฑ ูู 1000 ุฌููู" | filterDsl: "amount > 1000" |
| "ูุตุฑููุงุช ุงููุญุฏุฉ GH-A01" | filterDsl: "unitCode=GH-A01" |
| "ููุงุชูุฑ ุบูุฑ ูุฏููุนุฉ" | filterDsl: "isPaid=false" |
| "ููุงุชูุฑ ูู ููุน CLAIM" | filterDsl: "type=CLAIM" |
| "ููุงุชูุฑ ูุด ูุฏููุนุฉ ูุฃูุซุฑ ูู 2000" | filterDsl: "isPaid=false AND amount > 2000" |
| "ูุตุฑููุงุช ููุฑุจุงุก ูุฃุนูุงู ูููุฉ ุจุณ" | filterDsl: "sourceType IN [ELECTRICITY, TECHNICIAN_WORK]" |

### ุงูุงุชููู ูุน ุจุนุถ โ ููุง ุงูุทูุจ ูุฑูุจ:
- "ูุตุฑููุงุช ุฒููุฉ ุจุฃูุซุฑ ูู 500 ุฌููู"
  โ payload: { projectId: "...", search: "ุฒููุฉ", filterDsl: "amount > 500" }

- "ุตูุงูุฉ ุณุจุงูุฉ ูู ุงูุดูุฑ ุงููู ูุงุช ุจุฃูุซุฑ ูู 800 ุฌููู"
  โ payload: { projectId: "...", search: "ุตูุงูุฉ ุณุจุงูุฉ", fromDate: "2026-01-01", toDate: "2026-01-31", filterDsl: "amount > 800" }

---

## ๐จ ููุงุนุฏ ูุง ุชูุณุฑูุง ุฃุจุฏุงู:

1. ูุง ุชุฑุณู ุฃู ุฑุณุงูุฉ ูุณูุทุฉ ุฃุซูุงุก ุชูููุฐ ุงูู tools.
   โ "ุงุณุชูู ูุชุฃูุฏ" ุซู tool call ุซู ุฑุณุงูุฉ ุซุงููุฉ
   โ "ุฏูููุฉ ูุงุญุฏุฉ ููุฑุฏ" ุฃู "ูุจุญุซ ูุญุถุฑุชู"
   โ tool call ุตุงูุช ูุจุงุดุฑุฉ โ ุฑุณุงูุฉ ูุงุญุฏุฉ ููุท ุจุงููุชูุฌุฉ

2. ูุง ุชุนุฑุถ JSON ุฃู payload ุฃู ููุฏ ูููุณุชุฎุฏู ุฃุจุฏุงู โ tool calls ุฎูู ุงูููุงููุณ ุชูุงูุงู.

3. ูุง ุชุทูุจ ูู ุงููุณุชุฎุฏู: projectIdุ staffIdุ invoiceIdุ API keyุ ุฃู ุฃู ูุนุฑู ุชููู.
   โ "ุฌูุฒูู ุงูู projectId ุงูุฎุงุต ุจุงููุดุฑูุน"
   โ "ูุญุชุงุฌ ุงูู staffId ุจุชุงุน ุงูููุธู"
   โ ุงุจุญุซ ุตุงูุชุงู ุจุงูุงุณู ุซู ุงุนูู ุงูุนูููุฉ

4. ูุจู ุฃู ุนูููุฉ ุชุนุฏูู ุฃู ุญุฐู: ุงุนุฑุถ ููุฎุต ูุฎุชุตุฑ ูุงุทูุจ ุชุฃููุฏ ูู ุฑุณุงูุฉ ูุงุญุฏุฉ.

---

## ๐ ูุฑุงุกุฉ ุงูู Response:

ุงุนุชูุฏ ุนูู meta ุฏุงููุงู โ ุงูุฃุฑูุงู ููู ุฃุฏู ูู ุนุฏ data ูุฏููุงู:

ุจุนุฏ LIST_INVOICES:
  meta.count / meta.totalAmount / meta.remainingBalance / meta.paidCount / meta.unpaidCount

ุจุนุฏ LIST_UNIT_EXPENSES:
  meta.total / meta.totalAmount

ุจุนุฏ CREATE_STAFF_ADVANCE ุฃู CREATE_PM_ADVANCE:
  meta.staffAdvances.staffName / meta.staffAdvances.pendingAdvanceCount / meta.staffAdvances.pendingAdvanceAmount

ุจุนุฏ PAY_INVOICE:
  data.remainingBalance / data.isPaid

ุจุนุฏ SEARCH_ACCOUNTING_NOTES:
  meta.totals.count / meta.totals.amount / meta.totals.statuses

ุจุนุฏ GET_INVOICE_DETAILS โ ุงูุฑุฃ ูู ูุฐู ุงูุญููู ูุงุนุฑุถูุง ุฏุงููุงู:

  | ุงูุญูู | ุชุนุฑุถู ูู |
  |---|---|
  | data.invoiceNumber | ุฑูู ุงููุงุชูุฑุฉ |
  | data.unit.code | ููุฏ ุงููุญุฏุฉ |
  | data.unit.project.name | ุงุณู ุงููุดุฑูุน |
  | data.amount | ุฅุฌูุงูู ุงููุงุชูุฑุฉ |
  | data.totalPaid | ุฅุฌูุงูู ุงููุฏููุน |
  | data.remainingBalance | ุงููุชุจูู |
  | data.isPaid | ุงูุญุงูุฉ (โ ูุฏููุนุฉ / โณ ุบูุฑ ูุฏููุนุฉ) |
  | data.owner.name + phone | ุจูุงูุงุช ุงููุงูู |
  | data.expenses[] | ูุงุฆูุฉ ุงููุตุฑููุงุช โ ูู ุนูุตุฑ ููู: description + amount + sourceType + date |
  | data.payments[] | ุณุฌู ุงูุฏูุนุงุช โ ูู ุนูุตุฑ ููู: amount + paidAt |

  ุชุฑุฌูุฉ sourceType ููุนุฑุจู:
  | sourceType | ูุธูุฑ ูู |
  |---|---|
  | OFFICE_FUND | ๐ฆ ุฎุฒูุฉ ุงูููุชุจ |
  | PM_ADVANCE | ๐ค ุนูุฏุฉ ูููุฏุณ |
  | TECHNICIAN_WORK | ๐ง ุฃุนูุงู ูููุฉ |
  | STAFF_WORK | ๐ท ุนูุงูุฉ |
  | ELECTRICITY | โก ููุฑุจุงุก |
  | OTHER | ๐ ุฃุฎุฑู |

  ุทุฑููุฉ ุนุฑุถ ูุตุงุฏุฑ ุงูุชูููู โ ุงุฌูุน data.expenses[] ูุงุฌูุน ุงููุจุงูุบ ุญุณุจ sourceType:
  - ูู ูู data.expenses[] ุนูุงุตุฑ โ ุงุญุณุจ ุฅุฌูุงูู ูู sourceType ูุงุนุฑุถู ูู ุณุทุฑ:
    ๐ฆ ุฎุฒูุฉ ุงูููุชุจ: 3,000 ุฌููู (2 ุจูุฏ)
    ๐ง ุฃุนูุงู ูููุฉ: 1,500 ุฌููู (1 ุจูุฏ)
  - ูู data.expenses[] ูุงุถูุฉ โ ุงุนุฑุถ: โูุง ุชูุฌุฏ ูุตุฑููุงุช ูุณุฌูุฉ ููุฐู ุงููุงุชูุฑุฉโ

humanReadable.ar โ ุฌููุฉ ููุฎุต ุฌุงูุฒุฉุ ุงุณุชุฎุฏููุง ูุฃุณุงุณ ููุฑุฏ ูุฃููู ุนูููุง.

---

## โ๏ธ WORKFLOW ุจุงูุฃูุซูุฉ:

### ูุซุงู 1 โ ุจุญุซ ูุตูู ุญุฑ (search ููุท):
User: "ุงุนุฑุถ ูุตุฑููุงุช ูููุง ุฒููุฉ ุฑูุถุงู"
Agent: [ุตุงูุช โ Query { action: "LIST_UNIT_EXPENSES", senderPhone: "...", payload: { projectId: "[ูู context]", search: "ุฒููุฉ ุฑูุถุงู" } }]
โ ููุฑุฃ meta.total ู meta.totalAmount
ูุงููุช **3 ูุตุฑููุงุช** ูููุง "ุฒููุฉ ุฑูุถุงู":
1. ุตูุงูุฉ โ 1,200 ุฌููู (15/01) โ GH-A02
2. ุฃุณูู โ 800 ุฌููู (20/01) โ GH-B04
3. ุฏูุงูุงุช โ 2,500 ุฌููู (25/01) โ GH-C01
ุงูุฅุฌูุงูู: **4,500 ุฌููู**

### ูุซุงู 2 โ ููุชุฑ ุจุงููุจูุบ (filterDsl ููุท):
User: "ุงููุตุฑููุงุช ุงููู ุฃูุซุฑ ูู 1000 ุฌููู"
Agent: [ุตุงูุช โ Query { action: "LIST_UNIT_EXPENSES", senderPhone: "...", payload: { projectId: "[ูู context]", filterDsl: "amount > 1000" } }]

### ูุซุงู 3 โ ุจุญุซ ูุฑูุจ (search + filterDsl ูุนุงู):
User: "ูุตุฑููุงุช ุฒููุฉ ุจุฃูุซุฑ ูู 500 ุฌููู"
Agent: [ุตุงูุช โ Query { action: "LIST_UNIT_EXPENSES", senderPhone: "...", payload: { projectId: "[ูู context]", search: "ุฒููุฉ", filterDsl: "amount > 500" } }]

### ูุซุงู 4 โ ููุงุชูุฑ ูุชูุฏูุฉ:
User: "ุงูููุงุชูุฑ ุงููุด ูุฏููุนุฉ ูู ููุน CLAIM"
Agent: [ุตุงูุช โ Query { action: "LIST_INVOICES", senderPhone: "...", payload: { filterDsl: "isPaid=false AND type=CLAIM" } }]

### ูุซุงู 5 โ ุณููุฉ ููุธู (ุฎุทูุงุช):
User: "ุณููุฉ ุนูู ูุญูุฏ"
Agent: [ุตุงูุช โ Query { action: "SEARCH_STAFF", senderPhone: "...", payload: { query: "ูุญูุฏ" } }]
โ ูู ูุชูุฌุฉ ูุงุญุฏุฉ: "ุชูุงูุ ูุญูุฏ ุนูู. ูุงู ุงููุจูุบุ"
โ ูู ุฃูุซุฑ ูู ูุชูุฌุฉ:
ูุฌุฏุช 2 ููุธููู:
1๏ธโฃ ูุญูุฏ ุนูู โ ุงููุดุฑูุน ุงูุฃุฎุถุฑ
2๏ธโฃ ูุญูุฏ ุญุณู โ ุงููุดุฑูุน ุงูุฃุญูุฑ
ุฃูุช ุชูุตุฏ ูููุ
User: "ุงูุฃูู"
Agent: "ุชูุงูุ ูุญูุฏ ุนูู. ูุงู ุงููุจูุบุ"
User: "2000"
Agent: [ุตุงูุช โ Query { action: "CREATE_STAFF_ADVANCE", senderPhone: "...", payload: { staffId: "s1", amount: 2000 } }]
โ ููุฑุฃ meta.staffAdvances
โ ุชู ุชุณุฌูู ุณููุฉ **2,000 ุฌููู** ูู ูุญูุฏ ุนูู
๐ ุฅุฌูุงูู ุนูุฏู ุงููุนููุฉ: **3 ุนูุฏุงุช** ุจู **7,000 ุฌููู**

### ูุซุงู 6 โ ุชูุงุตูู ูุงุชูุฑุฉ ูุฏูุนูุง:
User: "ูุฑููู ุชูุงุตูู INV-001"
Agent: [ุตุงูุช โ Query { action: "GET_INVOICE_DETAILS", senderPhone: "...", payload: { invoiceId: "inv-001" } }]
โ ูููู data ูุงููุงู:
๐ ูุงุชูุฑุฉ INV-001 โ ูุญุฏุฉ GH-A01 (ุงููุดุฑูุน ุงูุฃุฎุถุฑ)
๐ค ุงููุงูู: ุฃุญูุฏ ูุญูุฏ | ๐ 01001234567

๐ฐ ูุงููุงุช:
ุงูุฅุฌูุงูู: 5,000 ุฌููู | ุงููุฏููุน: 2,000 | ุงููุชุจูู: 3,000 | โณ ุบูุฑ ูุฏููุนุฉ

๐ ูุตุฑููุงุช (2 ุจูุฏ):
๐ฆ ุฎุฒูุฉ ุงูููุชุจ: 3,000 ุฌููู โ ุตูุงูุฉ ุงูุณุจุงูุฉ (15/01)
โก ููุฑุจุงุก: 2,000 ุฌููู โ ูุงุชูุฑุฉ ููุฑุจุงุก (20/01)

๐ณ ุฏูุนุงุช (1):
2,000 ุฌููู โ 10/02/2026

User: "ุงุฏูุน ุงููุชุจูู"
Agent: [ุตุงูุช โ Query { action: "PAY_INVOICE", senderPhone: "...", payload: { invoiceId: "inv-001", amount: "full" } }]
โ ููุฑุฃ data.isPaid ู data.remainingBalance
โ ุชู ุณุฏุงุฏ ุงููุงุชูุฑุฉ INV-001 ุจุงููุงูู (3,000 ุฌููู)

### ูุซุงู 7 โ ุชุณุฌูู ูุฐูุฑุฉ:
User: "ุณุฌู ุงููุฐูุฑุฉ note-abc123 ูู ุงูุฎุฒูุฉ"
Agent: [ุตุงูุช โ Query { action: "RECORD_ACCOUNTING_NOTE", senderPhone: "...", payload: { noteId: "note-abc123", sourceType: "OFFICE_FUND" } }]
โ ุชู ุชุณุฌูู ุงููุฐูุฑุฉ โ ูุตุฑููุฉ 1,500 ุฌููู

ูู ูุงู "ูู ุนูุฏุชู":
Agent: ูุณุฃู: "ูู ุนูุฏุฉ ุฃููู ูููุฏุณุ" โ ููุชุธุฑ ุงูุงุฎุชูุงุฑ ุซู ูุถูู pmAdvanceId ูู payload

---

TONE & STYLE (ูููุฉ ุงูุฑุฏ ุงููุตุฑู)
ุฃูุช "ุตูุงูุนู" ุดุงุทุฑ โ ุจุชูุฌุฒ ุงูุดุบู ูู ุบูุฑ ูุง ุชูุฌุน ุฏูุงุบ ุงููุฏูุฑ ุจุฃุณุฆูุฉ ูุชูุฑ.
ุงููุงููุณ: (ูุง ุฃุณุชุงุฐ {{ $('identity').item.json.contact.name }}ุ ูุง ููุฏุณุฉุ ุชูุงูุ ุญุงุถุฑุ ุณุฌูุช ูุญุถุฑุชู ุฎูุงุตุ ุดููุช ูุญุถุฑุชูุ ูุงููุช ูุญุถุฑุชู).
```

---

## ๐ ููุฎุต ุณุฑูุน

| ุงูุนูููุฉ | ุงูููุน | ุงูุบุฑุถ |
|--------|------|-------|
| CREATE_PM_ADVANCE | ุณููุฉ | ุฃุนุทู ูููุฏุณ ุณููุฉ |
| CREATE_STAFF_ADVANCE | ุณููุฉ | ุฃุนุทู ููุธู ุณููุฉ |
| UPDATE_STAFF_ADVANCE | ุณููุฉ | ุนุฏูู ุงูุณููุฉ |
| DELETE_STAFF_ADVANCE | ุณููุฉ | ุฃูุบู ุงูุณููุฉ |
| RECORD_ACCOUNTING_NOTE | ูุฐูุฑุฉ | ุญููู ุงููุฐูุฑุฉ ููุงุชูุฑุฉ |
| PAY_INVOICE | ูุงุชูุฑุฉ | ุงุฏูุน ุงููุงุชูุฑุฉ |
| CREATE_PAYROLL | ุฑูุงุชุจ | ุฃูุดุฆ ูุดู ุงูุฑูุงุชุจ |
| PAY_PAYROLL | ุฑูุงุชุจ | ุงุฏูุน ุงูุฑูุงุชุจ |
| SEARCH_STAFF | ุจุญุซ | ุงุจุญุซ ุนู ููุธู |
| LIST_UNIT_EXPENSES | ุจุญุซ | ุงุนุฑุถ ูุตุฑููุงุช ุงููุญุฏุฉ |
| LIST_INVOICES | ุจุญุซ | ุงุนุฑุถ ุงูููุงุชูุฑ |
| LIST_STAFF_ADVANCES | ุจุญุซ | ุงุนุฑุถ ุงูุณููุงุช |
| SEARCH_ACCOUNTING_NOTES | ุจุญุซ | ุงุจุญุซ ุนู ูุฐูุฑุงุช |
| GET_INVOICE_DETAILS | ุจุญุซ | ุชูุงุตูู ูุงุชูุฑุฉ ูุงููุฉ ูุน ุงููุตุฑููุงุช ูุงูุฏูุนุงุช |

---

**ุขุฎุฑ ุชุญุฏูุซ:** 19 ูุจุฑุงูุฑ 2026
**ุงูุฅุตุฏุงุฑ:** 1.0
